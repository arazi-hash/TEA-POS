(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const s of i)if(s.type==="childList")for(const o of s.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function n(i){const s={};return i.integrity&&(s.integrity=i.integrity),i.referrerPolicy&&(s.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?s.credentials="include":i.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function r(i){if(i.ep)return;i.ep=!0;const s=n(i);fetch(i.href,s)}})();function Gy(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var Qh={exports:{}},ll={},Kh={exports:{}},re={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ws=Symbol.for("react.element"),Qy=Symbol.for("react.portal"),Ky=Symbol.for("react.fragment"),Yy=Symbol.for("react.strict_mode"),qy=Symbol.for("react.profiler"),Xy=Symbol.for("react.provider"),Zy=Symbol.for("react.context"),Jy=Symbol.for("react.forward_ref"),ev=Symbol.for("react.suspense"),tv=Symbol.for("react.memo"),nv=Symbol.for("react.lazy"),Rd=Symbol.iterator;function rv(t){return t===null||typeof t!="object"?null:(t=Rd&&t[Rd]||t["@@iterator"],typeof t=="function"?t:null)}var Yh={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},qh=Object.assign,Xh={};function li(t,e,n){this.props=t,this.context=e,this.refs=Xh,this.updater=n||Yh}li.prototype.isReactComponent={};li.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};li.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function Zh(){}Zh.prototype=li.prototype;function Yc(t,e,n){this.props=t,this.context=e,this.refs=Xh,this.updater=n||Yh}var qc=Yc.prototype=new Zh;qc.constructor=Yc;qh(qc,li.prototype);qc.isPureReactComponent=!0;var jd=Array.isArray,Jh=Object.prototype.hasOwnProperty,Xc={current:null},ep={key:!0,ref:!0,__self:!0,__source:!0};function tp(t,e,n){var r,i={},s=null,o=null;if(e!=null)for(r in e.ref!==void 0&&(o=e.ref),e.key!==void 0&&(s=""+e.key),e)Jh.call(e,r)&&!ep.hasOwnProperty(r)&&(i[r]=e[r]);var l=arguments.length-2;if(l===1)i.children=n;else if(1<l){for(var a=Array(l),u=0;u<l;u++)a[u]=arguments[u+2];i.children=a}if(t&&t.defaultProps)for(r in l=t.defaultProps,l)i[r]===void 0&&(i[r]=l[r]);return{$$typeof:ws,type:t,key:s,ref:o,props:i,_owner:Xc.current}}function iv(t,e){return{$$typeof:ws,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function Zc(t){return typeof t=="object"&&t!==null&&t.$$typeof===ws}function sv(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(n){return e[n]})}var Ad=/\/+/g;function Vl(t,e){return typeof t=="object"&&t!==null&&t.key!=null?sv(""+t.key):e.toString(36)}function ro(t,e,n,r,i){var s=typeof t;(s==="undefined"||s==="boolean")&&(t=null);var o=!1;if(t===null)o=!0;else switch(s){case"string":case"number":o=!0;break;case"object":switch(t.$$typeof){case ws:case Qy:o=!0}}if(o)return o=t,i=i(o),t=r===""?"."+Vl(o,0):r,jd(i)?(n="",t!=null&&(n=t.replace(Ad,"$&/")+"/"),ro(i,e,n,"",function(u){return u})):i!=null&&(Zc(i)&&(i=iv(i,n+(!i.key||o&&o.key===i.key?"":(""+i.key).replace(Ad,"$&/")+"/")+t)),e.push(i)),1;if(o=0,r=r===""?".":r+":",jd(t))for(var l=0;l<t.length;l++){s=t[l];var a=r+Vl(s,l);o+=ro(s,e,n,a,i)}else if(a=rv(t),typeof a=="function")for(t=a.call(t),l=0;!(s=t.next()).done;)s=s.value,a=r+Vl(s,l++),o+=ro(s,e,n,a,i);else if(s==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return o}function Ls(t,e,n){if(t==null)return t;var r=[],i=0;return ro(t,r,"","",function(s){return e.call(n,s,i++)}),r}function ov(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(n){(t._status===0||t._status===-1)&&(t._status=1,t._result=n)},function(n){(t._status===0||t._status===-1)&&(t._status=2,t._result=n)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var lt={current:null},io={transition:null},lv={ReactCurrentDispatcher:lt,ReactCurrentBatchConfig:io,ReactCurrentOwner:Xc};function np(){throw Error("act(...) is not supported in production builds of React.")}re.Children={map:Ls,forEach:function(t,e,n){Ls(t,function(){e.apply(this,arguments)},n)},count:function(t){var e=0;return Ls(t,function(){e++}),e},toArray:function(t){return Ls(t,function(e){return e})||[]},only:function(t){if(!Zc(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};re.Component=li;re.Fragment=Ky;re.Profiler=qy;re.PureComponent=Yc;re.StrictMode=Yy;re.Suspense=ev;re.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=lv;re.act=np;re.cloneElement=function(t,e,n){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var r=qh({},t.props),i=t.key,s=t.ref,o=t._owner;if(e!=null){if(e.ref!==void 0&&(s=e.ref,o=Xc.current),e.key!==void 0&&(i=""+e.key),t.type&&t.type.defaultProps)var l=t.type.defaultProps;for(a in e)Jh.call(e,a)&&!ep.hasOwnProperty(a)&&(r[a]=e[a]===void 0&&l!==void 0?l[a]:e[a])}var a=arguments.length-2;if(a===1)r.children=n;else if(1<a){l=Array(a);for(var u=0;u<a;u++)l[u]=arguments[u+2];r.children=l}return{$$typeof:ws,type:t.type,key:i,ref:s,props:r,_owner:o}};re.createContext=function(t){return t={$$typeof:Zy,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:Xy,_context:t},t.Consumer=t};re.createElement=tp;re.createFactory=function(t){var e=tp.bind(null,t);return e.type=t,e};re.createRef=function(){return{current:null}};re.forwardRef=function(t){return{$$typeof:Jy,render:t}};re.isValidElement=Zc;re.lazy=function(t){return{$$typeof:nv,_payload:{_status:-1,_result:t},_init:ov}};re.memo=function(t,e){return{$$typeof:tv,type:t,compare:e===void 0?null:e}};re.startTransition=function(t){var e=io.transition;io.transition={};try{t()}finally{io.transition=e}};re.unstable_act=np;re.useCallback=function(t,e){return lt.current.useCallback(t,e)};re.useContext=function(t){return lt.current.useContext(t)};re.useDebugValue=function(){};re.useDeferredValue=function(t){return lt.current.useDeferredValue(t)};re.useEffect=function(t,e){return lt.current.useEffect(t,e)};re.useId=function(){return lt.current.useId()};re.useImperativeHandle=function(t,e,n){return lt.current.useImperativeHandle(t,e,n)};re.useInsertionEffect=function(t,e){return lt.current.useInsertionEffect(t,e)};re.useLayoutEffect=function(t,e){return lt.current.useLayoutEffect(t,e)};re.useMemo=function(t,e){return lt.current.useMemo(t,e)};re.useReducer=function(t,e,n){return lt.current.useReducer(t,e,n)};re.useRef=function(t){return lt.current.useRef(t)};re.useState=function(t){return lt.current.useState(t)};re.useSyncExternalStore=function(t,e,n){return lt.current.useSyncExternalStore(t,e,n)};re.useTransition=function(){return lt.current.useTransition()};re.version="18.3.1";Kh.exports=re;var ue=Kh.exports;const I=Gy(ue);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var av=ue,cv=Symbol.for("react.element"),uv=Symbol.for("react.fragment"),dv=Object.prototype.hasOwnProperty,fv=av.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,hv={key:!0,ref:!0,__self:!0,__source:!0};function rp(t,e,n){var r,i={},s=null,o=null;n!==void 0&&(s=""+n),e.key!==void 0&&(s=""+e.key),e.ref!==void 0&&(o=e.ref);for(r in e)dv.call(e,r)&&!hv.hasOwnProperty(r)&&(i[r]=e[r]);if(t&&t.defaultProps)for(r in e=t.defaultProps,e)i[r]===void 0&&(i[r]=e[r]);return{$$typeof:cv,type:t,key:s,ref:o,props:i,_owner:fv.current}}ll.Fragment=uv;ll.jsx=rp;ll.jsxs=rp;Qh.exports=ll;var c=Qh.exports,Aa={},ip={exports:{}},xt={},sp={exports:{}},op={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(D,G){var b=D.length;D.push(G);e:for(;0<b;){var U=b-1>>>1,F=D[U];if(0<i(F,G))D[U]=G,D[b]=F,b=U;else break e}}function n(D){return D.length===0?null:D[0]}function r(D){if(D.length===0)return null;var G=D[0],b=D.pop();if(b!==G){D[0]=b;e:for(var U=0,F=D.length,q=F>>>1;U<q;){var S=2*(U+1)-1,Q=D[S],X=S+1,z=D[X];if(0>i(Q,b))X<F&&0>i(z,Q)?(D[U]=z,D[X]=b,U=X):(D[U]=Q,D[S]=b,U=S);else if(X<F&&0>i(z,b))D[U]=z,D[X]=b,U=X;else break e}}return G}function i(D,G){var b=D.sortIndex-G.sortIndex;return b!==0?b:D.id-G.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;t.unstable_now=function(){return s.now()}}else{var o=Date,l=o.now();t.unstable_now=function(){return o.now()-l}}var a=[],u=[],h=1,f=null,d=3,v=!1,x=!1,g=!1,E=typeof setTimeout=="function"?setTimeout:null,y=typeof clearTimeout=="function"?clearTimeout:null,p=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function m(D){for(var G=n(u);G!==null;){if(G.callback===null)r(u);else if(G.startTime<=D)r(u),G.sortIndex=G.expirationTime,e(a,G);else break;G=n(u)}}function _(D){if(g=!1,m(D),!x)if(n(a)!==null)x=!0,de(k);else{var G=n(u);G!==null&&xe(_,G.startTime-D)}}function k(D,G){x=!1,g&&(g=!1,y(N),N=-1),v=!0;var b=d;try{for(m(G),f=n(a);f!==null&&(!(f.expirationTime>G)||D&&!V());){var U=f.callback;if(typeof U=="function"){f.callback=null,d=f.priorityLevel;var F=U(f.expirationTime<=G);G=t.unstable_now(),typeof F=="function"?f.callback=F:f===n(a)&&r(a),m(G)}else r(a);f=n(a)}if(f!==null)var q=!0;else{var S=n(u);S!==null&&xe(_,S.startTime-G),q=!1}return q}finally{f=null,d=b,v=!1}}var w=!1,C=null,N=-1,O=5,L=-1;function V(){return!(t.unstable_now()-L<O)}function J(){if(C!==null){var D=t.unstable_now();L=D;var G=!0;try{G=C(!0,D)}finally{G?se():(w=!1,C=null)}}else w=!1}var se;if(typeof p=="function")se=function(){p(J)};else if(typeof MessageChannel<"u"){var Ee=new MessageChannel,Te=Ee.port2;Ee.port1.onmessage=J,se=function(){Te.postMessage(null)}}else se=function(){E(J,0)};function de(D){C=D,w||(w=!0,se())}function xe(D,G){N=E(function(){D(t.unstable_now())},G)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(D){D.callback=null},t.unstable_continueExecution=function(){x||v||(x=!0,de(k))},t.unstable_forceFrameRate=function(D){0>D||125<D?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):O=0<D?Math.floor(1e3/D):5},t.unstable_getCurrentPriorityLevel=function(){return d},t.unstable_getFirstCallbackNode=function(){return n(a)},t.unstable_next=function(D){switch(d){case 1:case 2:case 3:var G=3;break;default:G=d}var b=d;d=G;try{return D()}finally{d=b}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(D,G){switch(D){case 1:case 2:case 3:case 4:case 5:break;default:D=3}var b=d;d=D;try{return G()}finally{d=b}},t.unstable_scheduleCallback=function(D,G,b){var U=t.unstable_now();switch(typeof b=="object"&&b!==null?(b=b.delay,b=typeof b=="number"&&0<b?U+b:U):b=U,D){case 1:var F=-1;break;case 2:F=250;break;case 5:F=1073741823;break;case 4:F=1e4;break;default:F=5e3}return F=b+F,D={id:h++,callback:G,priorityLevel:D,startTime:b,expirationTime:F,sortIndex:-1},b>U?(D.sortIndex=b,e(u,D),n(a)===null&&D===n(u)&&(g?(y(N),N=-1):g=!0,xe(_,b-U))):(D.sortIndex=F,e(a,D),x||v||(x=!0,de(k))),D},t.unstable_shouldYield=V,t.unstable_wrapCallback=function(D){var G=d;return function(){var b=d;d=G;try{return D.apply(this,arguments)}finally{d=b}}}})(op);sp.exports=op;var pv=sp.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var mv=ue,vt=pv;function R(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,n=1;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var lp=new Set,Gi={};function mr(t,e){Kr(t,e),Kr(t+"Capture",e)}function Kr(t,e){for(Gi[t]=e,t=0;t<e.length;t++)lp.add(e[t])}var rn=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Da=Object.prototype.hasOwnProperty,gv=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,Dd={},Od={};function yv(t){return Da.call(Od,t)?!0:Da.call(Dd,t)?!1:gv.test(t)?Od[t]=!0:(Dd[t]=!0,!1)}function vv(t,e,n,r){if(n!==null&&n.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return r?!1:n!==null?!n.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function _v(t,e,n,r){if(e===null||typeof e>"u"||vv(t,e,n,r))return!0;if(r)return!1;if(n!==null)switch(n.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function at(t,e,n,r,i,s,o){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=r,this.attributeNamespace=i,this.mustUseProperty=n,this.propertyName=t,this.type=e,this.sanitizeURL=s,this.removeEmptyString=o}var Ye={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){Ye[t]=new at(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];Ye[e]=new at(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){Ye[t]=new at(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){Ye[t]=new at(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){Ye[t]=new at(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){Ye[t]=new at(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){Ye[t]=new at(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){Ye[t]=new at(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){Ye[t]=new at(t,5,!1,t.toLowerCase(),null,!1,!1)});var Jc=/[\-:]([a-z])/g;function eu(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(Jc,eu);Ye[e]=new at(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(Jc,eu);Ye[e]=new at(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(Jc,eu);Ye[e]=new at(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){Ye[t]=new at(t,1,!1,t.toLowerCase(),null,!1,!1)});Ye.xlinkHref=new at("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){Ye[t]=new at(t,1,!1,t.toLowerCase(),null,!0,!0)});function tu(t,e,n,r){var i=Ye.hasOwnProperty(e)?Ye[e]:null;(i!==null?i.type!==0:r||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(_v(e,n,i,r)&&(n=null),r||i===null?yv(e)&&(n===null?t.removeAttribute(e):t.setAttribute(e,""+n)):i.mustUseProperty?t[i.propertyName]=n===null?i.type===3?!1:"":n:(e=i.attributeName,r=i.attributeNamespace,n===null?t.removeAttribute(e):(i=i.type,n=i===3||i===4&&n===!0?"":""+n,r?t.setAttributeNS(r,e,n):t.setAttribute(e,n))))}var un=mv.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Fs=Symbol.for("react.element"),Tr=Symbol.for("react.portal"),Nr=Symbol.for("react.fragment"),nu=Symbol.for("react.strict_mode"),Oa=Symbol.for("react.profiler"),ap=Symbol.for("react.provider"),cp=Symbol.for("react.context"),ru=Symbol.for("react.forward_ref"),Ma=Symbol.for("react.suspense"),La=Symbol.for("react.suspense_list"),iu=Symbol.for("react.memo"),mn=Symbol.for("react.lazy"),up=Symbol.for("react.offscreen"),Md=Symbol.iterator;function mi(t){return t===null||typeof t!="object"?null:(t=Md&&t[Md]||t["@@iterator"],typeof t=="function"?t:null)}var Pe=Object.assign,Gl;function Ni(t){if(Gl===void 0)try{throw Error()}catch(n){var e=n.stack.trim().match(/\n( *(at )?)/);Gl=e&&e[1]||""}return`
`+Gl+t}var Ql=!1;function Kl(t,e){if(!t||Ql)return"";Ql=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(u){var r=u}Reflect.construct(t,[],e)}else{try{e.call()}catch(u){r=u}t.call(e.prototype)}else{try{throw Error()}catch(u){r=u}t()}}catch(u){if(u&&r&&typeof u.stack=="string"){for(var i=u.stack.split(`
`),s=r.stack.split(`
`),o=i.length-1,l=s.length-1;1<=o&&0<=l&&i[o]!==s[l];)l--;for(;1<=o&&0<=l;o--,l--)if(i[o]!==s[l]){if(o!==1||l!==1)do if(o--,l--,0>l||i[o]!==s[l]){var a=`
`+i[o].replace(" at new "," at ");return t.displayName&&a.includes("<anonymous>")&&(a=a.replace("<anonymous>",t.displayName)),a}while(1<=o&&0<=l);break}}}finally{Ql=!1,Error.prepareStackTrace=n}return(t=t?t.displayName||t.name:"")?Ni(t):""}function xv(t){switch(t.tag){case 5:return Ni(t.type);case 16:return Ni("Lazy");case 13:return Ni("Suspense");case 19:return Ni("SuspenseList");case 0:case 2:case 15:return t=Kl(t.type,!1),t;case 11:return t=Kl(t.type.render,!1),t;case 1:return t=Kl(t.type,!0),t;default:return""}}function Fa(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case Nr:return"Fragment";case Tr:return"Portal";case Oa:return"Profiler";case nu:return"StrictMode";case Ma:return"Suspense";case La:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case cp:return(t.displayName||"Context")+".Consumer";case ap:return(t._context.displayName||"Context")+".Provider";case ru:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case iu:return e=t.displayName||null,e!==null?e:Fa(t.type)||"Memo";case mn:e=t._payload,t=t._init;try{return Fa(t(e))}catch{}}return null}function Sv(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Fa(e);case 8:return e===nu?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function On(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function dp(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function wv(t){var e=dp(t)?"checked":"value",n=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),r=""+t[e];if(!t.hasOwnProperty(e)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var i=n.get,s=n.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return i.call(this)},set:function(o){r=""+o,s.call(this,o)}}),Object.defineProperty(t,e,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(o){r=""+o},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function zs(t){t._valueTracker||(t._valueTracker=wv(t))}function fp(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var n=e.getValue(),r="";return t&&(r=dp(t)?t.checked?"true":"false":t.value),t=r,t!==n?(e.setValue(t),!0):!1}function _o(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function za(t,e){var n=e.checked;return Pe({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??t._wrapperState.initialChecked})}function Ld(t,e){var n=e.defaultValue==null?"":e.defaultValue,r=e.checked!=null?e.checked:e.defaultChecked;n=On(e.value!=null?e.value:n),t._wrapperState={initialChecked:r,initialValue:n,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function hp(t,e){e=e.checked,e!=null&&tu(t,"checked",e,!1)}function Ba(t,e){hp(t,e);var n=On(e.value),r=e.type;if(n!=null)r==="number"?(n===0&&t.value===""||t.value!=n)&&(t.value=""+n):t.value!==""+n&&(t.value=""+n);else if(r==="submit"||r==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?Wa(t,e.type,n):e.hasOwnProperty("defaultValue")&&Wa(t,e.type,On(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function Fd(t,e,n){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var r=e.type;if(!(r!=="submit"&&r!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,n||e===t.value||(t.value=e),t.defaultValue=e}n=t.name,n!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,n!==""&&(t.name=n)}function Wa(t,e,n){(e!=="number"||_o(t.ownerDocument)!==t)&&(n==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+n&&(t.defaultValue=""+n))}var Ii=Array.isArray;function Br(t,e,n,r){if(t=t.options,e){e={};for(var i=0;i<n.length;i++)e["$"+n[i]]=!0;for(n=0;n<t.length;n++)i=e.hasOwnProperty("$"+t[n].value),t[n].selected!==i&&(t[n].selected=i),i&&r&&(t[n].defaultSelected=!0)}else{for(n=""+On(n),e=null,i=0;i<t.length;i++){if(t[i].value===n){t[i].selected=!0,r&&(t[i].defaultSelected=!0);return}e!==null||t[i].disabled||(e=t[i])}e!==null&&(e.selected=!0)}}function $a(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(R(91));return Pe({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function zd(t,e){var n=e.value;if(n==null){if(n=e.children,e=e.defaultValue,n!=null){if(e!=null)throw Error(R(92));if(Ii(n)){if(1<n.length)throw Error(R(93));n=n[0]}e=n}e==null&&(e=""),n=e}t._wrapperState={initialValue:On(n)}}function pp(t,e){var n=On(e.value),r=On(e.defaultValue);n!=null&&(n=""+n,n!==t.value&&(t.value=n),e.defaultValue==null&&t.defaultValue!==n&&(t.defaultValue=n)),r!=null&&(t.defaultValue=""+r)}function Bd(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function mp(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Ua(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?mp(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var Bs,gp=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,n,r,i){MSApp.execUnsafeLocalFunction(function(){return t(e,n,r,i)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(Bs=Bs||document.createElement("div"),Bs.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=Bs.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function Qi(t,e){if(e){var n=t.firstChild;if(n&&n===t.lastChild&&n.nodeType===3){n.nodeValue=e;return}}t.textContent=e}var Ri={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},Cv=["Webkit","ms","Moz","O"];Object.keys(Ri).forEach(function(t){Cv.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),Ri[e]=Ri[t]})});function yp(t,e,n){return e==null||typeof e=="boolean"||e===""?"":n||typeof e!="number"||e===0||Ri.hasOwnProperty(t)&&Ri[t]?(""+e).trim():e+"px"}function vp(t,e){t=t.style;for(var n in e)if(e.hasOwnProperty(n)){var r=n.indexOf("--")===0,i=yp(n,e[n],r);n==="float"&&(n="cssFloat"),r?t.setProperty(n,i):t[n]=i}}var kv=Pe({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Ha(t,e){if(e){if(kv[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(R(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(R(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(R(61))}if(e.style!=null&&typeof e.style!="object")throw Error(R(62))}}function Va(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Ga=null;function su(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var Qa=null,Wr=null,$r=null;function Wd(t){if(t=Es(t)){if(typeof Qa!="function")throw Error(R(280));var e=t.stateNode;e&&(e=fl(e),Qa(t.stateNode,t.type,e))}}function _p(t){Wr?$r?$r.push(t):$r=[t]:Wr=t}function xp(){if(Wr){var t=Wr,e=$r;if($r=Wr=null,Wd(t),e)for(t=0;t<e.length;t++)Wd(e[t])}}function Sp(t,e){return t(e)}function wp(){}var Yl=!1;function Cp(t,e,n){if(Yl)return t(e,n);Yl=!0;try{return Sp(t,e,n)}finally{Yl=!1,(Wr!==null||$r!==null)&&(wp(),xp())}}function Ki(t,e){var n=t.stateNode;if(n===null)return null;var r=fl(n);if(r===null)return null;n=r[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(t=t.type,r=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!r;break e;default:t=!1}if(t)return null;if(n&&typeof n!="function")throw Error(R(231,e,typeof n));return n}var Ka=!1;if(rn)try{var gi={};Object.defineProperty(gi,"passive",{get:function(){Ka=!0}}),window.addEventListener("test",gi,gi),window.removeEventListener("test",gi,gi)}catch{Ka=!1}function Ev(t,e,n,r,i,s,o,l,a){var u=Array.prototype.slice.call(arguments,3);try{e.apply(n,u)}catch(h){this.onError(h)}}var ji=!1,xo=null,So=!1,Ya=null,Tv={onError:function(t){ji=!0,xo=t}};function Nv(t,e,n,r,i,s,o,l,a){ji=!1,xo=null,Ev.apply(Tv,arguments)}function Iv(t,e,n,r,i,s,o,l,a){if(Nv.apply(this,arguments),ji){if(ji){var u=xo;ji=!1,xo=null}else throw Error(R(198));So||(So=!0,Ya=u)}}function gr(t){var e=t,n=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(n=e.return),t=e.return;while(t)}return e.tag===3?n:null}function kp(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function $d(t){if(gr(t)!==t)throw Error(R(188))}function bv(t){var e=t.alternate;if(!e){if(e=gr(t),e===null)throw Error(R(188));return e!==t?null:t}for(var n=t,r=e;;){var i=n.return;if(i===null)break;var s=i.alternate;if(s===null){if(r=i.return,r!==null){n=r;continue}break}if(i.child===s.child){for(s=i.child;s;){if(s===n)return $d(i),t;if(s===r)return $d(i),e;s=s.sibling}throw Error(R(188))}if(n.return!==r.return)n=i,r=s;else{for(var o=!1,l=i.child;l;){if(l===n){o=!0,n=i,r=s;break}if(l===r){o=!0,r=i,n=s;break}l=l.sibling}if(!o){for(l=s.child;l;){if(l===n){o=!0,n=s,r=i;break}if(l===r){o=!0,r=s,n=i;break}l=l.sibling}if(!o)throw Error(R(189))}}if(n.alternate!==r)throw Error(R(190))}if(n.tag!==3)throw Error(R(188));return n.stateNode.current===n?t:e}function Ep(t){return t=bv(t),t!==null?Tp(t):null}function Tp(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=Tp(t);if(e!==null)return e;t=t.sibling}return null}var Np=vt.unstable_scheduleCallback,Ud=vt.unstable_cancelCallback,Pv=vt.unstable_shouldYield,Rv=vt.unstable_requestPaint,Oe=vt.unstable_now,jv=vt.unstable_getCurrentPriorityLevel,ou=vt.unstable_ImmediatePriority,Ip=vt.unstable_UserBlockingPriority,wo=vt.unstable_NormalPriority,Av=vt.unstable_LowPriority,bp=vt.unstable_IdlePriority,al=null,Gt=null;function Dv(t){if(Gt&&typeof Gt.onCommitFiberRoot=="function")try{Gt.onCommitFiberRoot(al,t,void 0,(t.current.flags&128)===128)}catch{}}var Ot=Math.clz32?Math.clz32:Lv,Ov=Math.log,Mv=Math.LN2;function Lv(t){return t>>>=0,t===0?32:31-(Ov(t)/Mv|0)|0}var Ws=64,$s=4194304;function bi(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function Co(t,e){var n=t.pendingLanes;if(n===0)return 0;var r=0,i=t.suspendedLanes,s=t.pingedLanes,o=n&268435455;if(o!==0){var l=o&~i;l!==0?r=bi(l):(s&=o,s!==0&&(r=bi(s)))}else o=n&~i,o!==0?r=bi(o):s!==0&&(r=bi(s));if(r===0)return 0;if(e!==0&&e!==r&&!(e&i)&&(i=r&-r,s=e&-e,i>=s||i===16&&(s&4194240)!==0))return e;if(r&4&&(r|=n&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=r;0<e;)n=31-Ot(e),i=1<<n,r|=t[n],e&=~i;return r}function Fv(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function zv(t,e){for(var n=t.suspendedLanes,r=t.pingedLanes,i=t.expirationTimes,s=t.pendingLanes;0<s;){var o=31-Ot(s),l=1<<o,a=i[o];a===-1?(!(l&n)||l&r)&&(i[o]=Fv(l,e)):a<=e&&(t.expiredLanes|=l),s&=~l}}function qa(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function Pp(){var t=Ws;return Ws<<=1,!(Ws&4194240)&&(Ws=64),t}function ql(t){for(var e=[],n=0;31>n;n++)e.push(t);return e}function Cs(t,e,n){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-Ot(e),t[e]=n}function Bv(t,e){var n=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var r=t.eventTimes;for(t=t.expirationTimes;0<n;){var i=31-Ot(n),s=1<<i;e[i]=0,r[i]=-1,t[i]=-1,n&=~s}}function lu(t,e){var n=t.entangledLanes|=e;for(t=t.entanglements;n;){var r=31-Ot(n),i=1<<r;i&e|t[r]&e&&(t[r]|=e),n&=~i}}var fe=0;function Rp(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var jp,au,Ap,Dp,Op,Xa=!1,Us=[],wn=null,Cn=null,kn=null,Yi=new Map,qi=new Map,yn=[],Wv="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Hd(t,e){switch(t){case"focusin":case"focusout":wn=null;break;case"dragenter":case"dragleave":Cn=null;break;case"mouseover":case"mouseout":kn=null;break;case"pointerover":case"pointerout":Yi.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":qi.delete(e.pointerId)}}function yi(t,e,n,r,i,s){return t===null||t.nativeEvent!==s?(t={blockedOn:e,domEventName:n,eventSystemFlags:r,nativeEvent:s,targetContainers:[i]},e!==null&&(e=Es(e),e!==null&&au(e)),t):(t.eventSystemFlags|=r,e=t.targetContainers,i!==null&&e.indexOf(i)===-1&&e.push(i),t)}function $v(t,e,n,r,i){switch(e){case"focusin":return wn=yi(wn,t,e,n,r,i),!0;case"dragenter":return Cn=yi(Cn,t,e,n,r,i),!0;case"mouseover":return kn=yi(kn,t,e,n,r,i),!0;case"pointerover":var s=i.pointerId;return Yi.set(s,yi(Yi.get(s)||null,t,e,n,r,i)),!0;case"gotpointercapture":return s=i.pointerId,qi.set(s,yi(qi.get(s)||null,t,e,n,r,i)),!0}return!1}function Mp(t){var e=Xn(t.target);if(e!==null){var n=gr(e);if(n!==null){if(e=n.tag,e===13){if(e=kp(n),e!==null){t.blockedOn=e,Op(t.priority,function(){Ap(n)});return}}else if(e===3&&n.stateNode.current.memoizedState.isDehydrated){t.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}t.blockedOn=null}function so(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var n=Za(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(n===null){n=t.nativeEvent;var r=new n.constructor(n.type,n);Ga=r,n.target.dispatchEvent(r),Ga=null}else return e=Es(n),e!==null&&au(e),t.blockedOn=n,!1;e.shift()}return!0}function Vd(t,e,n){so(t)&&n.delete(e)}function Uv(){Xa=!1,wn!==null&&so(wn)&&(wn=null),Cn!==null&&so(Cn)&&(Cn=null),kn!==null&&so(kn)&&(kn=null),Yi.forEach(Vd),qi.forEach(Vd)}function vi(t,e){t.blockedOn===e&&(t.blockedOn=null,Xa||(Xa=!0,vt.unstable_scheduleCallback(vt.unstable_NormalPriority,Uv)))}function Xi(t){function e(i){return vi(i,t)}if(0<Us.length){vi(Us[0],t);for(var n=1;n<Us.length;n++){var r=Us[n];r.blockedOn===t&&(r.blockedOn=null)}}for(wn!==null&&vi(wn,t),Cn!==null&&vi(Cn,t),kn!==null&&vi(kn,t),Yi.forEach(e),qi.forEach(e),n=0;n<yn.length;n++)r=yn[n],r.blockedOn===t&&(r.blockedOn=null);for(;0<yn.length&&(n=yn[0],n.blockedOn===null);)Mp(n),n.blockedOn===null&&yn.shift()}var Ur=un.ReactCurrentBatchConfig,ko=!0;function Hv(t,e,n,r){var i=fe,s=Ur.transition;Ur.transition=null;try{fe=1,cu(t,e,n,r)}finally{fe=i,Ur.transition=s}}function Vv(t,e,n,r){var i=fe,s=Ur.transition;Ur.transition=null;try{fe=4,cu(t,e,n,r)}finally{fe=i,Ur.transition=s}}function cu(t,e,n,r){if(ko){var i=Za(t,e,n,r);if(i===null)oa(t,e,r,Eo,n),Hd(t,r);else if($v(i,t,e,n,r))r.stopPropagation();else if(Hd(t,r),e&4&&-1<Wv.indexOf(t)){for(;i!==null;){var s=Es(i);if(s!==null&&jp(s),s=Za(t,e,n,r),s===null&&oa(t,e,r,Eo,n),s===i)break;i=s}i!==null&&r.stopPropagation()}else oa(t,e,r,null,n)}}var Eo=null;function Za(t,e,n,r){if(Eo=null,t=su(r),t=Xn(t),t!==null)if(e=gr(t),e===null)t=null;else if(n=e.tag,n===13){if(t=kp(e),t!==null)return t;t=null}else if(n===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return Eo=t,null}function Lp(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(jv()){case ou:return 1;case Ip:return 4;case wo:case Av:return 16;case bp:return 536870912;default:return 16}default:return 16}}var _n=null,uu=null,oo=null;function Fp(){if(oo)return oo;var t,e=uu,n=e.length,r,i="value"in _n?_n.value:_n.textContent,s=i.length;for(t=0;t<n&&e[t]===i[t];t++);var o=n-t;for(r=1;r<=o&&e[n-r]===i[s-r];r++);return oo=i.slice(t,1<r?1-r:void 0)}function lo(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function Hs(){return!0}function Gd(){return!1}function St(t){function e(n,r,i,s,o){this._reactName=n,this._targetInst=i,this.type=r,this.nativeEvent=s,this.target=o,this.currentTarget=null;for(var l in t)t.hasOwnProperty(l)&&(n=t[l],this[l]=n?n(s):s[l]);return this.isDefaultPrevented=(s.defaultPrevented!=null?s.defaultPrevented:s.returnValue===!1)?Hs:Gd,this.isPropagationStopped=Gd,this}return Pe(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=Hs)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=Hs)},persist:function(){},isPersistent:Hs}),e}var ai={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},du=St(ai),ks=Pe({},ai,{view:0,detail:0}),Gv=St(ks),Xl,Zl,_i,cl=Pe({},ks,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:fu,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==_i&&(_i&&t.type==="mousemove"?(Xl=t.screenX-_i.screenX,Zl=t.screenY-_i.screenY):Zl=Xl=0,_i=t),Xl)},movementY:function(t){return"movementY"in t?t.movementY:Zl}}),Qd=St(cl),Qv=Pe({},cl,{dataTransfer:0}),Kv=St(Qv),Yv=Pe({},ks,{relatedTarget:0}),Jl=St(Yv),qv=Pe({},ai,{animationName:0,elapsedTime:0,pseudoElement:0}),Xv=St(qv),Zv=Pe({},ai,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),Jv=St(Zv),e_=Pe({},ai,{data:0}),Kd=St(e_),t_={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},n_={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},r_={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function i_(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=r_[t])?!!e[t]:!1}function fu(){return i_}var s_=Pe({},ks,{key:function(t){if(t.key){var e=t_[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=lo(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?n_[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:fu,charCode:function(t){return t.type==="keypress"?lo(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?lo(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),o_=St(s_),l_=Pe({},cl,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Yd=St(l_),a_=Pe({},ks,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:fu}),c_=St(a_),u_=Pe({},ai,{propertyName:0,elapsedTime:0,pseudoElement:0}),d_=St(u_),f_=Pe({},cl,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),h_=St(f_),p_=[9,13,27,32],hu=rn&&"CompositionEvent"in window,Ai=null;rn&&"documentMode"in document&&(Ai=document.documentMode);var m_=rn&&"TextEvent"in window&&!Ai,zp=rn&&(!hu||Ai&&8<Ai&&11>=Ai),qd=" ",Xd=!1;function Bp(t,e){switch(t){case"keyup":return p_.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Wp(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var Ir=!1;function g_(t,e){switch(t){case"compositionend":return Wp(e);case"keypress":return e.which!==32?null:(Xd=!0,qd);case"textInput":return t=e.data,t===qd&&Xd?null:t;default:return null}}function y_(t,e){if(Ir)return t==="compositionend"||!hu&&Bp(t,e)?(t=Fp(),oo=uu=_n=null,Ir=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return zp&&e.locale!=="ko"?null:e.data;default:return null}}var v_={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Zd(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!v_[t.type]:e==="textarea"}function $p(t,e,n,r){_p(r),e=To(e,"onChange"),0<e.length&&(n=new du("onChange","change",null,n,r),t.push({event:n,listeners:e}))}var Di=null,Zi=null;function __(t){Jp(t,0)}function ul(t){var e=Rr(t);if(fp(e))return t}function x_(t,e){if(t==="change")return e}var Up=!1;if(rn){var ea;if(rn){var ta="oninput"in document;if(!ta){var Jd=document.createElement("div");Jd.setAttribute("oninput","return;"),ta=typeof Jd.oninput=="function"}ea=ta}else ea=!1;Up=ea&&(!document.documentMode||9<document.documentMode)}function ef(){Di&&(Di.detachEvent("onpropertychange",Hp),Zi=Di=null)}function Hp(t){if(t.propertyName==="value"&&ul(Zi)){var e=[];$p(e,Zi,t,su(t)),Cp(__,e)}}function S_(t,e,n){t==="focusin"?(ef(),Di=e,Zi=n,Di.attachEvent("onpropertychange",Hp)):t==="focusout"&&ef()}function w_(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return ul(Zi)}function C_(t,e){if(t==="click")return ul(e)}function k_(t,e){if(t==="input"||t==="change")return ul(e)}function E_(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var zt=typeof Object.is=="function"?Object.is:E_;function Ji(t,e){if(zt(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var n=Object.keys(t),r=Object.keys(e);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var i=n[r];if(!Da.call(e,i)||!zt(t[i],e[i]))return!1}return!0}function tf(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function nf(t,e){var n=tf(t);t=0;for(var r;n;){if(n.nodeType===3){if(r=t+n.textContent.length,t<=e&&r>=e)return{node:n,offset:e-t};t=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=tf(n)}}function Vp(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?Vp(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function Gp(){for(var t=window,e=_o();e instanceof t.HTMLIFrameElement;){try{var n=typeof e.contentWindow.location.href=="string"}catch{n=!1}if(n)t=e.contentWindow;else break;e=_o(t.document)}return e}function pu(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function T_(t){var e=Gp(),n=t.focusedElem,r=t.selectionRange;if(e!==n&&n&&n.ownerDocument&&Vp(n.ownerDocument.documentElement,n)){if(r!==null&&pu(n)){if(e=r.start,t=r.end,t===void 0&&(t=e),"selectionStart"in n)n.selectionStart=e,n.selectionEnd=Math.min(t,n.value.length);else if(t=(e=n.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var i=n.textContent.length,s=Math.min(r.start,i);r=r.end===void 0?s:Math.min(r.end,i),!t.extend&&s>r&&(i=r,r=s,s=i),i=nf(n,s);var o=nf(n,r);i&&o&&(t.rangeCount!==1||t.anchorNode!==i.node||t.anchorOffset!==i.offset||t.focusNode!==o.node||t.focusOffset!==o.offset)&&(e=e.createRange(),e.setStart(i.node,i.offset),t.removeAllRanges(),s>r?(t.addRange(e),t.extend(o.node,o.offset)):(e.setEnd(o.node,o.offset),t.addRange(e)))}}for(e=[],t=n;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<e.length;n++)t=e[n],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var N_=rn&&"documentMode"in document&&11>=document.documentMode,br=null,Ja=null,Oi=null,ec=!1;function rf(t,e,n){var r=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;ec||br==null||br!==_o(r)||(r=br,"selectionStart"in r&&pu(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),Oi&&Ji(Oi,r)||(Oi=r,r=To(Ja,"onSelect"),0<r.length&&(e=new du("onSelect","select",null,e,n),t.push({event:e,listeners:r}),e.target=br)))}function Vs(t,e){var n={};return n[t.toLowerCase()]=e.toLowerCase(),n["Webkit"+t]="webkit"+e,n["Moz"+t]="moz"+e,n}var Pr={animationend:Vs("Animation","AnimationEnd"),animationiteration:Vs("Animation","AnimationIteration"),animationstart:Vs("Animation","AnimationStart"),transitionend:Vs("Transition","TransitionEnd")},na={},Qp={};rn&&(Qp=document.createElement("div").style,"AnimationEvent"in window||(delete Pr.animationend.animation,delete Pr.animationiteration.animation,delete Pr.animationstart.animation),"TransitionEvent"in window||delete Pr.transitionend.transition);function dl(t){if(na[t])return na[t];if(!Pr[t])return t;var e=Pr[t],n;for(n in e)if(e.hasOwnProperty(n)&&n in Qp)return na[t]=e[n];return t}var Kp=dl("animationend"),Yp=dl("animationiteration"),qp=dl("animationstart"),Xp=dl("transitionend"),Zp=new Map,sf="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Wn(t,e){Zp.set(t,e),mr(e,[t])}for(var ra=0;ra<sf.length;ra++){var ia=sf[ra],I_=ia.toLowerCase(),b_=ia[0].toUpperCase()+ia.slice(1);Wn(I_,"on"+b_)}Wn(Kp,"onAnimationEnd");Wn(Yp,"onAnimationIteration");Wn(qp,"onAnimationStart");Wn("dblclick","onDoubleClick");Wn("focusin","onFocus");Wn("focusout","onBlur");Wn(Xp,"onTransitionEnd");Kr("onMouseEnter",["mouseout","mouseover"]);Kr("onMouseLeave",["mouseout","mouseover"]);Kr("onPointerEnter",["pointerout","pointerover"]);Kr("onPointerLeave",["pointerout","pointerover"]);mr("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));mr("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));mr("onBeforeInput",["compositionend","keypress","textInput","paste"]);mr("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));mr("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));mr("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Pi="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),P_=new Set("cancel close invalid load scroll toggle".split(" ").concat(Pi));function of(t,e,n){var r=t.type||"unknown-event";t.currentTarget=n,Iv(r,e,void 0,t),t.currentTarget=null}function Jp(t,e){e=(e&4)!==0;for(var n=0;n<t.length;n++){var r=t[n],i=r.event;r=r.listeners;e:{var s=void 0;if(e)for(var o=r.length-1;0<=o;o--){var l=r[o],a=l.instance,u=l.currentTarget;if(l=l.listener,a!==s&&i.isPropagationStopped())break e;of(i,l,u),s=a}else for(o=0;o<r.length;o++){if(l=r[o],a=l.instance,u=l.currentTarget,l=l.listener,a!==s&&i.isPropagationStopped())break e;of(i,l,u),s=a}}}if(So)throw t=Ya,So=!1,Ya=null,t}function Se(t,e){var n=e[sc];n===void 0&&(n=e[sc]=new Set);var r=t+"__bubble";n.has(r)||(em(e,t,2,!1),n.add(r))}function sa(t,e,n){var r=0;e&&(r|=4),em(n,t,r,e)}var Gs="_reactListening"+Math.random().toString(36).slice(2);function es(t){if(!t[Gs]){t[Gs]=!0,lp.forEach(function(n){n!=="selectionchange"&&(P_.has(n)||sa(n,!1,t),sa(n,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[Gs]||(e[Gs]=!0,sa("selectionchange",!1,e))}}function em(t,e,n,r){switch(Lp(e)){case 1:var i=Hv;break;case 4:i=Vv;break;default:i=cu}n=i.bind(null,e,n,t),i=void 0,!Ka||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(i=!0),r?i!==void 0?t.addEventListener(e,n,{capture:!0,passive:i}):t.addEventListener(e,n,!0):i!==void 0?t.addEventListener(e,n,{passive:i}):t.addEventListener(e,n,!1)}function oa(t,e,n,r,i){var s=r;if(!(e&1)&&!(e&2)&&r!==null)e:for(;;){if(r===null)return;var o=r.tag;if(o===3||o===4){var l=r.stateNode.containerInfo;if(l===i||l.nodeType===8&&l.parentNode===i)break;if(o===4)for(o=r.return;o!==null;){var a=o.tag;if((a===3||a===4)&&(a=o.stateNode.containerInfo,a===i||a.nodeType===8&&a.parentNode===i))return;o=o.return}for(;l!==null;){if(o=Xn(l),o===null)return;if(a=o.tag,a===5||a===6){r=s=o;continue e}l=l.parentNode}}r=r.return}Cp(function(){var u=s,h=su(n),f=[];e:{var d=Zp.get(t);if(d!==void 0){var v=du,x=t;switch(t){case"keypress":if(lo(n)===0)break e;case"keydown":case"keyup":v=o_;break;case"focusin":x="focus",v=Jl;break;case"focusout":x="blur",v=Jl;break;case"beforeblur":case"afterblur":v=Jl;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":v=Qd;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":v=Kv;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":v=c_;break;case Kp:case Yp:case qp:v=Xv;break;case Xp:v=d_;break;case"scroll":v=Gv;break;case"wheel":v=h_;break;case"copy":case"cut":case"paste":v=Jv;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":v=Yd}var g=(e&4)!==0,E=!g&&t==="scroll",y=g?d!==null?d+"Capture":null:d;g=[];for(var p=u,m;p!==null;){m=p;var _=m.stateNode;if(m.tag===5&&_!==null&&(m=_,y!==null&&(_=Ki(p,y),_!=null&&g.push(ts(p,_,m)))),E)break;p=p.return}0<g.length&&(d=new v(d,x,null,n,h),f.push({event:d,listeners:g}))}}if(!(e&7)){e:{if(d=t==="mouseover"||t==="pointerover",v=t==="mouseout"||t==="pointerout",d&&n!==Ga&&(x=n.relatedTarget||n.fromElement)&&(Xn(x)||x[sn]))break e;if((v||d)&&(d=h.window===h?h:(d=h.ownerDocument)?d.defaultView||d.parentWindow:window,v?(x=n.relatedTarget||n.toElement,v=u,x=x?Xn(x):null,x!==null&&(E=gr(x),x!==E||x.tag!==5&&x.tag!==6)&&(x=null)):(v=null,x=u),v!==x)){if(g=Qd,_="onMouseLeave",y="onMouseEnter",p="mouse",(t==="pointerout"||t==="pointerover")&&(g=Yd,_="onPointerLeave",y="onPointerEnter",p="pointer"),E=v==null?d:Rr(v),m=x==null?d:Rr(x),d=new g(_,p+"leave",v,n,h),d.target=E,d.relatedTarget=m,_=null,Xn(h)===u&&(g=new g(y,p+"enter",x,n,h),g.target=m,g.relatedTarget=E,_=g),E=_,v&&x)t:{for(g=v,y=x,p=0,m=g;m;m=Cr(m))p++;for(m=0,_=y;_;_=Cr(_))m++;for(;0<p-m;)g=Cr(g),p--;for(;0<m-p;)y=Cr(y),m--;for(;p--;){if(g===y||y!==null&&g===y.alternate)break t;g=Cr(g),y=Cr(y)}g=null}else g=null;v!==null&&lf(f,d,v,g,!1),x!==null&&E!==null&&lf(f,E,x,g,!0)}}e:{if(d=u?Rr(u):window,v=d.nodeName&&d.nodeName.toLowerCase(),v==="select"||v==="input"&&d.type==="file")var k=x_;else if(Zd(d))if(Up)k=k_;else{k=w_;var w=S_}else(v=d.nodeName)&&v.toLowerCase()==="input"&&(d.type==="checkbox"||d.type==="radio")&&(k=C_);if(k&&(k=k(t,u))){$p(f,k,n,h);break e}w&&w(t,d,u),t==="focusout"&&(w=d._wrapperState)&&w.controlled&&d.type==="number"&&Wa(d,"number",d.value)}switch(w=u?Rr(u):window,t){case"focusin":(Zd(w)||w.contentEditable==="true")&&(br=w,Ja=u,Oi=null);break;case"focusout":Oi=Ja=br=null;break;case"mousedown":ec=!0;break;case"contextmenu":case"mouseup":case"dragend":ec=!1,rf(f,n,h);break;case"selectionchange":if(N_)break;case"keydown":case"keyup":rf(f,n,h)}var C;if(hu)e:{switch(t){case"compositionstart":var N="onCompositionStart";break e;case"compositionend":N="onCompositionEnd";break e;case"compositionupdate":N="onCompositionUpdate";break e}N=void 0}else Ir?Bp(t,n)&&(N="onCompositionEnd"):t==="keydown"&&n.keyCode===229&&(N="onCompositionStart");N&&(zp&&n.locale!=="ko"&&(Ir||N!=="onCompositionStart"?N==="onCompositionEnd"&&Ir&&(C=Fp()):(_n=h,uu="value"in _n?_n.value:_n.textContent,Ir=!0)),w=To(u,N),0<w.length&&(N=new Kd(N,t,null,n,h),f.push({event:N,listeners:w}),C?N.data=C:(C=Wp(n),C!==null&&(N.data=C)))),(C=m_?g_(t,n):y_(t,n))&&(u=To(u,"onBeforeInput"),0<u.length&&(h=new Kd("onBeforeInput","beforeinput",null,n,h),f.push({event:h,listeners:u}),h.data=C))}Jp(f,e)})}function ts(t,e,n){return{instance:t,listener:e,currentTarget:n}}function To(t,e){for(var n=e+"Capture",r=[];t!==null;){var i=t,s=i.stateNode;i.tag===5&&s!==null&&(i=s,s=Ki(t,n),s!=null&&r.unshift(ts(t,s,i)),s=Ki(t,e),s!=null&&r.push(ts(t,s,i))),t=t.return}return r}function Cr(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function lf(t,e,n,r,i){for(var s=e._reactName,o=[];n!==null&&n!==r;){var l=n,a=l.alternate,u=l.stateNode;if(a!==null&&a===r)break;l.tag===5&&u!==null&&(l=u,i?(a=Ki(n,s),a!=null&&o.unshift(ts(n,a,l))):i||(a=Ki(n,s),a!=null&&o.push(ts(n,a,l)))),n=n.return}o.length!==0&&t.push({event:e,listeners:o})}var R_=/\r\n?/g,j_=/\u0000|\uFFFD/g;function af(t){return(typeof t=="string"?t:""+t).replace(R_,`
`).replace(j_,"")}function Qs(t,e,n){if(e=af(e),af(t)!==e&&n)throw Error(R(425))}function No(){}var tc=null,nc=null;function rc(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var ic=typeof setTimeout=="function"?setTimeout:void 0,A_=typeof clearTimeout=="function"?clearTimeout:void 0,cf=typeof Promise=="function"?Promise:void 0,D_=typeof queueMicrotask=="function"?queueMicrotask:typeof cf<"u"?function(t){return cf.resolve(null).then(t).catch(O_)}:ic;function O_(t){setTimeout(function(){throw t})}function la(t,e){var n=e,r=0;do{var i=n.nextSibling;if(t.removeChild(n),i&&i.nodeType===8)if(n=i.data,n==="/$"){if(r===0){t.removeChild(i),Xi(e);return}r--}else n!=="$"&&n!=="$?"&&n!=="$!"||r++;n=i}while(n);Xi(e)}function En(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function uf(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="$"||n==="$!"||n==="$?"){if(e===0)return t;e--}else n==="/$"&&e++}t=t.previousSibling}return null}var ci=Math.random().toString(36).slice(2),Vt="__reactFiber$"+ci,ns="__reactProps$"+ci,sn="__reactContainer$"+ci,sc="__reactEvents$"+ci,M_="__reactListeners$"+ci,L_="__reactHandles$"+ci;function Xn(t){var e=t[Vt];if(e)return e;for(var n=t.parentNode;n;){if(e=n[sn]||n[Vt]){if(n=e.alternate,e.child!==null||n!==null&&n.child!==null)for(t=uf(t);t!==null;){if(n=t[Vt])return n;t=uf(t)}return e}t=n,n=t.parentNode}return null}function Es(t){return t=t[Vt]||t[sn],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function Rr(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(R(33))}function fl(t){return t[ns]||null}var oc=[],jr=-1;function $n(t){return{current:t}}function we(t){0>jr||(t.current=oc[jr],oc[jr]=null,jr--)}function _e(t,e){jr++,oc[jr]=t.current,t.current=e}var Mn={},tt=$n(Mn),ft=$n(!1),sr=Mn;function Yr(t,e){var n=t.type.contextTypes;if(!n)return Mn;var r=t.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===e)return r.__reactInternalMemoizedMaskedChildContext;var i={},s;for(s in n)i[s]=e[s];return r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=i),i}function ht(t){return t=t.childContextTypes,t!=null}function Io(){we(ft),we(tt)}function df(t,e,n){if(tt.current!==Mn)throw Error(R(168));_e(tt,e),_e(ft,n)}function tm(t,e,n){var r=t.stateNode;if(e=e.childContextTypes,typeof r.getChildContext!="function")return n;r=r.getChildContext();for(var i in r)if(!(i in e))throw Error(R(108,Sv(t)||"Unknown",i));return Pe({},n,r)}function bo(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||Mn,sr=tt.current,_e(tt,t),_e(ft,ft.current),!0}function ff(t,e,n){var r=t.stateNode;if(!r)throw Error(R(169));n?(t=tm(t,e,sr),r.__reactInternalMemoizedMergedChildContext=t,we(ft),we(tt),_e(tt,t)):we(ft),_e(ft,n)}var qt=null,hl=!1,aa=!1;function nm(t){qt===null?qt=[t]:qt.push(t)}function F_(t){hl=!0,nm(t)}function Un(){if(!aa&&qt!==null){aa=!0;var t=0,e=fe;try{var n=qt;for(fe=1;t<n.length;t++){var r=n[t];do r=r(!0);while(r!==null)}qt=null,hl=!1}catch(i){throw qt!==null&&(qt=qt.slice(t+1)),Np(ou,Un),i}finally{fe=e,aa=!1}}return null}var Ar=[],Dr=0,Po=null,Ro=0,wt=[],Ct=0,or=null,Xt=1,Zt="";function Vn(t,e){Ar[Dr++]=Ro,Ar[Dr++]=Po,Po=t,Ro=e}function rm(t,e,n){wt[Ct++]=Xt,wt[Ct++]=Zt,wt[Ct++]=or,or=t;var r=Xt;t=Zt;var i=32-Ot(r)-1;r&=~(1<<i),n+=1;var s=32-Ot(e)+i;if(30<s){var o=i-i%5;s=(r&(1<<o)-1).toString(32),r>>=o,i-=o,Xt=1<<32-Ot(e)+i|n<<i|r,Zt=s+t}else Xt=1<<s|n<<i|r,Zt=t}function mu(t){t.return!==null&&(Vn(t,1),rm(t,1,0))}function gu(t){for(;t===Po;)Po=Ar[--Dr],Ar[Dr]=null,Ro=Ar[--Dr],Ar[Dr]=null;for(;t===or;)or=wt[--Ct],wt[Ct]=null,Zt=wt[--Ct],wt[Ct]=null,Xt=wt[--Ct],wt[Ct]=null}var yt=null,gt=null,Ce=!1,jt=null;function im(t,e){var n=kt(5,null,null,0);n.elementType="DELETED",n.stateNode=e,n.return=t,e=t.deletions,e===null?(t.deletions=[n],t.flags|=16):e.push(n)}function hf(t,e){switch(t.tag){case 5:var n=t.type;return e=e.nodeType!==1||n.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,yt=t,gt=En(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,yt=t,gt=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(n=or!==null?{id:Xt,overflow:Zt}:null,t.memoizedState={dehydrated:e,treeContext:n,retryLane:1073741824},n=kt(18,null,null,0),n.stateNode=e,n.return=t,t.child=n,yt=t,gt=null,!0):!1;default:return!1}}function lc(t){return(t.mode&1)!==0&&(t.flags&128)===0}function ac(t){if(Ce){var e=gt;if(e){var n=e;if(!hf(t,e)){if(lc(t))throw Error(R(418));e=En(n.nextSibling);var r=yt;e&&hf(t,e)?im(r,n):(t.flags=t.flags&-4097|2,Ce=!1,yt=t)}}else{if(lc(t))throw Error(R(418));t.flags=t.flags&-4097|2,Ce=!1,yt=t}}}function pf(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;yt=t}function Ks(t){if(t!==yt)return!1;if(!Ce)return pf(t),Ce=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!rc(t.type,t.memoizedProps)),e&&(e=gt)){if(lc(t))throw sm(),Error(R(418));for(;e;)im(t,e),e=En(e.nextSibling)}if(pf(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(R(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="/$"){if(e===0){gt=En(t.nextSibling);break e}e--}else n!=="$"&&n!=="$!"&&n!=="$?"||e++}t=t.nextSibling}gt=null}}else gt=yt?En(t.stateNode.nextSibling):null;return!0}function sm(){for(var t=gt;t;)t=En(t.nextSibling)}function qr(){gt=yt=null,Ce=!1}function yu(t){jt===null?jt=[t]:jt.push(t)}var z_=un.ReactCurrentBatchConfig;function xi(t,e,n){if(t=n.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(R(309));var r=n.stateNode}if(!r)throw Error(R(147,t));var i=r,s=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===s?e.ref:(e=function(o){var l=i.refs;o===null?delete l[s]:l[s]=o},e._stringRef=s,e)}if(typeof t!="string")throw Error(R(284));if(!n._owner)throw Error(R(290,t))}return t}function Ys(t,e){throw t=Object.prototype.toString.call(e),Error(R(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function mf(t){var e=t._init;return e(t._payload)}function om(t){function e(y,p){if(t){var m=y.deletions;m===null?(y.deletions=[p],y.flags|=16):m.push(p)}}function n(y,p){if(!t)return null;for(;p!==null;)e(y,p),p=p.sibling;return null}function r(y,p){for(y=new Map;p!==null;)p.key!==null?y.set(p.key,p):y.set(p.index,p),p=p.sibling;return y}function i(y,p){return y=bn(y,p),y.index=0,y.sibling=null,y}function s(y,p,m){return y.index=m,t?(m=y.alternate,m!==null?(m=m.index,m<p?(y.flags|=2,p):m):(y.flags|=2,p)):(y.flags|=1048576,p)}function o(y){return t&&y.alternate===null&&(y.flags|=2),y}function l(y,p,m,_){return p===null||p.tag!==6?(p=ma(m,y.mode,_),p.return=y,p):(p=i(p,m),p.return=y,p)}function a(y,p,m,_){var k=m.type;return k===Nr?h(y,p,m.props.children,_,m.key):p!==null&&(p.elementType===k||typeof k=="object"&&k!==null&&k.$$typeof===mn&&mf(k)===p.type)?(_=i(p,m.props),_.ref=xi(y,p,m),_.return=y,_):(_=mo(m.type,m.key,m.props,null,y.mode,_),_.ref=xi(y,p,m),_.return=y,_)}function u(y,p,m,_){return p===null||p.tag!==4||p.stateNode.containerInfo!==m.containerInfo||p.stateNode.implementation!==m.implementation?(p=ga(m,y.mode,_),p.return=y,p):(p=i(p,m.children||[]),p.return=y,p)}function h(y,p,m,_,k){return p===null||p.tag!==7?(p=rr(m,y.mode,_,k),p.return=y,p):(p=i(p,m),p.return=y,p)}function f(y,p,m){if(typeof p=="string"&&p!==""||typeof p=="number")return p=ma(""+p,y.mode,m),p.return=y,p;if(typeof p=="object"&&p!==null){switch(p.$$typeof){case Fs:return m=mo(p.type,p.key,p.props,null,y.mode,m),m.ref=xi(y,null,p),m.return=y,m;case Tr:return p=ga(p,y.mode,m),p.return=y,p;case mn:var _=p._init;return f(y,_(p._payload),m)}if(Ii(p)||mi(p))return p=rr(p,y.mode,m,null),p.return=y,p;Ys(y,p)}return null}function d(y,p,m,_){var k=p!==null?p.key:null;if(typeof m=="string"&&m!==""||typeof m=="number")return k!==null?null:l(y,p,""+m,_);if(typeof m=="object"&&m!==null){switch(m.$$typeof){case Fs:return m.key===k?a(y,p,m,_):null;case Tr:return m.key===k?u(y,p,m,_):null;case mn:return k=m._init,d(y,p,k(m._payload),_)}if(Ii(m)||mi(m))return k!==null?null:h(y,p,m,_,null);Ys(y,m)}return null}function v(y,p,m,_,k){if(typeof _=="string"&&_!==""||typeof _=="number")return y=y.get(m)||null,l(p,y,""+_,k);if(typeof _=="object"&&_!==null){switch(_.$$typeof){case Fs:return y=y.get(_.key===null?m:_.key)||null,a(p,y,_,k);case Tr:return y=y.get(_.key===null?m:_.key)||null,u(p,y,_,k);case mn:var w=_._init;return v(y,p,m,w(_._payload),k)}if(Ii(_)||mi(_))return y=y.get(m)||null,h(p,y,_,k,null);Ys(p,_)}return null}function x(y,p,m,_){for(var k=null,w=null,C=p,N=p=0,O=null;C!==null&&N<m.length;N++){C.index>N?(O=C,C=null):O=C.sibling;var L=d(y,C,m[N],_);if(L===null){C===null&&(C=O);break}t&&C&&L.alternate===null&&e(y,C),p=s(L,p,N),w===null?k=L:w.sibling=L,w=L,C=O}if(N===m.length)return n(y,C),Ce&&Vn(y,N),k;if(C===null){for(;N<m.length;N++)C=f(y,m[N],_),C!==null&&(p=s(C,p,N),w===null?k=C:w.sibling=C,w=C);return Ce&&Vn(y,N),k}for(C=r(y,C);N<m.length;N++)O=v(C,y,N,m[N],_),O!==null&&(t&&O.alternate!==null&&C.delete(O.key===null?N:O.key),p=s(O,p,N),w===null?k=O:w.sibling=O,w=O);return t&&C.forEach(function(V){return e(y,V)}),Ce&&Vn(y,N),k}function g(y,p,m,_){var k=mi(m);if(typeof k!="function")throw Error(R(150));if(m=k.call(m),m==null)throw Error(R(151));for(var w=k=null,C=p,N=p=0,O=null,L=m.next();C!==null&&!L.done;N++,L=m.next()){C.index>N?(O=C,C=null):O=C.sibling;var V=d(y,C,L.value,_);if(V===null){C===null&&(C=O);break}t&&C&&V.alternate===null&&e(y,C),p=s(V,p,N),w===null?k=V:w.sibling=V,w=V,C=O}if(L.done)return n(y,C),Ce&&Vn(y,N),k;if(C===null){for(;!L.done;N++,L=m.next())L=f(y,L.value,_),L!==null&&(p=s(L,p,N),w===null?k=L:w.sibling=L,w=L);return Ce&&Vn(y,N),k}for(C=r(y,C);!L.done;N++,L=m.next())L=v(C,y,N,L.value,_),L!==null&&(t&&L.alternate!==null&&C.delete(L.key===null?N:L.key),p=s(L,p,N),w===null?k=L:w.sibling=L,w=L);return t&&C.forEach(function(J){return e(y,J)}),Ce&&Vn(y,N),k}function E(y,p,m,_){if(typeof m=="object"&&m!==null&&m.type===Nr&&m.key===null&&(m=m.props.children),typeof m=="object"&&m!==null){switch(m.$$typeof){case Fs:e:{for(var k=m.key,w=p;w!==null;){if(w.key===k){if(k=m.type,k===Nr){if(w.tag===7){n(y,w.sibling),p=i(w,m.props.children),p.return=y,y=p;break e}}else if(w.elementType===k||typeof k=="object"&&k!==null&&k.$$typeof===mn&&mf(k)===w.type){n(y,w.sibling),p=i(w,m.props),p.ref=xi(y,w,m),p.return=y,y=p;break e}n(y,w);break}else e(y,w);w=w.sibling}m.type===Nr?(p=rr(m.props.children,y.mode,_,m.key),p.return=y,y=p):(_=mo(m.type,m.key,m.props,null,y.mode,_),_.ref=xi(y,p,m),_.return=y,y=_)}return o(y);case Tr:e:{for(w=m.key;p!==null;){if(p.key===w)if(p.tag===4&&p.stateNode.containerInfo===m.containerInfo&&p.stateNode.implementation===m.implementation){n(y,p.sibling),p=i(p,m.children||[]),p.return=y,y=p;break e}else{n(y,p);break}else e(y,p);p=p.sibling}p=ga(m,y.mode,_),p.return=y,y=p}return o(y);case mn:return w=m._init,E(y,p,w(m._payload),_)}if(Ii(m))return x(y,p,m,_);if(mi(m))return g(y,p,m,_);Ys(y,m)}return typeof m=="string"&&m!==""||typeof m=="number"?(m=""+m,p!==null&&p.tag===6?(n(y,p.sibling),p=i(p,m),p.return=y,y=p):(n(y,p),p=ma(m,y.mode,_),p.return=y,y=p),o(y)):n(y,p)}return E}var Xr=om(!0),lm=om(!1),jo=$n(null),Ao=null,Or=null,vu=null;function _u(){vu=Or=Ao=null}function xu(t){var e=jo.current;we(jo),t._currentValue=e}function cc(t,e,n){for(;t!==null;){var r=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,r!==null&&(r.childLanes|=e)):r!==null&&(r.childLanes&e)!==e&&(r.childLanes|=e),t===n)break;t=t.return}}function Hr(t,e){Ao=t,vu=Or=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(ut=!0),t.firstContext=null)}function Nt(t){var e=t._currentValue;if(vu!==t)if(t={context:t,memoizedValue:e,next:null},Or===null){if(Ao===null)throw Error(R(308));Or=t,Ao.dependencies={lanes:0,firstContext:t}}else Or=Or.next=t;return e}var Zn=null;function Su(t){Zn===null?Zn=[t]:Zn.push(t)}function am(t,e,n,r){var i=e.interleaved;return i===null?(n.next=n,Su(e)):(n.next=i.next,i.next=n),e.interleaved=n,on(t,r)}function on(t,e){t.lanes|=e;var n=t.alternate;for(n!==null&&(n.lanes|=e),n=t,t=t.return;t!==null;)t.childLanes|=e,n=t.alternate,n!==null&&(n.childLanes|=e),n=t,t=t.return;return n.tag===3?n.stateNode:null}var gn=!1;function wu(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function cm(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function en(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function Tn(t,e,n){var r=t.updateQueue;if(r===null)return null;if(r=r.shared,le&2){var i=r.pending;return i===null?e.next=e:(e.next=i.next,i.next=e),r.pending=e,on(t,n)}return i=r.interleaved,i===null?(e.next=e,Su(r)):(e.next=i.next,i.next=e),r.interleaved=e,on(t,n)}function ao(t,e,n){if(e=e.updateQueue,e!==null&&(e=e.shared,(n&4194240)!==0)){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,lu(t,n)}}function gf(t,e){var n=t.updateQueue,r=t.alternate;if(r!==null&&(r=r.updateQueue,n===r)){var i=null,s=null;if(n=n.firstBaseUpdate,n!==null){do{var o={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};s===null?i=s=o:s=s.next=o,n=n.next}while(n!==null);s===null?i=s=e:s=s.next=e}else i=s=e;n={baseState:r.baseState,firstBaseUpdate:i,lastBaseUpdate:s,shared:r.shared,effects:r.effects},t.updateQueue=n;return}t=n.lastBaseUpdate,t===null?n.firstBaseUpdate=e:t.next=e,n.lastBaseUpdate=e}function Do(t,e,n,r){var i=t.updateQueue;gn=!1;var s=i.firstBaseUpdate,o=i.lastBaseUpdate,l=i.shared.pending;if(l!==null){i.shared.pending=null;var a=l,u=a.next;a.next=null,o===null?s=u:o.next=u,o=a;var h=t.alternate;h!==null&&(h=h.updateQueue,l=h.lastBaseUpdate,l!==o&&(l===null?h.firstBaseUpdate=u:l.next=u,h.lastBaseUpdate=a))}if(s!==null){var f=i.baseState;o=0,h=u=a=null,l=s;do{var d=l.lane,v=l.eventTime;if((r&d)===d){h!==null&&(h=h.next={eventTime:v,lane:0,tag:l.tag,payload:l.payload,callback:l.callback,next:null});e:{var x=t,g=l;switch(d=e,v=n,g.tag){case 1:if(x=g.payload,typeof x=="function"){f=x.call(v,f,d);break e}f=x;break e;case 3:x.flags=x.flags&-65537|128;case 0:if(x=g.payload,d=typeof x=="function"?x.call(v,f,d):x,d==null)break e;f=Pe({},f,d);break e;case 2:gn=!0}}l.callback!==null&&l.lane!==0&&(t.flags|=64,d=i.effects,d===null?i.effects=[l]:d.push(l))}else v={eventTime:v,lane:d,tag:l.tag,payload:l.payload,callback:l.callback,next:null},h===null?(u=h=v,a=f):h=h.next=v,o|=d;if(l=l.next,l===null){if(l=i.shared.pending,l===null)break;d=l,l=d.next,d.next=null,i.lastBaseUpdate=d,i.shared.pending=null}}while(!0);if(h===null&&(a=f),i.baseState=a,i.firstBaseUpdate=u,i.lastBaseUpdate=h,e=i.shared.interleaved,e!==null){i=e;do o|=i.lane,i=i.next;while(i!==e)}else s===null&&(i.shared.lanes=0);ar|=o,t.lanes=o,t.memoizedState=f}}function yf(t,e,n){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var r=t[e],i=r.callback;if(i!==null){if(r.callback=null,r=n,typeof i!="function")throw Error(R(191,i));i.call(r)}}}var Ts={},Qt=$n(Ts),rs=$n(Ts),is=$n(Ts);function Jn(t){if(t===Ts)throw Error(R(174));return t}function Cu(t,e){switch(_e(is,e),_e(rs,t),_e(Qt,Ts),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:Ua(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=Ua(e,t)}we(Qt),_e(Qt,e)}function Zr(){we(Qt),we(rs),we(is)}function um(t){Jn(is.current);var e=Jn(Qt.current),n=Ua(e,t.type);e!==n&&(_e(rs,t),_e(Qt,n))}function ku(t){rs.current===t&&(we(Qt),we(rs))}var Ne=$n(0);function Oo(t){for(var e=t;e!==null;){if(e.tag===13){var n=e.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var ca=[];function Eu(){for(var t=0;t<ca.length;t++)ca[t]._workInProgressVersionPrimary=null;ca.length=0}var co=un.ReactCurrentDispatcher,ua=un.ReactCurrentBatchConfig,lr=0,Ie=null,Fe=null,$e=null,Mo=!1,Mi=!1,ss=0,B_=0;function Ze(){throw Error(R(321))}function Tu(t,e){if(e===null)return!1;for(var n=0;n<e.length&&n<t.length;n++)if(!zt(t[n],e[n]))return!1;return!0}function Nu(t,e,n,r,i,s){if(lr=s,Ie=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,co.current=t===null||t.memoizedState===null?H_:V_,t=n(r,i),Mi){s=0;do{if(Mi=!1,ss=0,25<=s)throw Error(R(301));s+=1,$e=Fe=null,e.updateQueue=null,co.current=G_,t=n(r,i)}while(Mi)}if(co.current=Lo,e=Fe!==null&&Fe.next!==null,lr=0,$e=Fe=Ie=null,Mo=!1,e)throw Error(R(300));return t}function Iu(){var t=ss!==0;return ss=0,t}function Ht(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return $e===null?Ie.memoizedState=$e=t:$e=$e.next=t,$e}function It(){if(Fe===null){var t=Ie.alternate;t=t!==null?t.memoizedState:null}else t=Fe.next;var e=$e===null?Ie.memoizedState:$e.next;if(e!==null)$e=e,Fe=t;else{if(t===null)throw Error(R(310));Fe=t,t={memoizedState:Fe.memoizedState,baseState:Fe.baseState,baseQueue:Fe.baseQueue,queue:Fe.queue,next:null},$e===null?Ie.memoizedState=$e=t:$e=$e.next=t}return $e}function os(t,e){return typeof e=="function"?e(t):e}function da(t){var e=It(),n=e.queue;if(n===null)throw Error(R(311));n.lastRenderedReducer=t;var r=Fe,i=r.baseQueue,s=n.pending;if(s!==null){if(i!==null){var o=i.next;i.next=s.next,s.next=o}r.baseQueue=i=s,n.pending=null}if(i!==null){s=i.next,r=r.baseState;var l=o=null,a=null,u=s;do{var h=u.lane;if((lr&h)===h)a!==null&&(a=a.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),r=u.hasEagerState?u.eagerState:t(r,u.action);else{var f={lane:h,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};a===null?(l=a=f,o=r):a=a.next=f,Ie.lanes|=h,ar|=h}u=u.next}while(u!==null&&u!==s);a===null?o=r:a.next=l,zt(r,e.memoizedState)||(ut=!0),e.memoizedState=r,e.baseState=o,e.baseQueue=a,n.lastRenderedState=r}if(t=n.interleaved,t!==null){i=t;do s=i.lane,Ie.lanes|=s,ar|=s,i=i.next;while(i!==t)}else i===null&&(n.lanes=0);return[e.memoizedState,n.dispatch]}function fa(t){var e=It(),n=e.queue;if(n===null)throw Error(R(311));n.lastRenderedReducer=t;var r=n.dispatch,i=n.pending,s=e.memoizedState;if(i!==null){n.pending=null;var o=i=i.next;do s=t(s,o.action),o=o.next;while(o!==i);zt(s,e.memoizedState)||(ut=!0),e.memoizedState=s,e.baseQueue===null&&(e.baseState=s),n.lastRenderedState=s}return[s,r]}function dm(){}function fm(t,e){var n=Ie,r=It(),i=e(),s=!zt(r.memoizedState,i);if(s&&(r.memoizedState=i,ut=!0),r=r.queue,bu(mm.bind(null,n,r,t),[t]),r.getSnapshot!==e||s||$e!==null&&$e.memoizedState.tag&1){if(n.flags|=2048,ls(9,pm.bind(null,n,r,i,e),void 0,null),He===null)throw Error(R(349));lr&30||hm(n,e,i)}return i}function hm(t,e,n){t.flags|=16384,t={getSnapshot:e,value:n},e=Ie.updateQueue,e===null?(e={lastEffect:null,stores:null},Ie.updateQueue=e,e.stores=[t]):(n=e.stores,n===null?e.stores=[t]:n.push(t))}function pm(t,e,n,r){e.value=n,e.getSnapshot=r,gm(e)&&ym(t)}function mm(t,e,n){return n(function(){gm(e)&&ym(t)})}function gm(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!zt(t,n)}catch{return!0}}function ym(t){var e=on(t,1);e!==null&&Mt(e,t,1,-1)}function vf(t){var e=Ht();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:os,lastRenderedState:t},e.queue=t,t=t.dispatch=U_.bind(null,Ie,t),[e.memoizedState,t]}function ls(t,e,n,r){return t={tag:t,create:e,destroy:n,deps:r,next:null},e=Ie.updateQueue,e===null?(e={lastEffect:null,stores:null},Ie.updateQueue=e,e.lastEffect=t.next=t):(n=e.lastEffect,n===null?e.lastEffect=t.next=t:(r=n.next,n.next=t,t.next=r,e.lastEffect=t)),t}function vm(){return It().memoizedState}function uo(t,e,n,r){var i=Ht();Ie.flags|=t,i.memoizedState=ls(1|e,n,void 0,r===void 0?null:r)}function pl(t,e,n,r){var i=It();r=r===void 0?null:r;var s=void 0;if(Fe!==null){var o=Fe.memoizedState;if(s=o.destroy,r!==null&&Tu(r,o.deps)){i.memoizedState=ls(e,n,s,r);return}}Ie.flags|=t,i.memoizedState=ls(1|e,n,s,r)}function _f(t,e){return uo(8390656,8,t,e)}function bu(t,e){return pl(2048,8,t,e)}function _m(t,e){return pl(4,2,t,e)}function xm(t,e){return pl(4,4,t,e)}function Sm(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function wm(t,e,n){return n=n!=null?n.concat([t]):null,pl(4,4,Sm.bind(null,e,t),n)}function Pu(){}function Cm(t,e){var n=It();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&Tu(e,r[1])?r[0]:(n.memoizedState=[t,e],t)}function km(t,e){var n=It();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&Tu(e,r[1])?r[0]:(t=t(),n.memoizedState=[t,e],t)}function Em(t,e,n){return lr&21?(zt(n,e)||(n=Pp(),Ie.lanes|=n,ar|=n,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,ut=!0),t.memoizedState=n)}function W_(t,e){var n=fe;fe=n!==0&&4>n?n:4,t(!0);var r=ua.transition;ua.transition={};try{t(!1),e()}finally{fe=n,ua.transition=r}}function Tm(){return It().memoizedState}function $_(t,e,n){var r=In(t);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},Nm(t))Im(e,n);else if(n=am(t,e,n,r),n!==null){var i=st();Mt(n,t,r,i),bm(n,e,r)}}function U_(t,e,n){var r=In(t),i={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(Nm(t))Im(e,i);else{var s=t.alternate;if(t.lanes===0&&(s===null||s.lanes===0)&&(s=e.lastRenderedReducer,s!==null))try{var o=e.lastRenderedState,l=s(o,n);if(i.hasEagerState=!0,i.eagerState=l,zt(l,o)){var a=e.interleaved;a===null?(i.next=i,Su(e)):(i.next=a.next,a.next=i),e.interleaved=i;return}}catch{}finally{}n=am(t,e,i,r),n!==null&&(i=st(),Mt(n,t,r,i),bm(n,e,r))}}function Nm(t){var e=t.alternate;return t===Ie||e!==null&&e===Ie}function Im(t,e){Mi=Mo=!0;var n=t.pending;n===null?e.next=e:(e.next=n.next,n.next=e),t.pending=e}function bm(t,e,n){if(n&4194240){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,lu(t,n)}}var Lo={readContext:Nt,useCallback:Ze,useContext:Ze,useEffect:Ze,useImperativeHandle:Ze,useInsertionEffect:Ze,useLayoutEffect:Ze,useMemo:Ze,useReducer:Ze,useRef:Ze,useState:Ze,useDebugValue:Ze,useDeferredValue:Ze,useTransition:Ze,useMutableSource:Ze,useSyncExternalStore:Ze,useId:Ze,unstable_isNewReconciler:!1},H_={readContext:Nt,useCallback:function(t,e){return Ht().memoizedState=[t,e===void 0?null:e],t},useContext:Nt,useEffect:_f,useImperativeHandle:function(t,e,n){return n=n!=null?n.concat([t]):null,uo(4194308,4,Sm.bind(null,e,t),n)},useLayoutEffect:function(t,e){return uo(4194308,4,t,e)},useInsertionEffect:function(t,e){return uo(4,2,t,e)},useMemo:function(t,e){var n=Ht();return e=e===void 0?null:e,t=t(),n.memoizedState=[t,e],t},useReducer:function(t,e,n){var r=Ht();return e=n!==void 0?n(e):e,r.memoizedState=r.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},r.queue=t,t=t.dispatch=$_.bind(null,Ie,t),[r.memoizedState,t]},useRef:function(t){var e=Ht();return t={current:t},e.memoizedState=t},useState:vf,useDebugValue:Pu,useDeferredValue:function(t){return Ht().memoizedState=t},useTransition:function(){var t=vf(!1),e=t[0];return t=W_.bind(null,t[1]),Ht().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,n){var r=Ie,i=Ht();if(Ce){if(n===void 0)throw Error(R(407));n=n()}else{if(n=e(),He===null)throw Error(R(349));lr&30||hm(r,e,n)}i.memoizedState=n;var s={value:n,getSnapshot:e};return i.queue=s,_f(mm.bind(null,r,s,t),[t]),r.flags|=2048,ls(9,pm.bind(null,r,s,n,e),void 0,null),n},useId:function(){var t=Ht(),e=He.identifierPrefix;if(Ce){var n=Zt,r=Xt;n=(r&~(1<<32-Ot(r)-1)).toString(32)+n,e=":"+e+"R"+n,n=ss++,0<n&&(e+="H"+n.toString(32)),e+=":"}else n=B_++,e=":"+e+"r"+n.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},V_={readContext:Nt,useCallback:Cm,useContext:Nt,useEffect:bu,useImperativeHandle:wm,useInsertionEffect:_m,useLayoutEffect:xm,useMemo:km,useReducer:da,useRef:vm,useState:function(){return da(os)},useDebugValue:Pu,useDeferredValue:function(t){var e=It();return Em(e,Fe.memoizedState,t)},useTransition:function(){var t=da(os)[0],e=It().memoizedState;return[t,e]},useMutableSource:dm,useSyncExternalStore:fm,useId:Tm,unstable_isNewReconciler:!1},G_={readContext:Nt,useCallback:Cm,useContext:Nt,useEffect:bu,useImperativeHandle:wm,useInsertionEffect:_m,useLayoutEffect:xm,useMemo:km,useReducer:fa,useRef:vm,useState:function(){return fa(os)},useDebugValue:Pu,useDeferredValue:function(t){var e=It();return Fe===null?e.memoizedState=t:Em(e,Fe.memoizedState,t)},useTransition:function(){var t=fa(os)[0],e=It().memoizedState;return[t,e]},useMutableSource:dm,useSyncExternalStore:fm,useId:Tm,unstable_isNewReconciler:!1};function Pt(t,e){if(t&&t.defaultProps){e=Pe({},e),t=t.defaultProps;for(var n in t)e[n]===void 0&&(e[n]=t[n]);return e}return e}function uc(t,e,n,r){e=t.memoizedState,n=n(r,e),n=n==null?e:Pe({},e,n),t.memoizedState=n,t.lanes===0&&(t.updateQueue.baseState=n)}var ml={isMounted:function(t){return(t=t._reactInternals)?gr(t)===t:!1},enqueueSetState:function(t,e,n){t=t._reactInternals;var r=st(),i=In(t),s=en(r,i);s.payload=e,n!=null&&(s.callback=n),e=Tn(t,s,i),e!==null&&(Mt(e,t,i,r),ao(e,t,i))},enqueueReplaceState:function(t,e,n){t=t._reactInternals;var r=st(),i=In(t),s=en(r,i);s.tag=1,s.payload=e,n!=null&&(s.callback=n),e=Tn(t,s,i),e!==null&&(Mt(e,t,i,r),ao(e,t,i))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var n=st(),r=In(t),i=en(n,r);i.tag=2,e!=null&&(i.callback=e),e=Tn(t,i,r),e!==null&&(Mt(e,t,r,n),ao(e,t,r))}};function xf(t,e,n,r,i,s,o){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(r,s,o):e.prototype&&e.prototype.isPureReactComponent?!Ji(n,r)||!Ji(i,s):!0}function Pm(t,e,n){var r=!1,i=Mn,s=e.contextType;return typeof s=="object"&&s!==null?s=Nt(s):(i=ht(e)?sr:tt.current,r=e.contextTypes,s=(r=r!=null)?Yr(t,i):Mn),e=new e(n,s),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=ml,t.stateNode=e,e._reactInternals=t,r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=i,t.__reactInternalMemoizedMaskedChildContext=s),e}function Sf(t,e,n,r){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(n,r),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(n,r),e.state!==t&&ml.enqueueReplaceState(e,e.state,null)}function dc(t,e,n,r){var i=t.stateNode;i.props=n,i.state=t.memoizedState,i.refs={},wu(t);var s=e.contextType;typeof s=="object"&&s!==null?i.context=Nt(s):(s=ht(e)?sr:tt.current,i.context=Yr(t,s)),i.state=t.memoizedState,s=e.getDerivedStateFromProps,typeof s=="function"&&(uc(t,e,s,n),i.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof i.getSnapshotBeforeUpdate=="function"||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(e=i.state,typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount(),e!==i.state&&ml.enqueueReplaceState(i,i.state,null),Do(t,n,i,r),i.state=t.memoizedState),typeof i.componentDidMount=="function"&&(t.flags|=4194308)}function Jr(t,e){try{var n="",r=e;do n+=xv(r),r=r.return;while(r);var i=n}catch(s){i=`
Error generating stack: `+s.message+`
`+s.stack}return{value:t,source:e,stack:i,digest:null}}function ha(t,e,n){return{value:t,source:null,stack:n??null,digest:e??null}}function fc(t,e){try{console.error(e.value)}catch(n){setTimeout(function(){throw n})}}var Q_=typeof WeakMap=="function"?WeakMap:Map;function Rm(t,e,n){n=en(-1,n),n.tag=3,n.payload={element:null};var r=e.value;return n.callback=function(){zo||(zo=!0,wc=r),fc(t,e)},n}function jm(t,e,n){n=en(-1,n),n.tag=3;var r=t.type.getDerivedStateFromError;if(typeof r=="function"){var i=e.value;n.payload=function(){return r(i)},n.callback=function(){fc(t,e)}}var s=t.stateNode;return s!==null&&typeof s.componentDidCatch=="function"&&(n.callback=function(){fc(t,e),typeof r!="function"&&(Nn===null?Nn=new Set([this]):Nn.add(this));var o=e.stack;this.componentDidCatch(e.value,{componentStack:o!==null?o:""})}),n}function wf(t,e,n){var r=t.pingCache;if(r===null){r=t.pingCache=new Q_;var i=new Set;r.set(e,i)}else i=r.get(e),i===void 0&&(i=new Set,r.set(e,i));i.has(n)||(i.add(n),t=l0.bind(null,t,e,n),e.then(t,t))}function Cf(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function kf(t,e,n,r,i){return t.mode&1?(t.flags|=65536,t.lanes=i,t):(t===e?t.flags|=65536:(t.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(e=en(-1,1),e.tag=2,Tn(n,e,1))),n.lanes|=1),t)}var K_=un.ReactCurrentOwner,ut=!1;function rt(t,e,n,r){e.child=t===null?lm(e,null,n,r):Xr(e,t.child,n,r)}function Ef(t,e,n,r,i){n=n.render;var s=e.ref;return Hr(e,i),r=Nu(t,e,n,r,s,i),n=Iu(),t!==null&&!ut?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~i,ln(t,e,i)):(Ce&&n&&mu(e),e.flags|=1,rt(t,e,r,i),e.child)}function Tf(t,e,n,r,i){if(t===null){var s=n.type;return typeof s=="function"&&!Fu(s)&&s.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(e.tag=15,e.type=s,Am(t,e,s,r,i)):(t=mo(n.type,null,r,e,e.mode,i),t.ref=e.ref,t.return=e,e.child=t)}if(s=t.child,!(t.lanes&i)){var o=s.memoizedProps;if(n=n.compare,n=n!==null?n:Ji,n(o,r)&&t.ref===e.ref)return ln(t,e,i)}return e.flags|=1,t=bn(s,r),t.ref=e.ref,t.return=e,e.child=t}function Am(t,e,n,r,i){if(t!==null){var s=t.memoizedProps;if(Ji(s,r)&&t.ref===e.ref)if(ut=!1,e.pendingProps=r=s,(t.lanes&i)!==0)t.flags&131072&&(ut=!0);else return e.lanes=t.lanes,ln(t,e,i)}return hc(t,e,n,r,i)}function Dm(t,e,n){var r=e.pendingProps,i=r.children,s=t!==null?t.memoizedState:null;if(r.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},_e(Lr,mt),mt|=n;else{if(!(n&1073741824))return t=s!==null?s.baseLanes|n:n,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,_e(Lr,mt),mt|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=s!==null?s.baseLanes:n,_e(Lr,mt),mt|=r}else s!==null?(r=s.baseLanes|n,e.memoizedState=null):r=n,_e(Lr,mt),mt|=r;return rt(t,e,i,n),e.child}function Om(t,e){var n=e.ref;(t===null&&n!==null||t!==null&&t.ref!==n)&&(e.flags|=512,e.flags|=2097152)}function hc(t,e,n,r,i){var s=ht(n)?sr:tt.current;return s=Yr(e,s),Hr(e,i),n=Nu(t,e,n,r,s,i),r=Iu(),t!==null&&!ut?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~i,ln(t,e,i)):(Ce&&r&&mu(e),e.flags|=1,rt(t,e,n,i),e.child)}function Nf(t,e,n,r,i){if(ht(n)){var s=!0;bo(e)}else s=!1;if(Hr(e,i),e.stateNode===null)fo(t,e),Pm(e,n,r),dc(e,n,r,i),r=!0;else if(t===null){var o=e.stateNode,l=e.memoizedProps;o.props=l;var a=o.context,u=n.contextType;typeof u=="object"&&u!==null?u=Nt(u):(u=ht(n)?sr:tt.current,u=Yr(e,u));var h=n.getDerivedStateFromProps,f=typeof h=="function"||typeof o.getSnapshotBeforeUpdate=="function";f||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(l!==r||a!==u)&&Sf(e,o,r,u),gn=!1;var d=e.memoizedState;o.state=d,Do(e,r,o,i),a=e.memoizedState,l!==r||d!==a||ft.current||gn?(typeof h=="function"&&(uc(e,n,h,r),a=e.memoizedState),(l=gn||xf(e,n,l,r,d,a,u))?(f||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(e.flags|=4194308)):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=r,e.memoizedState=a),o.props=r,o.state=a,o.context=u,r=l):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),r=!1)}else{o=e.stateNode,cm(t,e),l=e.memoizedProps,u=e.type===e.elementType?l:Pt(e.type,l),o.props=u,f=e.pendingProps,d=o.context,a=n.contextType,typeof a=="object"&&a!==null?a=Nt(a):(a=ht(n)?sr:tt.current,a=Yr(e,a));var v=n.getDerivedStateFromProps;(h=typeof v=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(l!==f||d!==a)&&Sf(e,o,r,a),gn=!1,d=e.memoizedState,o.state=d,Do(e,r,o,i);var x=e.memoizedState;l!==f||d!==x||ft.current||gn?(typeof v=="function"&&(uc(e,n,v,r),x=e.memoizedState),(u=gn||xf(e,n,u,r,d,x,a)||!1)?(h||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(r,x,a),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(r,x,a)),typeof o.componentDidUpdate=="function"&&(e.flags|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof o.componentDidUpdate!="function"||l===t.memoizedProps&&d===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||l===t.memoizedProps&&d===t.memoizedState||(e.flags|=1024),e.memoizedProps=r,e.memoizedState=x),o.props=r,o.state=x,o.context=a,r=u):(typeof o.componentDidUpdate!="function"||l===t.memoizedProps&&d===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||l===t.memoizedProps&&d===t.memoizedState||(e.flags|=1024),r=!1)}return pc(t,e,n,r,s,i)}function pc(t,e,n,r,i,s){Om(t,e);var o=(e.flags&128)!==0;if(!r&&!o)return i&&ff(e,n,!1),ln(t,e,s);r=e.stateNode,K_.current=e;var l=o&&typeof n.getDerivedStateFromError!="function"?null:r.render();return e.flags|=1,t!==null&&o?(e.child=Xr(e,t.child,null,s),e.child=Xr(e,null,l,s)):rt(t,e,l,s),e.memoizedState=r.state,i&&ff(e,n,!0),e.child}function Mm(t){var e=t.stateNode;e.pendingContext?df(t,e.pendingContext,e.pendingContext!==e.context):e.context&&df(t,e.context,!1),Cu(t,e.containerInfo)}function If(t,e,n,r,i){return qr(),yu(i),e.flags|=256,rt(t,e,n,r),e.child}var mc={dehydrated:null,treeContext:null,retryLane:0};function gc(t){return{baseLanes:t,cachePool:null,transitions:null}}function Lm(t,e,n){var r=e.pendingProps,i=Ne.current,s=!1,o=(e.flags&128)!==0,l;if((l=o)||(l=t!==null&&t.memoizedState===null?!1:(i&2)!==0),l?(s=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(i|=1),_e(Ne,i&1),t===null)return ac(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(o=r.children,t=r.fallback,s?(r=e.mode,s=e.child,o={mode:"hidden",children:o},!(r&1)&&s!==null?(s.childLanes=0,s.pendingProps=o):s=vl(o,r,0,null),t=rr(t,r,n,null),s.return=e,t.return=e,s.sibling=t,e.child=s,e.child.memoizedState=gc(n),e.memoizedState=mc,t):Ru(e,o));if(i=t.memoizedState,i!==null&&(l=i.dehydrated,l!==null))return Y_(t,e,o,r,l,i,n);if(s){s=r.fallback,o=e.mode,i=t.child,l=i.sibling;var a={mode:"hidden",children:r.children};return!(o&1)&&e.child!==i?(r=e.child,r.childLanes=0,r.pendingProps=a,e.deletions=null):(r=bn(i,a),r.subtreeFlags=i.subtreeFlags&14680064),l!==null?s=bn(l,s):(s=rr(s,o,n,null),s.flags|=2),s.return=e,r.return=e,r.sibling=s,e.child=r,r=s,s=e.child,o=t.child.memoizedState,o=o===null?gc(n):{baseLanes:o.baseLanes|n,cachePool:null,transitions:o.transitions},s.memoizedState=o,s.childLanes=t.childLanes&~n,e.memoizedState=mc,r}return s=t.child,t=s.sibling,r=bn(s,{mode:"visible",children:r.children}),!(e.mode&1)&&(r.lanes=n),r.return=e,r.sibling=null,t!==null&&(n=e.deletions,n===null?(e.deletions=[t],e.flags|=16):n.push(t)),e.child=r,e.memoizedState=null,r}function Ru(t,e){return e=vl({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function qs(t,e,n,r){return r!==null&&yu(r),Xr(e,t.child,null,n),t=Ru(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function Y_(t,e,n,r,i,s,o){if(n)return e.flags&256?(e.flags&=-257,r=ha(Error(R(422))),qs(t,e,o,r)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(s=r.fallback,i=e.mode,r=vl({mode:"visible",children:r.children},i,0,null),s=rr(s,i,o,null),s.flags|=2,r.return=e,s.return=e,r.sibling=s,e.child=r,e.mode&1&&Xr(e,t.child,null,o),e.child.memoizedState=gc(o),e.memoizedState=mc,s);if(!(e.mode&1))return qs(t,e,o,null);if(i.data==="$!"){if(r=i.nextSibling&&i.nextSibling.dataset,r)var l=r.dgst;return r=l,s=Error(R(419)),r=ha(s,r,void 0),qs(t,e,o,r)}if(l=(o&t.childLanes)!==0,ut||l){if(r=He,r!==null){switch(o&-o){case 4:i=2;break;case 16:i=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:i=32;break;case 536870912:i=268435456;break;default:i=0}i=i&(r.suspendedLanes|o)?0:i,i!==0&&i!==s.retryLane&&(s.retryLane=i,on(t,i),Mt(r,t,i,-1))}return Lu(),r=ha(Error(R(421))),qs(t,e,o,r)}return i.data==="$?"?(e.flags|=128,e.child=t.child,e=a0.bind(null,t),i._reactRetry=e,null):(t=s.treeContext,gt=En(i.nextSibling),yt=e,Ce=!0,jt=null,t!==null&&(wt[Ct++]=Xt,wt[Ct++]=Zt,wt[Ct++]=or,Xt=t.id,Zt=t.overflow,or=e),e=Ru(e,r.children),e.flags|=4096,e)}function bf(t,e,n){t.lanes|=e;var r=t.alternate;r!==null&&(r.lanes|=e),cc(t.return,e,n)}function pa(t,e,n,r,i){var s=t.memoizedState;s===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:i}:(s.isBackwards=e,s.rendering=null,s.renderingStartTime=0,s.last=r,s.tail=n,s.tailMode=i)}function Fm(t,e,n){var r=e.pendingProps,i=r.revealOrder,s=r.tail;if(rt(t,e,r.children,n),r=Ne.current,r&2)r=r&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&bf(t,n,e);else if(t.tag===19)bf(t,n,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}r&=1}if(_e(Ne,r),!(e.mode&1))e.memoizedState=null;else switch(i){case"forwards":for(n=e.child,i=null;n!==null;)t=n.alternate,t!==null&&Oo(t)===null&&(i=n),n=n.sibling;n=i,n===null?(i=e.child,e.child=null):(i=n.sibling,n.sibling=null),pa(e,!1,i,n,s);break;case"backwards":for(n=null,i=e.child,e.child=null;i!==null;){if(t=i.alternate,t!==null&&Oo(t)===null){e.child=i;break}t=i.sibling,i.sibling=n,n=i,i=t}pa(e,!0,n,null,s);break;case"together":pa(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function fo(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function ln(t,e,n){if(t!==null&&(e.dependencies=t.dependencies),ar|=e.lanes,!(n&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(R(153));if(e.child!==null){for(t=e.child,n=bn(t,t.pendingProps),e.child=n,n.return=e;t.sibling!==null;)t=t.sibling,n=n.sibling=bn(t,t.pendingProps),n.return=e;n.sibling=null}return e.child}function q_(t,e,n){switch(e.tag){case 3:Mm(e),qr();break;case 5:um(e);break;case 1:ht(e.type)&&bo(e);break;case 4:Cu(e,e.stateNode.containerInfo);break;case 10:var r=e.type._context,i=e.memoizedProps.value;_e(jo,r._currentValue),r._currentValue=i;break;case 13:if(r=e.memoizedState,r!==null)return r.dehydrated!==null?(_e(Ne,Ne.current&1),e.flags|=128,null):n&e.child.childLanes?Lm(t,e,n):(_e(Ne,Ne.current&1),t=ln(t,e,n),t!==null?t.sibling:null);_e(Ne,Ne.current&1);break;case 19:if(r=(n&e.childLanes)!==0,t.flags&128){if(r)return Fm(t,e,n);e.flags|=128}if(i=e.memoizedState,i!==null&&(i.rendering=null,i.tail=null,i.lastEffect=null),_e(Ne,Ne.current),r)break;return null;case 22:case 23:return e.lanes=0,Dm(t,e,n)}return ln(t,e,n)}var zm,yc,Bm,Wm;zm=function(t,e){for(var n=e.child;n!==null;){if(n.tag===5||n.tag===6)t.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};yc=function(){};Bm=function(t,e,n,r){var i=t.memoizedProps;if(i!==r){t=e.stateNode,Jn(Qt.current);var s=null;switch(n){case"input":i=za(t,i),r=za(t,r),s=[];break;case"select":i=Pe({},i,{value:void 0}),r=Pe({},r,{value:void 0}),s=[];break;case"textarea":i=$a(t,i),r=$a(t,r),s=[];break;default:typeof i.onClick!="function"&&typeof r.onClick=="function"&&(t.onclick=No)}Ha(n,r);var o;n=null;for(u in i)if(!r.hasOwnProperty(u)&&i.hasOwnProperty(u)&&i[u]!=null)if(u==="style"){var l=i[u];for(o in l)l.hasOwnProperty(o)&&(n||(n={}),n[o]="")}else u!=="dangerouslySetInnerHTML"&&u!=="children"&&u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&u!=="autoFocus"&&(Gi.hasOwnProperty(u)?s||(s=[]):(s=s||[]).push(u,null));for(u in r){var a=r[u];if(l=i!=null?i[u]:void 0,r.hasOwnProperty(u)&&a!==l&&(a!=null||l!=null))if(u==="style")if(l){for(o in l)!l.hasOwnProperty(o)||a&&a.hasOwnProperty(o)||(n||(n={}),n[o]="");for(o in a)a.hasOwnProperty(o)&&l[o]!==a[o]&&(n||(n={}),n[o]=a[o])}else n||(s||(s=[]),s.push(u,n)),n=a;else u==="dangerouslySetInnerHTML"?(a=a?a.__html:void 0,l=l?l.__html:void 0,a!=null&&l!==a&&(s=s||[]).push(u,a)):u==="children"?typeof a!="string"&&typeof a!="number"||(s=s||[]).push(u,""+a):u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&(Gi.hasOwnProperty(u)?(a!=null&&u==="onScroll"&&Se("scroll",t),s||l===a||(s=[])):(s=s||[]).push(u,a))}n&&(s=s||[]).push("style",n);var u=s;(e.updateQueue=u)&&(e.flags|=4)}};Wm=function(t,e,n,r){n!==r&&(e.flags|=4)};function Si(t,e){if(!Ce)switch(t.tailMode){case"hidden":e=t.tail;for(var n=null;e!==null;)e.alternate!==null&&(n=e),e=e.sibling;n===null?t.tail=null:n.sibling=null;break;case"collapsed":n=t.tail;for(var r=null;n!==null;)n.alternate!==null&&(r=n),n=n.sibling;r===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:r.sibling=null}}function Je(t){var e=t.alternate!==null&&t.alternate.child===t.child,n=0,r=0;if(e)for(var i=t.child;i!==null;)n|=i.lanes|i.childLanes,r|=i.subtreeFlags&14680064,r|=i.flags&14680064,i.return=t,i=i.sibling;else for(i=t.child;i!==null;)n|=i.lanes|i.childLanes,r|=i.subtreeFlags,r|=i.flags,i.return=t,i=i.sibling;return t.subtreeFlags|=r,t.childLanes=n,e}function X_(t,e,n){var r=e.pendingProps;switch(gu(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Je(e),null;case 1:return ht(e.type)&&Io(),Je(e),null;case 3:return r=e.stateNode,Zr(),we(ft),we(tt),Eu(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(t===null||t.child===null)&&(Ks(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,jt!==null&&(Ec(jt),jt=null))),yc(t,e),Je(e),null;case 5:ku(e);var i=Jn(is.current);if(n=e.type,t!==null&&e.stateNode!=null)Bm(t,e,n,r,i),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!r){if(e.stateNode===null)throw Error(R(166));return Je(e),null}if(t=Jn(Qt.current),Ks(e)){r=e.stateNode,n=e.type;var s=e.memoizedProps;switch(r[Vt]=e,r[ns]=s,t=(e.mode&1)!==0,n){case"dialog":Se("cancel",r),Se("close",r);break;case"iframe":case"object":case"embed":Se("load",r);break;case"video":case"audio":for(i=0;i<Pi.length;i++)Se(Pi[i],r);break;case"source":Se("error",r);break;case"img":case"image":case"link":Se("error",r),Se("load",r);break;case"details":Se("toggle",r);break;case"input":Ld(r,s),Se("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!s.multiple},Se("invalid",r);break;case"textarea":zd(r,s),Se("invalid",r)}Ha(n,s),i=null;for(var o in s)if(s.hasOwnProperty(o)){var l=s[o];o==="children"?typeof l=="string"?r.textContent!==l&&(s.suppressHydrationWarning!==!0&&Qs(r.textContent,l,t),i=["children",l]):typeof l=="number"&&r.textContent!==""+l&&(s.suppressHydrationWarning!==!0&&Qs(r.textContent,l,t),i=["children",""+l]):Gi.hasOwnProperty(o)&&l!=null&&o==="onScroll"&&Se("scroll",r)}switch(n){case"input":zs(r),Fd(r,s,!0);break;case"textarea":zs(r),Bd(r);break;case"select":case"option":break;default:typeof s.onClick=="function"&&(r.onclick=No)}r=i,e.updateQueue=r,r!==null&&(e.flags|=4)}else{o=i.nodeType===9?i:i.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=mp(n)),t==="http://www.w3.org/1999/xhtml"?n==="script"?(t=o.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof r.is=="string"?t=o.createElement(n,{is:r.is}):(t=o.createElement(n),n==="select"&&(o=t,r.multiple?o.multiple=!0:r.size&&(o.size=r.size))):t=o.createElementNS(t,n),t[Vt]=e,t[ns]=r,zm(t,e,!1,!1),e.stateNode=t;e:{switch(o=Va(n,r),n){case"dialog":Se("cancel",t),Se("close",t),i=r;break;case"iframe":case"object":case"embed":Se("load",t),i=r;break;case"video":case"audio":for(i=0;i<Pi.length;i++)Se(Pi[i],t);i=r;break;case"source":Se("error",t),i=r;break;case"img":case"image":case"link":Se("error",t),Se("load",t),i=r;break;case"details":Se("toggle",t),i=r;break;case"input":Ld(t,r),i=za(t,r),Se("invalid",t);break;case"option":i=r;break;case"select":t._wrapperState={wasMultiple:!!r.multiple},i=Pe({},r,{value:void 0}),Se("invalid",t);break;case"textarea":zd(t,r),i=$a(t,r),Se("invalid",t);break;default:i=r}Ha(n,i),l=i;for(s in l)if(l.hasOwnProperty(s)){var a=l[s];s==="style"?vp(t,a):s==="dangerouslySetInnerHTML"?(a=a?a.__html:void 0,a!=null&&gp(t,a)):s==="children"?typeof a=="string"?(n!=="textarea"||a!=="")&&Qi(t,a):typeof a=="number"&&Qi(t,""+a):s!=="suppressContentEditableWarning"&&s!=="suppressHydrationWarning"&&s!=="autoFocus"&&(Gi.hasOwnProperty(s)?a!=null&&s==="onScroll"&&Se("scroll",t):a!=null&&tu(t,s,a,o))}switch(n){case"input":zs(t),Fd(t,r,!1);break;case"textarea":zs(t),Bd(t);break;case"option":r.value!=null&&t.setAttribute("value",""+On(r.value));break;case"select":t.multiple=!!r.multiple,s=r.value,s!=null?Br(t,!!r.multiple,s,!1):r.defaultValue!=null&&Br(t,!!r.multiple,r.defaultValue,!0);break;default:typeof i.onClick=="function"&&(t.onclick=No)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return Je(e),null;case 6:if(t&&e.stateNode!=null)Wm(t,e,t.memoizedProps,r);else{if(typeof r!="string"&&e.stateNode===null)throw Error(R(166));if(n=Jn(is.current),Jn(Qt.current),Ks(e)){if(r=e.stateNode,n=e.memoizedProps,r[Vt]=e,(s=r.nodeValue!==n)&&(t=yt,t!==null))switch(t.tag){case 3:Qs(r.nodeValue,n,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&Qs(r.nodeValue,n,(t.mode&1)!==0)}s&&(e.flags|=4)}else r=(n.nodeType===9?n:n.ownerDocument).createTextNode(r),r[Vt]=e,e.stateNode=r}return Je(e),null;case 13:if(we(Ne),r=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(Ce&&gt!==null&&e.mode&1&&!(e.flags&128))sm(),qr(),e.flags|=98560,s=!1;else if(s=Ks(e),r!==null&&r.dehydrated!==null){if(t===null){if(!s)throw Error(R(318));if(s=e.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(R(317));s[Vt]=e}else qr(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;Je(e),s=!1}else jt!==null&&(Ec(jt),jt=null),s=!0;if(!s)return e.flags&65536?e:null}return e.flags&128?(e.lanes=n,e):(r=r!==null,r!==(t!==null&&t.memoizedState!==null)&&r&&(e.child.flags|=8192,e.mode&1&&(t===null||Ne.current&1?Be===0&&(Be=3):Lu())),e.updateQueue!==null&&(e.flags|=4),Je(e),null);case 4:return Zr(),yc(t,e),t===null&&es(e.stateNode.containerInfo),Je(e),null;case 10:return xu(e.type._context),Je(e),null;case 17:return ht(e.type)&&Io(),Je(e),null;case 19:if(we(Ne),s=e.memoizedState,s===null)return Je(e),null;if(r=(e.flags&128)!==0,o=s.rendering,o===null)if(r)Si(s,!1);else{if(Be!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(o=Oo(t),o!==null){for(e.flags|=128,Si(s,!1),r=o.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),e.subtreeFlags=0,r=n,n=e.child;n!==null;)s=n,t=r,s.flags&=14680066,o=s.alternate,o===null?(s.childLanes=0,s.lanes=t,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=o.childLanes,s.lanes=o.lanes,s.child=o.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=o.memoizedProps,s.memoizedState=o.memoizedState,s.updateQueue=o.updateQueue,s.type=o.type,t=o.dependencies,s.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),n=n.sibling;return _e(Ne,Ne.current&1|2),e.child}t=t.sibling}s.tail!==null&&Oe()>ei&&(e.flags|=128,r=!0,Si(s,!1),e.lanes=4194304)}else{if(!r)if(t=Oo(o),t!==null){if(e.flags|=128,r=!0,n=t.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),Si(s,!0),s.tail===null&&s.tailMode==="hidden"&&!o.alternate&&!Ce)return Je(e),null}else 2*Oe()-s.renderingStartTime>ei&&n!==1073741824&&(e.flags|=128,r=!0,Si(s,!1),e.lanes=4194304);s.isBackwards?(o.sibling=e.child,e.child=o):(n=s.last,n!==null?n.sibling=o:e.child=o,s.last=o)}return s.tail!==null?(e=s.tail,s.rendering=e,s.tail=e.sibling,s.renderingStartTime=Oe(),e.sibling=null,n=Ne.current,_e(Ne,r?n&1|2:n&1),e):(Je(e),null);case 22:case 23:return Mu(),r=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==r&&(e.flags|=8192),r&&e.mode&1?mt&1073741824&&(Je(e),e.subtreeFlags&6&&(e.flags|=8192)):Je(e),null;case 24:return null;case 25:return null}throw Error(R(156,e.tag))}function Z_(t,e){switch(gu(e),e.tag){case 1:return ht(e.type)&&Io(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return Zr(),we(ft),we(tt),Eu(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return ku(e),null;case 13:if(we(Ne),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(R(340));qr()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return we(Ne),null;case 4:return Zr(),null;case 10:return xu(e.type._context),null;case 22:case 23:return Mu(),null;case 24:return null;default:return null}}var Xs=!1,et=!1,J_=typeof WeakSet=="function"?WeakSet:Set,H=null;function Mr(t,e){var n=t.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(r){Re(t,e,r)}else n.current=null}function vc(t,e,n){try{n()}catch(r){Re(t,e,r)}}var Pf=!1;function e0(t,e){if(tc=ko,t=Gp(),pu(t)){if("selectionStart"in t)var n={start:t.selectionStart,end:t.selectionEnd};else e:{n=(n=t.ownerDocument)&&n.defaultView||window;var r=n.getSelection&&n.getSelection();if(r&&r.rangeCount!==0){n=r.anchorNode;var i=r.anchorOffset,s=r.focusNode;r=r.focusOffset;try{n.nodeType,s.nodeType}catch{n=null;break e}var o=0,l=-1,a=-1,u=0,h=0,f=t,d=null;t:for(;;){for(var v;f!==n||i!==0&&f.nodeType!==3||(l=o+i),f!==s||r!==0&&f.nodeType!==3||(a=o+r),f.nodeType===3&&(o+=f.nodeValue.length),(v=f.firstChild)!==null;)d=f,f=v;for(;;){if(f===t)break t;if(d===n&&++u===i&&(l=o),d===s&&++h===r&&(a=o),(v=f.nextSibling)!==null)break;f=d,d=f.parentNode}f=v}n=l===-1||a===-1?null:{start:l,end:a}}else n=null}n=n||{start:0,end:0}}else n=null;for(nc={focusedElem:t,selectionRange:n},ko=!1,H=e;H!==null;)if(e=H,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,H=t;else for(;H!==null;){e=H;try{var x=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(x!==null){var g=x.memoizedProps,E=x.memoizedState,y=e.stateNode,p=y.getSnapshotBeforeUpdate(e.elementType===e.type?g:Pt(e.type,g),E);y.__reactInternalSnapshotBeforeUpdate=p}break;case 3:var m=e.stateNode.containerInfo;m.nodeType===1?m.textContent="":m.nodeType===9&&m.documentElement&&m.removeChild(m.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(R(163))}}catch(_){Re(e,e.return,_)}if(t=e.sibling,t!==null){t.return=e.return,H=t;break}H=e.return}return x=Pf,Pf=!1,x}function Li(t,e,n){var r=e.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var i=r=r.next;do{if((i.tag&t)===t){var s=i.destroy;i.destroy=void 0,s!==void 0&&vc(e,n,s)}i=i.next}while(i!==r)}}function gl(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var n=e=e.next;do{if((n.tag&t)===t){var r=n.create;n.destroy=r()}n=n.next}while(n!==e)}}function _c(t){var e=t.ref;if(e!==null){var n=t.stateNode;switch(t.tag){case 5:t=n;break;default:t=n}typeof e=="function"?e(t):e.current=t}}function $m(t){var e=t.alternate;e!==null&&(t.alternate=null,$m(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[Vt],delete e[ns],delete e[sc],delete e[M_],delete e[L_])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function Um(t){return t.tag===5||t.tag===3||t.tag===4}function Rf(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||Um(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function xc(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.nodeType===8?n.parentNode.insertBefore(t,e):n.insertBefore(t,e):(n.nodeType===8?(e=n.parentNode,e.insertBefore(t,n)):(e=n,e.appendChild(t)),n=n._reactRootContainer,n!=null||e.onclick!==null||(e.onclick=No));else if(r!==4&&(t=t.child,t!==null))for(xc(t,e,n),t=t.sibling;t!==null;)xc(t,e,n),t=t.sibling}function Sc(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.insertBefore(t,e):n.appendChild(t);else if(r!==4&&(t=t.child,t!==null))for(Sc(t,e,n),t=t.sibling;t!==null;)Sc(t,e,n),t=t.sibling}var Ge=null,Rt=!1;function pn(t,e,n){for(n=n.child;n!==null;)Hm(t,e,n),n=n.sibling}function Hm(t,e,n){if(Gt&&typeof Gt.onCommitFiberUnmount=="function")try{Gt.onCommitFiberUnmount(al,n)}catch{}switch(n.tag){case 5:et||Mr(n,e);case 6:var r=Ge,i=Rt;Ge=null,pn(t,e,n),Ge=r,Rt=i,Ge!==null&&(Rt?(t=Ge,n=n.stateNode,t.nodeType===8?t.parentNode.removeChild(n):t.removeChild(n)):Ge.removeChild(n.stateNode));break;case 18:Ge!==null&&(Rt?(t=Ge,n=n.stateNode,t.nodeType===8?la(t.parentNode,n):t.nodeType===1&&la(t,n),Xi(t)):la(Ge,n.stateNode));break;case 4:r=Ge,i=Rt,Ge=n.stateNode.containerInfo,Rt=!0,pn(t,e,n),Ge=r,Rt=i;break;case 0:case 11:case 14:case 15:if(!et&&(r=n.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){i=r=r.next;do{var s=i,o=s.destroy;s=s.tag,o!==void 0&&(s&2||s&4)&&vc(n,e,o),i=i.next}while(i!==r)}pn(t,e,n);break;case 1:if(!et&&(Mr(n,e),r=n.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(l){Re(n,e,l)}pn(t,e,n);break;case 21:pn(t,e,n);break;case 22:n.mode&1?(et=(r=et)||n.memoizedState!==null,pn(t,e,n),et=r):pn(t,e,n);break;default:pn(t,e,n)}}function jf(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var n=t.stateNode;n===null&&(n=t.stateNode=new J_),e.forEach(function(r){var i=c0.bind(null,t,r);n.has(r)||(n.add(r),r.then(i,i))})}}function bt(t,e){var n=e.deletions;if(n!==null)for(var r=0;r<n.length;r++){var i=n[r];try{var s=t,o=e,l=o;e:for(;l!==null;){switch(l.tag){case 5:Ge=l.stateNode,Rt=!1;break e;case 3:Ge=l.stateNode.containerInfo,Rt=!0;break e;case 4:Ge=l.stateNode.containerInfo,Rt=!0;break e}l=l.return}if(Ge===null)throw Error(R(160));Hm(s,o,i),Ge=null,Rt=!1;var a=i.alternate;a!==null&&(a.return=null),i.return=null}catch(u){Re(i,e,u)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)Vm(e,t),e=e.sibling}function Vm(t,e){var n=t.alternate,r=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(bt(e,t),$t(t),r&4){try{Li(3,t,t.return),gl(3,t)}catch(g){Re(t,t.return,g)}try{Li(5,t,t.return)}catch(g){Re(t,t.return,g)}}break;case 1:bt(e,t),$t(t),r&512&&n!==null&&Mr(n,n.return);break;case 5:if(bt(e,t),$t(t),r&512&&n!==null&&Mr(n,n.return),t.flags&32){var i=t.stateNode;try{Qi(i,"")}catch(g){Re(t,t.return,g)}}if(r&4&&(i=t.stateNode,i!=null)){var s=t.memoizedProps,o=n!==null?n.memoizedProps:s,l=t.type,a=t.updateQueue;if(t.updateQueue=null,a!==null)try{l==="input"&&s.type==="radio"&&s.name!=null&&hp(i,s),Va(l,o);var u=Va(l,s);for(o=0;o<a.length;o+=2){var h=a[o],f=a[o+1];h==="style"?vp(i,f):h==="dangerouslySetInnerHTML"?gp(i,f):h==="children"?Qi(i,f):tu(i,h,f,u)}switch(l){case"input":Ba(i,s);break;case"textarea":pp(i,s);break;case"select":var d=i._wrapperState.wasMultiple;i._wrapperState.wasMultiple=!!s.multiple;var v=s.value;v!=null?Br(i,!!s.multiple,v,!1):d!==!!s.multiple&&(s.defaultValue!=null?Br(i,!!s.multiple,s.defaultValue,!0):Br(i,!!s.multiple,s.multiple?[]:"",!1))}i[ns]=s}catch(g){Re(t,t.return,g)}}break;case 6:if(bt(e,t),$t(t),r&4){if(t.stateNode===null)throw Error(R(162));i=t.stateNode,s=t.memoizedProps;try{i.nodeValue=s}catch(g){Re(t,t.return,g)}}break;case 3:if(bt(e,t),$t(t),r&4&&n!==null&&n.memoizedState.isDehydrated)try{Xi(e.containerInfo)}catch(g){Re(t,t.return,g)}break;case 4:bt(e,t),$t(t);break;case 13:bt(e,t),$t(t),i=t.child,i.flags&8192&&(s=i.memoizedState!==null,i.stateNode.isHidden=s,!s||i.alternate!==null&&i.alternate.memoizedState!==null||(Du=Oe())),r&4&&jf(t);break;case 22:if(h=n!==null&&n.memoizedState!==null,t.mode&1?(et=(u=et)||h,bt(e,t),et=u):bt(e,t),$t(t),r&8192){if(u=t.memoizedState!==null,(t.stateNode.isHidden=u)&&!h&&t.mode&1)for(H=t,h=t.child;h!==null;){for(f=H=h;H!==null;){switch(d=H,v=d.child,d.tag){case 0:case 11:case 14:case 15:Li(4,d,d.return);break;case 1:Mr(d,d.return);var x=d.stateNode;if(typeof x.componentWillUnmount=="function"){r=d,n=d.return;try{e=r,x.props=e.memoizedProps,x.state=e.memoizedState,x.componentWillUnmount()}catch(g){Re(r,n,g)}}break;case 5:Mr(d,d.return);break;case 22:if(d.memoizedState!==null){Df(f);continue}}v!==null?(v.return=d,H=v):Df(f)}h=h.sibling}e:for(h=null,f=t;;){if(f.tag===5){if(h===null){h=f;try{i=f.stateNode,u?(s=i.style,typeof s.setProperty=="function"?s.setProperty("display","none","important"):s.display="none"):(l=f.stateNode,a=f.memoizedProps.style,o=a!=null&&a.hasOwnProperty("display")?a.display:null,l.style.display=yp("display",o))}catch(g){Re(t,t.return,g)}}}else if(f.tag===6){if(h===null)try{f.stateNode.nodeValue=u?"":f.memoizedProps}catch(g){Re(t,t.return,g)}}else if((f.tag!==22&&f.tag!==23||f.memoizedState===null||f===t)&&f.child!==null){f.child.return=f,f=f.child;continue}if(f===t)break e;for(;f.sibling===null;){if(f.return===null||f.return===t)break e;h===f&&(h=null),f=f.return}h===f&&(h=null),f.sibling.return=f.return,f=f.sibling}}break;case 19:bt(e,t),$t(t),r&4&&jf(t);break;case 21:break;default:bt(e,t),$t(t)}}function $t(t){var e=t.flags;if(e&2){try{e:{for(var n=t.return;n!==null;){if(Um(n)){var r=n;break e}n=n.return}throw Error(R(160))}switch(r.tag){case 5:var i=r.stateNode;r.flags&32&&(Qi(i,""),r.flags&=-33);var s=Rf(t);Sc(t,s,i);break;case 3:case 4:var o=r.stateNode.containerInfo,l=Rf(t);xc(t,l,o);break;default:throw Error(R(161))}}catch(a){Re(t,t.return,a)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function t0(t,e,n){H=t,Gm(t)}function Gm(t,e,n){for(var r=(t.mode&1)!==0;H!==null;){var i=H,s=i.child;if(i.tag===22&&r){var o=i.memoizedState!==null||Xs;if(!o){var l=i.alternate,a=l!==null&&l.memoizedState!==null||et;l=Xs;var u=et;if(Xs=o,(et=a)&&!u)for(H=i;H!==null;)o=H,a=o.child,o.tag===22&&o.memoizedState!==null?Of(i):a!==null?(a.return=o,H=a):Of(i);for(;s!==null;)H=s,Gm(s),s=s.sibling;H=i,Xs=l,et=u}Af(t)}else i.subtreeFlags&8772&&s!==null?(s.return=i,H=s):Af(t)}}function Af(t){for(;H!==null;){var e=H;if(e.flags&8772){var n=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:et||gl(5,e);break;case 1:var r=e.stateNode;if(e.flags&4&&!et)if(n===null)r.componentDidMount();else{var i=e.elementType===e.type?n.memoizedProps:Pt(e.type,n.memoizedProps);r.componentDidUpdate(i,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var s=e.updateQueue;s!==null&&yf(e,s,r);break;case 3:var o=e.updateQueue;if(o!==null){if(n=null,e.child!==null)switch(e.child.tag){case 5:n=e.child.stateNode;break;case 1:n=e.child.stateNode}yf(e,o,n)}break;case 5:var l=e.stateNode;if(n===null&&e.flags&4){n=l;var a=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":a.autoFocus&&n.focus();break;case"img":a.src&&(n.src=a.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var u=e.alternate;if(u!==null){var h=u.memoizedState;if(h!==null){var f=h.dehydrated;f!==null&&Xi(f)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(R(163))}et||e.flags&512&&_c(e)}catch(d){Re(e,e.return,d)}}if(e===t){H=null;break}if(n=e.sibling,n!==null){n.return=e.return,H=n;break}H=e.return}}function Df(t){for(;H!==null;){var e=H;if(e===t){H=null;break}var n=e.sibling;if(n!==null){n.return=e.return,H=n;break}H=e.return}}function Of(t){for(;H!==null;){var e=H;try{switch(e.tag){case 0:case 11:case 15:var n=e.return;try{gl(4,e)}catch(a){Re(e,n,a)}break;case 1:var r=e.stateNode;if(typeof r.componentDidMount=="function"){var i=e.return;try{r.componentDidMount()}catch(a){Re(e,i,a)}}var s=e.return;try{_c(e)}catch(a){Re(e,s,a)}break;case 5:var o=e.return;try{_c(e)}catch(a){Re(e,o,a)}}}catch(a){Re(e,e.return,a)}if(e===t){H=null;break}var l=e.sibling;if(l!==null){l.return=e.return,H=l;break}H=e.return}}var n0=Math.ceil,Fo=un.ReactCurrentDispatcher,ju=un.ReactCurrentOwner,Tt=un.ReactCurrentBatchConfig,le=0,He=null,Le=null,Ke=0,mt=0,Lr=$n(0),Be=0,as=null,ar=0,yl=0,Au=0,Fi=null,ct=null,Du=0,ei=1/0,Yt=null,zo=!1,wc=null,Nn=null,Zs=!1,xn=null,Bo=0,zi=0,Cc=null,ho=-1,po=0;function st(){return le&6?Oe():ho!==-1?ho:ho=Oe()}function In(t){return t.mode&1?le&2&&Ke!==0?Ke&-Ke:z_.transition!==null?(po===0&&(po=Pp()),po):(t=fe,t!==0||(t=window.event,t=t===void 0?16:Lp(t.type)),t):1}function Mt(t,e,n,r){if(50<zi)throw zi=0,Cc=null,Error(R(185));Cs(t,n,r),(!(le&2)||t!==He)&&(t===He&&(!(le&2)&&(yl|=n),Be===4&&vn(t,Ke)),pt(t,r),n===1&&le===0&&!(e.mode&1)&&(ei=Oe()+500,hl&&Un()))}function pt(t,e){var n=t.callbackNode;zv(t,e);var r=Co(t,t===He?Ke:0);if(r===0)n!==null&&Ud(n),t.callbackNode=null,t.callbackPriority=0;else if(e=r&-r,t.callbackPriority!==e){if(n!=null&&Ud(n),e===1)t.tag===0?F_(Mf.bind(null,t)):nm(Mf.bind(null,t)),D_(function(){!(le&6)&&Un()}),n=null;else{switch(Rp(r)){case 1:n=ou;break;case 4:n=Ip;break;case 16:n=wo;break;case 536870912:n=bp;break;default:n=wo}n=eg(n,Qm.bind(null,t))}t.callbackPriority=e,t.callbackNode=n}}function Qm(t,e){if(ho=-1,po=0,le&6)throw Error(R(327));var n=t.callbackNode;if(Vr()&&t.callbackNode!==n)return null;var r=Co(t,t===He?Ke:0);if(r===0)return null;if(r&30||r&t.expiredLanes||e)e=Wo(t,r);else{e=r;var i=le;le|=2;var s=Ym();(He!==t||Ke!==e)&&(Yt=null,ei=Oe()+500,nr(t,e));do try{s0();break}catch(l){Km(t,l)}while(!0);_u(),Fo.current=s,le=i,Le!==null?e=0:(He=null,Ke=0,e=Be)}if(e!==0){if(e===2&&(i=qa(t),i!==0&&(r=i,e=kc(t,i))),e===1)throw n=as,nr(t,0),vn(t,r),pt(t,Oe()),n;if(e===6)vn(t,r);else{if(i=t.current.alternate,!(r&30)&&!r0(i)&&(e=Wo(t,r),e===2&&(s=qa(t),s!==0&&(r=s,e=kc(t,s))),e===1))throw n=as,nr(t,0),vn(t,r),pt(t,Oe()),n;switch(t.finishedWork=i,t.finishedLanes=r,e){case 0:case 1:throw Error(R(345));case 2:Gn(t,ct,Yt);break;case 3:if(vn(t,r),(r&130023424)===r&&(e=Du+500-Oe(),10<e)){if(Co(t,0)!==0)break;if(i=t.suspendedLanes,(i&r)!==r){st(),t.pingedLanes|=t.suspendedLanes&i;break}t.timeoutHandle=ic(Gn.bind(null,t,ct,Yt),e);break}Gn(t,ct,Yt);break;case 4:if(vn(t,r),(r&4194240)===r)break;for(e=t.eventTimes,i=-1;0<r;){var o=31-Ot(r);s=1<<o,o=e[o],o>i&&(i=o),r&=~s}if(r=i,r=Oe()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*n0(r/1960))-r,10<r){t.timeoutHandle=ic(Gn.bind(null,t,ct,Yt),r);break}Gn(t,ct,Yt);break;case 5:Gn(t,ct,Yt);break;default:throw Error(R(329))}}}return pt(t,Oe()),t.callbackNode===n?Qm.bind(null,t):null}function kc(t,e){var n=Fi;return t.current.memoizedState.isDehydrated&&(nr(t,e).flags|=256),t=Wo(t,e),t!==2&&(e=ct,ct=n,e!==null&&Ec(e)),t}function Ec(t){ct===null?ct=t:ct.push.apply(ct,t)}function r0(t){for(var e=t;;){if(e.flags&16384){var n=e.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var r=0;r<n.length;r++){var i=n[r],s=i.getSnapshot;i=i.value;try{if(!zt(s(),i))return!1}catch{return!1}}}if(n=e.child,e.subtreeFlags&16384&&n!==null)n.return=e,e=n;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function vn(t,e){for(e&=~Au,e&=~yl,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var n=31-Ot(e),r=1<<n;t[n]=-1,e&=~r}}function Mf(t){if(le&6)throw Error(R(327));Vr();var e=Co(t,0);if(!(e&1))return pt(t,Oe()),null;var n=Wo(t,e);if(t.tag!==0&&n===2){var r=qa(t);r!==0&&(e=r,n=kc(t,r))}if(n===1)throw n=as,nr(t,0),vn(t,e),pt(t,Oe()),n;if(n===6)throw Error(R(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,Gn(t,ct,Yt),pt(t,Oe()),null}function Ou(t,e){var n=le;le|=1;try{return t(e)}finally{le=n,le===0&&(ei=Oe()+500,hl&&Un())}}function cr(t){xn!==null&&xn.tag===0&&!(le&6)&&Vr();var e=le;le|=1;var n=Tt.transition,r=fe;try{if(Tt.transition=null,fe=1,t)return t()}finally{fe=r,Tt.transition=n,le=e,!(le&6)&&Un()}}function Mu(){mt=Lr.current,we(Lr)}function nr(t,e){t.finishedWork=null,t.finishedLanes=0;var n=t.timeoutHandle;if(n!==-1&&(t.timeoutHandle=-1,A_(n)),Le!==null)for(n=Le.return;n!==null;){var r=n;switch(gu(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&Io();break;case 3:Zr(),we(ft),we(tt),Eu();break;case 5:ku(r);break;case 4:Zr();break;case 13:we(Ne);break;case 19:we(Ne);break;case 10:xu(r.type._context);break;case 22:case 23:Mu()}n=n.return}if(He=t,Le=t=bn(t.current,null),Ke=mt=e,Be=0,as=null,Au=yl=ar=0,ct=Fi=null,Zn!==null){for(e=0;e<Zn.length;e++)if(n=Zn[e],r=n.interleaved,r!==null){n.interleaved=null;var i=r.next,s=n.pending;if(s!==null){var o=s.next;s.next=i,r.next=o}n.pending=r}Zn=null}return t}function Km(t,e){do{var n=Le;try{if(_u(),co.current=Lo,Mo){for(var r=Ie.memoizedState;r!==null;){var i=r.queue;i!==null&&(i.pending=null),r=r.next}Mo=!1}if(lr=0,$e=Fe=Ie=null,Mi=!1,ss=0,ju.current=null,n===null||n.return===null){Be=1,as=e,Le=null;break}e:{var s=t,o=n.return,l=n,a=e;if(e=Ke,l.flags|=32768,a!==null&&typeof a=="object"&&typeof a.then=="function"){var u=a,h=l,f=h.tag;if(!(h.mode&1)&&(f===0||f===11||f===15)){var d=h.alternate;d?(h.updateQueue=d.updateQueue,h.memoizedState=d.memoizedState,h.lanes=d.lanes):(h.updateQueue=null,h.memoizedState=null)}var v=Cf(o);if(v!==null){v.flags&=-257,kf(v,o,l,s,e),v.mode&1&&wf(s,u,e),e=v,a=u;var x=e.updateQueue;if(x===null){var g=new Set;g.add(a),e.updateQueue=g}else x.add(a);break e}else{if(!(e&1)){wf(s,u,e),Lu();break e}a=Error(R(426))}}else if(Ce&&l.mode&1){var E=Cf(o);if(E!==null){!(E.flags&65536)&&(E.flags|=256),kf(E,o,l,s,e),yu(Jr(a,l));break e}}s=a=Jr(a,l),Be!==4&&(Be=2),Fi===null?Fi=[s]:Fi.push(s),s=o;do{switch(s.tag){case 3:s.flags|=65536,e&=-e,s.lanes|=e;var y=Rm(s,a,e);gf(s,y);break e;case 1:l=a;var p=s.type,m=s.stateNode;if(!(s.flags&128)&&(typeof p.getDerivedStateFromError=="function"||m!==null&&typeof m.componentDidCatch=="function"&&(Nn===null||!Nn.has(m)))){s.flags|=65536,e&=-e,s.lanes|=e;var _=jm(s,l,e);gf(s,_);break e}}s=s.return}while(s!==null)}Xm(n)}catch(k){e=k,Le===n&&n!==null&&(Le=n=n.return);continue}break}while(!0)}function Ym(){var t=Fo.current;return Fo.current=Lo,t===null?Lo:t}function Lu(){(Be===0||Be===3||Be===2)&&(Be=4),He===null||!(ar&268435455)&&!(yl&268435455)||vn(He,Ke)}function Wo(t,e){var n=le;le|=2;var r=Ym();(He!==t||Ke!==e)&&(Yt=null,nr(t,e));do try{i0();break}catch(i){Km(t,i)}while(!0);if(_u(),le=n,Fo.current=r,Le!==null)throw Error(R(261));return He=null,Ke=0,Be}function i0(){for(;Le!==null;)qm(Le)}function s0(){for(;Le!==null&&!Pv();)qm(Le)}function qm(t){var e=Jm(t.alternate,t,mt);t.memoizedProps=t.pendingProps,e===null?Xm(t):Le=e,ju.current=null}function Xm(t){var e=t;do{var n=e.alternate;if(t=e.return,e.flags&32768){if(n=Z_(n,e),n!==null){n.flags&=32767,Le=n;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{Be=6,Le=null;return}}else if(n=X_(n,e,mt),n!==null){Le=n;return}if(e=e.sibling,e!==null){Le=e;return}Le=e=t}while(e!==null);Be===0&&(Be=5)}function Gn(t,e,n){var r=fe,i=Tt.transition;try{Tt.transition=null,fe=1,o0(t,e,n,r)}finally{Tt.transition=i,fe=r}return null}function o0(t,e,n,r){do Vr();while(xn!==null);if(le&6)throw Error(R(327));n=t.finishedWork;var i=t.finishedLanes;if(n===null)return null;if(t.finishedWork=null,t.finishedLanes=0,n===t.current)throw Error(R(177));t.callbackNode=null,t.callbackPriority=0;var s=n.lanes|n.childLanes;if(Bv(t,s),t===He&&(Le=He=null,Ke=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||Zs||(Zs=!0,eg(wo,function(){return Vr(),null})),s=(n.flags&15990)!==0,n.subtreeFlags&15990||s){s=Tt.transition,Tt.transition=null;var o=fe;fe=1;var l=le;le|=4,ju.current=null,e0(t,n),Vm(n,t),T_(nc),ko=!!tc,nc=tc=null,t.current=n,t0(n),Rv(),le=l,fe=o,Tt.transition=s}else t.current=n;if(Zs&&(Zs=!1,xn=t,Bo=i),s=t.pendingLanes,s===0&&(Nn=null),Dv(n.stateNode),pt(t,Oe()),e!==null)for(r=t.onRecoverableError,n=0;n<e.length;n++)i=e[n],r(i.value,{componentStack:i.stack,digest:i.digest});if(zo)throw zo=!1,t=wc,wc=null,t;return Bo&1&&t.tag!==0&&Vr(),s=t.pendingLanes,s&1?t===Cc?zi++:(zi=0,Cc=t):zi=0,Un(),null}function Vr(){if(xn!==null){var t=Rp(Bo),e=Tt.transition,n=fe;try{if(Tt.transition=null,fe=16>t?16:t,xn===null)var r=!1;else{if(t=xn,xn=null,Bo=0,le&6)throw Error(R(331));var i=le;for(le|=4,H=t.current;H!==null;){var s=H,o=s.child;if(H.flags&16){var l=s.deletions;if(l!==null){for(var a=0;a<l.length;a++){var u=l[a];for(H=u;H!==null;){var h=H;switch(h.tag){case 0:case 11:case 15:Li(8,h,s)}var f=h.child;if(f!==null)f.return=h,H=f;else for(;H!==null;){h=H;var d=h.sibling,v=h.return;if($m(h),h===u){H=null;break}if(d!==null){d.return=v,H=d;break}H=v}}}var x=s.alternate;if(x!==null){var g=x.child;if(g!==null){x.child=null;do{var E=g.sibling;g.sibling=null,g=E}while(g!==null)}}H=s}}if(s.subtreeFlags&2064&&o!==null)o.return=s,H=o;else e:for(;H!==null;){if(s=H,s.flags&2048)switch(s.tag){case 0:case 11:case 15:Li(9,s,s.return)}var y=s.sibling;if(y!==null){y.return=s.return,H=y;break e}H=s.return}}var p=t.current;for(H=p;H!==null;){o=H;var m=o.child;if(o.subtreeFlags&2064&&m!==null)m.return=o,H=m;else e:for(o=p;H!==null;){if(l=H,l.flags&2048)try{switch(l.tag){case 0:case 11:case 15:gl(9,l)}}catch(k){Re(l,l.return,k)}if(l===o){H=null;break e}var _=l.sibling;if(_!==null){_.return=l.return,H=_;break e}H=l.return}}if(le=i,Un(),Gt&&typeof Gt.onPostCommitFiberRoot=="function")try{Gt.onPostCommitFiberRoot(al,t)}catch{}r=!0}return r}finally{fe=n,Tt.transition=e}}return!1}function Lf(t,e,n){e=Jr(n,e),e=Rm(t,e,1),t=Tn(t,e,1),e=st(),t!==null&&(Cs(t,1,e),pt(t,e))}function Re(t,e,n){if(t.tag===3)Lf(t,t,n);else for(;e!==null;){if(e.tag===3){Lf(e,t,n);break}else if(e.tag===1){var r=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(Nn===null||!Nn.has(r))){t=Jr(n,t),t=jm(e,t,1),e=Tn(e,t,1),t=st(),e!==null&&(Cs(e,1,t),pt(e,t));break}}e=e.return}}function l0(t,e,n){var r=t.pingCache;r!==null&&r.delete(e),e=st(),t.pingedLanes|=t.suspendedLanes&n,He===t&&(Ke&n)===n&&(Be===4||Be===3&&(Ke&130023424)===Ke&&500>Oe()-Du?nr(t,0):Au|=n),pt(t,e)}function Zm(t,e){e===0&&(t.mode&1?(e=$s,$s<<=1,!($s&130023424)&&($s=4194304)):e=1);var n=st();t=on(t,e),t!==null&&(Cs(t,e,n),pt(t,n))}function a0(t){var e=t.memoizedState,n=0;e!==null&&(n=e.retryLane),Zm(t,n)}function c0(t,e){var n=0;switch(t.tag){case 13:var r=t.stateNode,i=t.memoizedState;i!==null&&(n=i.retryLane);break;case 19:r=t.stateNode;break;default:throw Error(R(314))}r!==null&&r.delete(e),Zm(t,n)}var Jm;Jm=function(t,e,n){if(t!==null)if(t.memoizedProps!==e.pendingProps||ft.current)ut=!0;else{if(!(t.lanes&n)&&!(e.flags&128))return ut=!1,q_(t,e,n);ut=!!(t.flags&131072)}else ut=!1,Ce&&e.flags&1048576&&rm(e,Ro,e.index);switch(e.lanes=0,e.tag){case 2:var r=e.type;fo(t,e),t=e.pendingProps;var i=Yr(e,tt.current);Hr(e,n),i=Nu(null,e,r,t,i,n);var s=Iu();return e.flags|=1,typeof i=="object"&&i!==null&&typeof i.render=="function"&&i.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,ht(r)?(s=!0,bo(e)):s=!1,e.memoizedState=i.state!==null&&i.state!==void 0?i.state:null,wu(e),i.updater=ml,e.stateNode=i,i._reactInternals=e,dc(e,r,t,n),e=pc(null,e,r,!0,s,n)):(e.tag=0,Ce&&s&&mu(e),rt(null,e,i,n),e=e.child),e;case 16:r=e.elementType;e:{switch(fo(t,e),t=e.pendingProps,i=r._init,r=i(r._payload),e.type=r,i=e.tag=d0(r),t=Pt(r,t),i){case 0:e=hc(null,e,r,t,n);break e;case 1:e=Nf(null,e,r,t,n);break e;case 11:e=Ef(null,e,r,t,n);break e;case 14:e=Tf(null,e,r,Pt(r.type,t),n);break e}throw Error(R(306,r,""))}return e;case 0:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:Pt(r,i),hc(t,e,r,i,n);case 1:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:Pt(r,i),Nf(t,e,r,i,n);case 3:e:{if(Mm(e),t===null)throw Error(R(387));r=e.pendingProps,s=e.memoizedState,i=s.element,cm(t,e),Do(e,r,null,n);var o=e.memoizedState;if(r=o.element,s.isDehydrated)if(s={element:r,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},e.updateQueue.baseState=s,e.memoizedState=s,e.flags&256){i=Jr(Error(R(423)),e),e=If(t,e,r,n,i);break e}else if(r!==i){i=Jr(Error(R(424)),e),e=If(t,e,r,n,i);break e}else for(gt=En(e.stateNode.containerInfo.firstChild),yt=e,Ce=!0,jt=null,n=lm(e,null,r,n),e.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(qr(),r===i){e=ln(t,e,n);break e}rt(t,e,r,n)}e=e.child}return e;case 5:return um(e),t===null&&ac(e),r=e.type,i=e.pendingProps,s=t!==null?t.memoizedProps:null,o=i.children,rc(r,i)?o=null:s!==null&&rc(r,s)&&(e.flags|=32),Om(t,e),rt(t,e,o,n),e.child;case 6:return t===null&&ac(e),null;case 13:return Lm(t,e,n);case 4:return Cu(e,e.stateNode.containerInfo),r=e.pendingProps,t===null?e.child=Xr(e,null,r,n):rt(t,e,r,n),e.child;case 11:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:Pt(r,i),Ef(t,e,r,i,n);case 7:return rt(t,e,e.pendingProps,n),e.child;case 8:return rt(t,e,e.pendingProps.children,n),e.child;case 12:return rt(t,e,e.pendingProps.children,n),e.child;case 10:e:{if(r=e.type._context,i=e.pendingProps,s=e.memoizedProps,o=i.value,_e(jo,r._currentValue),r._currentValue=o,s!==null)if(zt(s.value,o)){if(s.children===i.children&&!ft.current){e=ln(t,e,n);break e}}else for(s=e.child,s!==null&&(s.return=e);s!==null;){var l=s.dependencies;if(l!==null){o=s.child;for(var a=l.firstContext;a!==null;){if(a.context===r){if(s.tag===1){a=en(-1,n&-n),a.tag=2;var u=s.updateQueue;if(u!==null){u=u.shared;var h=u.pending;h===null?a.next=a:(a.next=h.next,h.next=a),u.pending=a}}s.lanes|=n,a=s.alternate,a!==null&&(a.lanes|=n),cc(s.return,n,e),l.lanes|=n;break}a=a.next}}else if(s.tag===10)o=s.type===e.type?null:s.child;else if(s.tag===18){if(o=s.return,o===null)throw Error(R(341));o.lanes|=n,l=o.alternate,l!==null&&(l.lanes|=n),cc(o,n,e),o=s.sibling}else o=s.child;if(o!==null)o.return=s;else for(o=s;o!==null;){if(o===e){o=null;break}if(s=o.sibling,s!==null){s.return=o.return,o=s;break}o=o.return}s=o}rt(t,e,i.children,n),e=e.child}return e;case 9:return i=e.type,r=e.pendingProps.children,Hr(e,n),i=Nt(i),r=r(i),e.flags|=1,rt(t,e,r,n),e.child;case 14:return r=e.type,i=Pt(r,e.pendingProps),i=Pt(r.type,i),Tf(t,e,r,i,n);case 15:return Am(t,e,e.type,e.pendingProps,n);case 17:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:Pt(r,i),fo(t,e),e.tag=1,ht(r)?(t=!0,bo(e)):t=!1,Hr(e,n),Pm(e,r,i),dc(e,r,i,n),pc(null,e,r,!0,t,n);case 19:return Fm(t,e,n);case 22:return Dm(t,e,n)}throw Error(R(156,e.tag))};function eg(t,e){return Np(t,e)}function u0(t,e,n,r){this.tag=t,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function kt(t,e,n,r){return new u0(t,e,n,r)}function Fu(t){return t=t.prototype,!(!t||!t.isReactComponent)}function d0(t){if(typeof t=="function")return Fu(t)?1:0;if(t!=null){if(t=t.$$typeof,t===ru)return 11;if(t===iu)return 14}return 2}function bn(t,e){var n=t.alternate;return n===null?(n=kt(t.tag,e,t.key,t.mode),n.elementType=t.elementType,n.type=t.type,n.stateNode=t.stateNode,n.alternate=t,t.alternate=n):(n.pendingProps=e,n.type=t.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=t.flags&14680064,n.childLanes=t.childLanes,n.lanes=t.lanes,n.child=t.child,n.memoizedProps=t.memoizedProps,n.memoizedState=t.memoizedState,n.updateQueue=t.updateQueue,e=t.dependencies,n.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},n.sibling=t.sibling,n.index=t.index,n.ref=t.ref,n}function mo(t,e,n,r,i,s){var o=2;if(r=t,typeof t=="function")Fu(t)&&(o=1);else if(typeof t=="string")o=5;else e:switch(t){case Nr:return rr(n.children,i,s,e);case nu:o=8,i|=8;break;case Oa:return t=kt(12,n,e,i|2),t.elementType=Oa,t.lanes=s,t;case Ma:return t=kt(13,n,e,i),t.elementType=Ma,t.lanes=s,t;case La:return t=kt(19,n,e,i),t.elementType=La,t.lanes=s,t;case up:return vl(n,i,s,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case ap:o=10;break e;case cp:o=9;break e;case ru:o=11;break e;case iu:o=14;break e;case mn:o=16,r=null;break e}throw Error(R(130,t==null?t:typeof t,""))}return e=kt(o,n,e,i),e.elementType=t,e.type=r,e.lanes=s,e}function rr(t,e,n,r){return t=kt(7,t,r,e),t.lanes=n,t}function vl(t,e,n,r){return t=kt(22,t,r,e),t.elementType=up,t.lanes=n,t.stateNode={isHidden:!1},t}function ma(t,e,n){return t=kt(6,t,null,e),t.lanes=n,t}function ga(t,e,n){return e=kt(4,t.children!==null?t.children:[],t.key,e),e.lanes=n,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function f0(t,e,n,r,i){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=ql(0),this.expirationTimes=ql(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=ql(0),this.identifierPrefix=r,this.onRecoverableError=i,this.mutableSourceEagerHydrationData=null}function zu(t,e,n,r,i,s,o,l,a){return t=new f0(t,e,n,l,a),e===1?(e=1,s===!0&&(e|=8)):e=0,s=kt(3,null,null,e),t.current=s,s.stateNode=t,s.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},wu(s),t}function h0(t,e,n){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Tr,key:r==null?null:""+r,children:t,containerInfo:e,implementation:n}}function tg(t){if(!t)return Mn;t=t._reactInternals;e:{if(gr(t)!==t||t.tag!==1)throw Error(R(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(ht(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(R(171))}if(t.tag===1){var n=t.type;if(ht(n))return tm(t,n,e)}return e}function ng(t,e,n,r,i,s,o,l,a){return t=zu(n,r,!0,t,i,s,o,l,a),t.context=tg(null),n=t.current,r=st(),i=In(n),s=en(r,i),s.callback=e??null,Tn(n,s,i),t.current.lanes=i,Cs(t,i,r),pt(t,r),t}function _l(t,e,n,r){var i=e.current,s=st(),o=In(i);return n=tg(n),e.context===null?e.context=n:e.pendingContext=n,e=en(s,o),e.payload={element:t},r=r===void 0?null:r,r!==null&&(e.callback=r),t=Tn(i,e,o),t!==null&&(Mt(t,i,o,s),ao(t,i,o)),o}function $o(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function Ff(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var n=t.retryLane;t.retryLane=n!==0&&n<e?n:e}}function Bu(t,e){Ff(t,e),(t=t.alternate)&&Ff(t,e)}function p0(){return null}var rg=typeof reportError=="function"?reportError:function(t){console.error(t)};function Wu(t){this._internalRoot=t}xl.prototype.render=Wu.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(R(409));_l(t,e,null,null)};xl.prototype.unmount=Wu.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;cr(function(){_l(null,t,null,null)}),e[sn]=null}};function xl(t){this._internalRoot=t}xl.prototype.unstable_scheduleHydration=function(t){if(t){var e=Dp();t={blockedOn:null,target:t,priority:e};for(var n=0;n<yn.length&&e!==0&&e<yn[n].priority;n++);yn.splice(n,0,t),n===0&&Mp(t)}};function $u(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function Sl(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function zf(){}function m0(t,e,n,r,i){if(i){if(typeof r=="function"){var s=r;r=function(){var u=$o(o);s.call(u)}}var o=ng(e,r,t,0,null,!1,!1,"",zf);return t._reactRootContainer=o,t[sn]=o.current,es(t.nodeType===8?t.parentNode:t),cr(),o}for(;i=t.lastChild;)t.removeChild(i);if(typeof r=="function"){var l=r;r=function(){var u=$o(a);l.call(u)}}var a=zu(t,0,!1,null,null,!1,!1,"",zf);return t._reactRootContainer=a,t[sn]=a.current,es(t.nodeType===8?t.parentNode:t),cr(function(){_l(e,a,n,r)}),a}function wl(t,e,n,r,i){var s=n._reactRootContainer;if(s){var o=s;if(typeof i=="function"){var l=i;i=function(){var a=$o(o);l.call(a)}}_l(e,o,t,i)}else o=m0(n,e,t,i,r);return $o(o)}jp=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var n=bi(e.pendingLanes);n!==0&&(lu(e,n|1),pt(e,Oe()),!(le&6)&&(ei=Oe()+500,Un()))}break;case 13:cr(function(){var r=on(t,1);if(r!==null){var i=st();Mt(r,t,1,i)}}),Bu(t,1)}};au=function(t){if(t.tag===13){var e=on(t,134217728);if(e!==null){var n=st();Mt(e,t,134217728,n)}Bu(t,134217728)}};Ap=function(t){if(t.tag===13){var e=In(t),n=on(t,e);if(n!==null){var r=st();Mt(n,t,e,r)}Bu(t,e)}};Dp=function(){return fe};Op=function(t,e){var n=fe;try{return fe=t,e()}finally{fe=n}};Qa=function(t,e,n){switch(e){case"input":if(Ba(t,n),e=n.name,n.type==="radio"&&e!=null){for(n=t;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<n.length;e++){var r=n[e];if(r!==t&&r.form===t.form){var i=fl(r);if(!i)throw Error(R(90));fp(r),Ba(r,i)}}}break;case"textarea":pp(t,n);break;case"select":e=n.value,e!=null&&Br(t,!!n.multiple,e,!1)}};Sp=Ou;wp=cr;var g0={usingClientEntryPoint:!1,Events:[Es,Rr,fl,_p,xp,Ou]},wi={findFiberByHostInstance:Xn,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},y0={bundleType:wi.bundleType,version:wi.version,rendererPackageName:wi.rendererPackageName,rendererConfig:wi.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:un.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=Ep(t),t===null?null:t.stateNode},findFiberByHostInstance:wi.findFiberByHostInstance||p0,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Js=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Js.isDisabled&&Js.supportsFiber)try{al=Js.inject(y0),Gt=Js}catch{}}xt.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=g0;xt.createPortal=function(t,e){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!$u(e))throw Error(R(200));return h0(t,e,null,n)};xt.createRoot=function(t,e){if(!$u(t))throw Error(R(299));var n=!1,r="",i=rg;return e!=null&&(e.unstable_strictMode===!0&&(n=!0),e.identifierPrefix!==void 0&&(r=e.identifierPrefix),e.onRecoverableError!==void 0&&(i=e.onRecoverableError)),e=zu(t,1,!1,null,null,n,!1,r,i),t[sn]=e.current,es(t.nodeType===8?t.parentNode:t),new Wu(e)};xt.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(R(188)):(t=Object.keys(t).join(","),Error(R(268,t)));return t=Ep(e),t=t===null?null:t.stateNode,t};xt.flushSync=function(t){return cr(t)};xt.hydrate=function(t,e,n){if(!Sl(e))throw Error(R(200));return wl(null,t,e,!0,n)};xt.hydrateRoot=function(t,e,n){if(!$u(t))throw Error(R(405));var r=n!=null&&n.hydratedSources||null,i=!1,s="",o=rg;if(n!=null&&(n.unstable_strictMode===!0&&(i=!0),n.identifierPrefix!==void 0&&(s=n.identifierPrefix),n.onRecoverableError!==void 0&&(o=n.onRecoverableError)),e=ng(e,null,t,1,n??null,i,!1,s,o),t[sn]=e.current,es(t),r)for(t=0;t<r.length;t++)n=r[t],i=n._getVersion,i=i(n._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[n,i]:e.mutableSourceEagerHydrationData.push(n,i);return new xl(e)};xt.render=function(t,e,n){if(!Sl(e))throw Error(R(200));return wl(null,t,e,!1,n)};xt.unmountComponentAtNode=function(t){if(!Sl(t))throw Error(R(40));return t._reactRootContainer?(cr(function(){wl(null,null,t,!1,function(){t._reactRootContainer=null,t[sn]=null})}),!0):!1};xt.unstable_batchedUpdates=Ou;xt.unstable_renderSubtreeIntoContainer=function(t,e,n,r){if(!Sl(n))throw Error(R(200));if(t==null||t._reactInternals===void 0)throw Error(R(38));return wl(t,e,n,!1,r)};xt.version="18.3.1-next-f1338f8080-20240426";function ig(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(ig)}catch(t){console.error(t)}}ig(),ip.exports=xt;var v0=ip.exports,Bf=v0;Aa.createRoot=Bf.createRoot,Aa.hydrateRoot=Bf.hydrateRoot;let Qn=null,er=null,Ut=null,ya=!1;function Uu(){if(Qn)return Qn;try{const t=window.AudioContext||window.webkitAudioContext;return Qn=new t,er=Qn.createGain(),er.connect(Qn.destination),er.gain.value=0,Qn}catch{return null}}function _0(){try{const t=Uu();return t?(t.state==="suspended"&&t.resume().catch(()=>{}),sg(50,0,880),!0):!1}catch{return!1}}function sg(t,e,n){try{const r=Uu();if(!r||!er)return;if(ya&&Ut){try{Ut.stop(),Ut.disconnect()}catch{}Ut=null}Ut=r.createOscillator(),Ut.type="sine",Ut.frequency.value=n,er.gain.setValueAtTime(e,r.currentTime),er.gain.exponentialRampToValueAtTime(.001,r.currentTime+t/1e3),Ut.connect(er),Ut.start(r.currentTime),Ut.stop(r.currentTime+t/1e3),ya=!0,setTimeout(()=>{ya=!1},t)}catch{}}function x0(){try{if(!Uu())return;const e=150,n=100,r=6,i=880,s=.3;for(let o=0;o<r;o++){const l=(e+n)*o;setTimeout(()=>{sg(e,s,i)},l)}}catch{}}function S0(){const t=Qn;return t?t.state==="running":!1}const og="audio-unlocked";function w0(){try{sessionStorage.setItem(og,"true")}catch{}}function lg(){try{return sessionStorage.getItem(og)==="true"}catch{return!1}}function C0(t=1e3){const[e,n]=I.useState(new Date);return I.useEffect(()=>{const r=setInterval(()=>n(new Date),t);return()=>clearInterval(r)},[t]),e}const Wf=()=>{const t=C0(),[e,n]=I.useState(!1);I.useEffect(()=>{n(lg())},[]);const r=()=>{_0(),w0(),n(!0)},i=new Intl.DateTimeFormat("ar-EG",{dateStyle:"full",timeStyle:"short",hour12:!0}).format(t);return c.jsx("header",{className:"header",children:c.jsxs("div",{className:"header-inner container",style:{padding:"8px 16px",height:"60px"},children:[c.jsx("div",{className:"header-title",style:{fontSize:"20px"},children:"   "}),c.jsxs("div",{className:"header-bottom",children:[c.jsx("div",{className:"header-subtitle",style:{fontSize:"12px"},children:"   "}),c.jsx("div",{className:"header-date",style:{fontSize:"11px"},children:i})]}),c.jsx("button",{className:"audio-unlock-btn",onClick:r,style:{position:"absolute",top:12,right:12,width:48,height:48,borderRadius:"50%",border:"none",cursor:"pointer",fontSize:24,display:"flex",alignItems:"center",justifyContent:"center",background:e?"#10b981":"#ef4444",color:"#fff",boxShadow:"0 2px 8px rgba(0,0,0,0.2)",transition:"all 0.3s ease",fontWeight:700},title:e?"Audio Unlocked ":"Tap to Unlock Audio Alerts",children:e?"":""})]})})},k0=()=>{};var $f={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ag={NODE_ADMIN:!1,SDK_VERSION:"${JSCORE_VERSION}"};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const A=function(t,e){if(!t)throw ui(e)},ui=function(t){return new Error("Firebase Database ("+ag.SDK_VERSION+") INTERNAL ASSERT FAILED: "+t)};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cg=function(t){const e=[];let n=0;for(let r=0;r<t.length;r++){let i=t.charCodeAt(r);i<128?e[n++]=i:i<2048?(e[n++]=i>>6|192,e[n++]=i&63|128):(i&64512)===55296&&r+1<t.length&&(t.charCodeAt(r+1)&64512)===56320?(i=65536+((i&1023)<<10)+(t.charCodeAt(++r)&1023),e[n++]=i>>18|240,e[n++]=i>>12&63|128,e[n++]=i>>6&63|128,e[n++]=i&63|128):(e[n++]=i>>12|224,e[n++]=i>>6&63|128,e[n++]=i&63|128)}return e},E0=function(t){const e=[];let n=0,r=0;for(;n<t.length;){const i=t[n++];if(i<128)e[r++]=String.fromCharCode(i);else if(i>191&&i<224){const s=t[n++];e[r++]=String.fromCharCode((i&31)<<6|s&63)}else if(i>239&&i<365){const s=t[n++],o=t[n++],l=t[n++],a=((i&7)<<18|(s&63)<<12|(o&63)<<6|l&63)-65536;e[r++]=String.fromCharCode(55296+(a>>10)),e[r++]=String.fromCharCode(56320+(a&1023))}else{const s=t[n++],o=t[n++];e[r++]=String.fromCharCode((i&15)<<12|(s&63)<<6|o&63)}}return e.join("")},Hu={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let i=0;i<t.length;i+=3){const s=t[i],o=i+1<t.length,l=o?t[i+1]:0,a=i+2<t.length,u=a?t[i+2]:0,h=s>>2,f=(s&3)<<4|l>>4;let d=(l&15)<<2|u>>6,v=u&63;a||(v=64,o||(d=64)),r.push(n[h],n[f],n[d],n[v])}return r.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(cg(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):E0(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const n=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let i=0;i<t.length;){const s=n[t.charAt(i++)],l=i<t.length?n[t.charAt(i)]:0;++i;const u=i<t.length?n[t.charAt(i)]:64;++i;const f=i<t.length?n[t.charAt(i)]:64;if(++i,s==null||l==null||u==null||f==null)throw new T0;const d=s<<2|l>>4;if(r.push(d),u!==64){const v=l<<4&240|u>>2;if(r.push(v),f!==64){const x=u<<6&192|f;r.push(x)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};class T0 extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const ug=function(t){const e=cg(t);return Hu.encodeByteArray(e,!0)},Uo=function(t){return ug(t).replace(/\./g,"")},Tc=function(t){try{return Hu.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function N0(t){return dg(void 0,t)}function dg(t,e){if(!(e instanceof Object))return e;switch(e.constructor){case Date:const n=e;return new Date(n.getTime());case Object:t===void 0&&(t={});break;case Array:t=[];break;default:return e}for(const n in e)!e.hasOwnProperty(n)||!I0(n)||(t[n]=dg(t[n],e[n]));return t}function I0(t){return t!=="__proto__"}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function b0(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const P0=()=>b0().__FIREBASE_DEFAULTS__,R0=()=>{if(typeof process>"u"||typeof $f>"u")return;const t=$f.__FIREBASE_DEFAULTS__;if(t)return JSON.parse(t)},j0=()=>{if(typeof document>"u")return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=t&&Tc(t[1]);return e&&JSON.parse(e)},fg=()=>{try{return k0()||P0()||R0()||j0()}catch(t){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`);return}},A0=t=>{var e,n;return(n=(e=fg())===null||e===void 0?void 0:e.emulatorHosts)===null||n===void 0?void 0:n[t]},D0=t=>{const e=A0(t);if(!e)return;const n=e.lastIndexOf(":");if(n<=0||n+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const r=parseInt(e.substring(n+1),10);return e[0]==="["?[e.substring(1,n-1),r]:[e.substring(0,n),r]},hg=()=>{var t;return(t=fg())===null||t===void 0?void 0:t.config};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class di{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}wrapCallback(e){return(n,r)=>{n?this.reject(n):this.resolve(r),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(n):e(n,r))}}}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Vu(t){try{return(t.startsWith("http://")||t.startsWith("https://")?new URL(t).hostname:t).endsWith(".cloudworkstations.dev")}catch{return!1}}async function O0(t){return(await fetch(t,{credentials:"include"})).ok}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function M0(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const n={alg:"none",type:"JWT"},r=e||"demo-project",i=t.iat||0,s=t.sub||t.user_id;if(!s)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const o=Object.assign({iss:`https://securetoken.google.com/${r}`,aud:r,iat:i,exp:i+3600,auth_time:i,sub:s,user_id:s,firebase:{sign_in_provider:"custom",identities:{}}},t);return[Uo(JSON.stringify(n)),Uo(JSON.stringify(o)),""].join(".")}const Bi={};function L0(){const t={prod:[],emulator:[]};for(const e of Object.keys(Bi))Bi[e]?t.emulator.push(e):t.prod.push(e);return t}function F0(t){let e=document.getElementById(t),n=!1;return e||(e=document.createElement("div"),e.setAttribute("id",t),n=!0),{created:n,element:e}}let Uf=!1;function z0(t,e){if(typeof window>"u"||typeof document>"u"||!Vu(window.location.host)||Bi[t]===e||Bi[t]||Uf)return;Bi[t]=e;function n(d){return`__firebase__banner__${d}`}const r="__firebase__banner",s=L0().prod.length>0;function o(){const d=document.getElementById(r);d&&d.remove()}function l(d){d.style.display="flex",d.style.background="#7faaf0",d.style.position="fixed",d.style.bottom="5px",d.style.left="5px",d.style.padding=".5em",d.style.borderRadius="5px",d.style.alignItems="center"}function a(d,v){d.setAttribute("width","24"),d.setAttribute("id",v),d.setAttribute("height","24"),d.setAttribute("viewBox","0 0 24 24"),d.setAttribute("fill","none"),d.style.marginLeft="-6px"}function u(){const d=document.createElement("span");return d.style.cursor="pointer",d.style.marginLeft="16px",d.style.fontSize="24px",d.innerHTML=" &times;",d.onclick=()=>{Uf=!0,o()},d}function h(d,v){d.setAttribute("id",v),d.innerText="Learn more",d.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",d.setAttribute("target","__blank"),d.style.paddingLeft="5px",d.style.textDecoration="underline"}function f(){const d=F0(r),v=n("text"),x=document.getElementById(v)||document.createElement("span"),g=n("learnmore"),E=document.getElementById(g)||document.createElement("a"),y=n("preprendIcon"),p=document.getElementById(y)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(d.created){const m=d.element;l(m),h(E,g);const _=u();a(p,y),m.append(p,x,E,_),document.body.appendChild(m)}s?(x.innerText="Preview backend disconnected.",p.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(p.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,x.innerText="Preview backend running in this workspace."),x.setAttribute("id",v)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",f):f()}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function B0(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function pg(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(B0())}function W0(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function $0(){return ag.NODE_ADMIN===!0}function U0(){try{return typeof indexedDB=="object"}catch{return!1}}function H0(){return new Promise((t,e)=>{try{let n=!0;const r="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(r);i.onsuccess=()=>{i.result.close(),n||self.indexedDB.deleteDatabase(r),t(!0)},i.onupgradeneeded=()=>{n=!1},i.onerror=()=>{var s;e(((s=i.error)===null||s===void 0?void 0:s.message)||"")}}catch(n){e(n)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const V0="FirebaseError";class Ns extends Error{constructor(e,n,r){super(n),this.code=e,this.customData=r,this.name=V0,Object.setPrototypeOf(this,Ns.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,mg.prototype.create)}}class mg{constructor(e,n,r){this.service=e,this.serviceName=n,this.errors=r}create(e,...n){const r=n[0]||{},i=`${this.service}/${e}`,s=this.errors[e],o=s?G0(s,r):"Error",l=`${this.serviceName}: ${o} (${i}).`;return new Ns(i,l,r)}}function G0(t,e){return t.replace(Q0,(n,r)=>{const i=e[r];return i!=null?String(i):`<${r}?>`})}const Q0=/\{\$([^}]+)}/g;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function cs(t){return JSON.parse(t)}function ze(t){return JSON.stringify(t)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gg=function(t){let e={},n={},r={},i="";try{const s=t.split(".");e=cs(Tc(s[0])||""),n=cs(Tc(s[1])||""),i=s[2],r=n.d||{},delete n.d}catch{}return{header:e,claims:n,data:r,signature:i}},K0=function(t){const e=gg(t),n=e.claims;return!!n&&typeof n=="object"&&n.hasOwnProperty("iat")},Y0=function(t){const e=gg(t).claims;return typeof e=="object"&&e.admin===!0};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Bt(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function ur(t,e){if(Object.prototype.hasOwnProperty.call(t,e))return t[e]}function Hf(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function Ho(t,e,n){const r={};for(const i in t)Object.prototype.hasOwnProperty.call(t,i)&&(r[i]=e.call(n,t[i],i,t));return r}function Vo(t,e){if(t===e)return!0;const n=Object.keys(t),r=Object.keys(e);for(const i of n){if(!r.includes(i))return!1;const s=t[i],o=e[i];if(Vf(s)&&Vf(o)){if(!Vo(s,o))return!1}else if(s!==o)return!1}for(const i of r)if(!n.includes(i))return!1;return!0}function Vf(t){return t!==null&&typeof t=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function q0(t){const e=[];for(const[n,r]of Object.entries(t))Array.isArray(r)?r.forEach(i=>{e.push(encodeURIComponent(n)+"="+encodeURIComponent(i))}):e.push(encodeURIComponent(n)+"="+encodeURIComponent(r));return e.length?"&"+e.join("&"):""}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class X0{constructor(){this.chain_=[],this.buf_=[],this.W_=[],this.pad_=[],this.inbuf_=0,this.total_=0,this.blockSize=512/8,this.pad_[0]=128;for(let e=1;e<this.blockSize;++e)this.pad_[e]=0;this.reset()}reset(){this.chain_[0]=1732584193,this.chain_[1]=4023233417,this.chain_[2]=2562383102,this.chain_[3]=271733878,this.chain_[4]=3285377520,this.inbuf_=0,this.total_=0}compress_(e,n){n||(n=0);const r=this.W_;if(typeof e=="string")for(let f=0;f<16;f++)r[f]=e.charCodeAt(n)<<24|e.charCodeAt(n+1)<<16|e.charCodeAt(n+2)<<8|e.charCodeAt(n+3),n+=4;else for(let f=0;f<16;f++)r[f]=e[n]<<24|e[n+1]<<16|e[n+2]<<8|e[n+3],n+=4;for(let f=16;f<80;f++){const d=r[f-3]^r[f-8]^r[f-14]^r[f-16];r[f]=(d<<1|d>>>31)&4294967295}let i=this.chain_[0],s=this.chain_[1],o=this.chain_[2],l=this.chain_[3],a=this.chain_[4],u,h;for(let f=0;f<80;f++){f<40?f<20?(u=l^s&(o^l),h=1518500249):(u=s^o^l,h=1859775393):f<60?(u=s&o|l&(s|o),h=2400959708):(u=s^o^l,h=3395469782);const d=(i<<5|i>>>27)+u+a+h+r[f]&4294967295;a=l,l=o,o=(s<<30|s>>>2)&4294967295,s=i,i=d}this.chain_[0]=this.chain_[0]+i&4294967295,this.chain_[1]=this.chain_[1]+s&4294967295,this.chain_[2]=this.chain_[2]+o&4294967295,this.chain_[3]=this.chain_[3]+l&4294967295,this.chain_[4]=this.chain_[4]+a&4294967295}update(e,n){if(e==null)return;n===void 0&&(n=e.length);const r=n-this.blockSize;let i=0;const s=this.buf_;let o=this.inbuf_;for(;i<n;){if(o===0)for(;i<=r;)this.compress_(e,i),i+=this.blockSize;if(typeof e=="string"){for(;i<n;)if(s[o]=e.charCodeAt(i),++o,++i,o===this.blockSize){this.compress_(s),o=0;break}}else for(;i<n;)if(s[o]=e[i],++o,++i,o===this.blockSize){this.compress_(s),o=0;break}}this.inbuf_=o,this.total_+=n}digest(){const e=[];let n=this.total_*8;this.inbuf_<56?this.update(this.pad_,56-this.inbuf_):this.update(this.pad_,this.blockSize-(this.inbuf_-56));for(let i=this.blockSize-1;i>=56;i--)this.buf_[i]=n&255,n/=256;this.compress_(this.buf_);let r=0;for(let i=0;i<5;i++)for(let s=24;s>=0;s-=8)e[r]=this.chain_[i]>>s&255,++r;return e}}function Cl(t,e){return`${t} failed: ${e} argument `}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Z0=function(t){const e=[];let n=0;for(let r=0;r<t.length;r++){let i=t.charCodeAt(r);if(i>=55296&&i<=56319){const s=i-55296;r++,A(r<t.length,"Surrogate pair missing trail surrogate.");const o=t.charCodeAt(r)-56320;i=65536+(s<<10)+o}i<128?e[n++]=i:i<2048?(e[n++]=i>>6|192,e[n++]=i&63|128):i<65536?(e[n++]=i>>12|224,e[n++]=i>>6&63|128,e[n++]=i&63|128):(e[n++]=i>>18|240,e[n++]=i>>12&63|128,e[n++]=i>>6&63|128,e[n++]=i&63|128)}return e},kl=function(t){let e=0;for(let n=0;n<t.length;n++){const r=t.charCodeAt(n);r<128?e++:r<2048?e+=2:r>=55296&&r<=56319?(e+=4,n++):e+=3}return e};/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function dn(t){return t&&t._delegate?t._delegate:t}class us{constructor(e,n,r){this.name=e,this.instanceFactory=n,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Kn="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class J0{constructor(e,n){this.name=e,this.container=n,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const n=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(n)){const r=new di;if(this.instancesDeferred.set(n,r),this.isInitialized(n)||this.shouldAutoInitialize())try{const i=this.getOrInitializeService({instanceIdentifier:n});i&&r.resolve(i)}catch{}}return this.instancesDeferred.get(n).promise}getImmediate(e){var n;const r=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),i=(n=e==null?void 0:e.optional)!==null&&n!==void 0?n:!1;if(this.isInitialized(r)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:r})}catch(s){if(i)return null;throw s}else{if(i)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(t1(e))try{this.getOrInitializeService({instanceIdentifier:Kn})}catch{}for(const[n,r]of this.instancesDeferred.entries()){const i=this.normalizeInstanceIdentifier(n);try{const s=this.getOrInitializeService({instanceIdentifier:i});r.resolve(s)}catch{}}}}clearInstance(e=Kn){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(n=>"INTERNAL"in n).map(n=>n.INTERNAL.delete()),...e.filter(n=>"_delete"in n).map(n=>n._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=Kn){return this.instances.has(e)}getOptions(e=Kn){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:n={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const i=this.getOrInitializeService({instanceIdentifier:r,options:n});for(const[s,o]of this.instancesDeferred.entries()){const l=this.normalizeInstanceIdentifier(s);r===l&&o.resolve(i)}return i}onInit(e,n){var r;const i=this.normalizeInstanceIdentifier(n),s=(r=this.onInitCallbacks.get(i))!==null&&r!==void 0?r:new Set;s.add(e),this.onInitCallbacks.set(i,s);const o=this.instances.get(i);return o&&e(o,i),()=>{s.delete(e)}}invokeOnInitCallbacks(e,n){const r=this.onInitCallbacks.get(n);if(r)for(const i of r)try{i(e,n)}catch{}}getOrInitializeService({instanceIdentifier:e,options:n={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:e1(e),options:n}),this.instances.set(e,r),this.instancesOptions.set(e,n),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch{}return r||null}normalizeInstanceIdentifier(e=Kn){return this.component?this.component.multipleInstances?e:Kn:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function e1(t){return t===Kn?void 0:t}function t1(t){return t.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class n1{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const n=this.getProvider(e.name);if(n.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);n.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const n=new J0(e,this);return this.providers.set(e,n),n}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var ye;(function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"})(ye||(ye={}));const r1={debug:ye.DEBUG,verbose:ye.VERBOSE,info:ye.INFO,warn:ye.WARN,error:ye.ERROR,silent:ye.SILENT},i1=ye.INFO,s1={[ye.DEBUG]:"log",[ye.VERBOSE]:"log",[ye.INFO]:"info",[ye.WARN]:"warn",[ye.ERROR]:"error"},o1=(t,e,...n)=>{if(e<t.logLevel)return;const r=new Date().toISOString(),i=s1[e];if(i)console[i](`[${r}]  ${t.name}:`,...n);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class yg{constructor(e){this.name=e,this._logLevel=i1,this._logHandler=o1,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in ye))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?r1[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,ye.DEBUG,...e),this._logHandler(this,ye.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,ye.VERBOSE,...e),this._logHandler(this,ye.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,ye.INFO,...e),this._logHandler(this,ye.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,ye.WARN,...e),this._logHandler(this,ye.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,ye.ERROR,...e),this._logHandler(this,ye.ERROR,...e)}}const l1=(t,e)=>e.some(n=>t instanceof n);let Gf,Qf;function a1(){return Gf||(Gf=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function c1(){return Qf||(Qf=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const vg=new WeakMap,Nc=new WeakMap,_g=new WeakMap,va=new WeakMap,Gu=new WeakMap;function u1(t){const e=new Promise((n,r)=>{const i=()=>{t.removeEventListener("success",s),t.removeEventListener("error",o)},s=()=>{n(Pn(t.result)),i()},o=()=>{r(t.error),i()};t.addEventListener("success",s),t.addEventListener("error",o)});return e.then(n=>{n instanceof IDBCursor&&vg.set(n,t)}).catch(()=>{}),Gu.set(e,t),e}function d1(t){if(Nc.has(t))return;const e=new Promise((n,r)=>{const i=()=>{t.removeEventListener("complete",s),t.removeEventListener("error",o),t.removeEventListener("abort",o)},s=()=>{n(),i()},o=()=>{r(t.error||new DOMException("AbortError","AbortError")),i()};t.addEventListener("complete",s),t.addEventListener("error",o),t.addEventListener("abort",o)});Nc.set(t,e)}let Ic={get(t,e,n){if(t instanceof IDBTransaction){if(e==="done")return Nc.get(t);if(e==="objectStoreNames")return t.objectStoreNames||_g.get(t);if(e==="store")return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return Pn(t[e])},set(t,e,n){return t[e]=n,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function f1(t){Ic=t(Ic)}function h1(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...n){const r=t.call(_a(this),e,...n);return _g.set(r,e.sort?e.sort():[e]),Pn(r)}:c1().includes(t)?function(...e){return t.apply(_a(this),e),Pn(vg.get(this))}:function(...e){return Pn(t.apply(_a(this),e))}}function p1(t){return typeof t=="function"?h1(t):(t instanceof IDBTransaction&&d1(t),l1(t,a1())?new Proxy(t,Ic):t)}function Pn(t){if(t instanceof IDBRequest)return u1(t);if(va.has(t))return va.get(t);const e=p1(t);return e!==t&&(va.set(t,e),Gu.set(e,t)),e}const _a=t=>Gu.get(t);function m1(t,e,{blocked:n,upgrade:r,blocking:i,terminated:s}={}){const o=indexedDB.open(t,e),l=Pn(o);return r&&o.addEventListener("upgradeneeded",a=>{r(Pn(o.result),a.oldVersion,a.newVersion,Pn(o.transaction),a)}),n&&o.addEventListener("blocked",a=>n(a.oldVersion,a.newVersion,a)),l.then(a=>{s&&a.addEventListener("close",()=>s()),i&&a.addEventListener("versionchange",u=>i(u.oldVersion,u.newVersion,u))}).catch(()=>{}),l}const g1=["get","getKey","getAll","getAllKeys","count"],y1=["put","add","delete","clear"],xa=new Map;function Kf(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(xa.get(e))return xa.get(e);const n=e.replace(/FromIndex$/,""),r=e!==n,i=y1.includes(n);if(!(n in(r?IDBIndex:IDBObjectStore).prototype)||!(i||g1.includes(n)))return;const s=async function(o,...l){const a=this.transaction(o,i?"readwrite":"readonly");let u=a.store;return r&&(u=u.index(l.shift())),(await Promise.all([u[n](...l),i&&a.done]))[0]};return xa.set(e,s),s}f1(t=>({...t,get:(e,n,r)=>Kf(e,n)||t.get(e,n,r),has:(e,n)=>!!Kf(e,n)||t.has(e,n)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class v1{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(n=>{if(_1(n)){const r=n.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(n=>n).join(" ")}}function _1(t){const e=t.getComponent();return(e==null?void 0:e.type)==="VERSION"}const bc="@firebase/app",Yf="0.13.2";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const an=new yg("@firebase/app"),x1="@firebase/app-compat",S1="@firebase/analytics-compat",w1="@firebase/analytics",C1="@firebase/app-check-compat",k1="@firebase/app-check",E1="@firebase/auth",T1="@firebase/auth-compat",N1="@firebase/database",I1="@firebase/data-connect",b1="@firebase/database-compat",P1="@firebase/functions",R1="@firebase/functions-compat",j1="@firebase/installations",A1="@firebase/installations-compat",D1="@firebase/messaging",O1="@firebase/messaging-compat",M1="@firebase/performance",L1="@firebase/performance-compat",F1="@firebase/remote-config",z1="@firebase/remote-config-compat",B1="@firebase/storage",W1="@firebase/storage-compat",$1="@firebase/firestore",U1="@firebase/ai",H1="@firebase/firestore-compat",V1="firebase",G1="11.10.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Pc="[DEFAULT]",Q1={[bc]:"fire-core",[x1]:"fire-core-compat",[w1]:"fire-analytics",[S1]:"fire-analytics-compat",[k1]:"fire-app-check",[C1]:"fire-app-check-compat",[E1]:"fire-auth",[T1]:"fire-auth-compat",[N1]:"fire-rtdb",[I1]:"fire-data-connect",[b1]:"fire-rtdb-compat",[P1]:"fire-fn",[R1]:"fire-fn-compat",[j1]:"fire-iid",[A1]:"fire-iid-compat",[D1]:"fire-fcm",[O1]:"fire-fcm-compat",[M1]:"fire-perf",[L1]:"fire-perf-compat",[F1]:"fire-rc",[z1]:"fire-rc-compat",[B1]:"fire-gcs",[W1]:"fire-gcs-compat",[$1]:"fire-fst",[H1]:"fire-fst-compat",[U1]:"fire-vertex","fire-js":"fire-js",[V1]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ds=new Map,K1=new Map,Rc=new Map;function qf(t,e){try{t.container.addComponent(e)}catch(n){an.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,n)}}function Go(t){const e=t.name;if(Rc.has(e))return an.debug(`There were multiple attempts to register component ${e}.`),!1;Rc.set(e,t);for(const n of ds.values())qf(n,t);for(const n of K1.values())qf(n,t);return!0}function Y1(t,e){const n=t.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),t.container.getProvider(e)}function q1(t){return t==null?!1:t.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const X1={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},Rn=new mg("app","Firebase",X1);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Z1{constructor(e,n,r){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},n),this._name=n.name,this._automaticDataCollectionEnabled=n.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new us("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw Rn.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const J1=G1;function xg(t,e={}){let n=t;typeof e!="object"&&(e={name:e});const r=Object.assign({name:Pc,automaticDataCollectionEnabled:!0},e),i=r.name;if(typeof i!="string"||!i)throw Rn.create("bad-app-name",{appName:String(i)});if(n||(n=hg()),!n)throw Rn.create("no-options");const s=ds.get(i);if(s){if(Vo(n,s.options)&&Vo(r,s.config))return s;throw Rn.create("duplicate-app",{appName:i})}const o=new n1(i);for(const a of Rc.values())o.addComponent(a);const l=new Z1(n,r,o);return ds.set(i,l),l}function ex(t=Pc){const e=ds.get(t);if(!e&&t===Pc&&hg())return xg();if(!e)throw Rn.create("no-app",{appName:t});return e}function Xf(){return Array.from(ds.values())}function Gr(t,e,n){var r;let i=(r=Q1[t])!==null&&r!==void 0?r:t;n&&(i+=`-${n}`);const s=i.match(/\s|\//),o=e.match(/\s|\//);if(s||o){const l=[`Unable to register library "${i}" with version "${e}":`];s&&l.push(`library name "${i}" contains illegal characters (whitespace or "/")`),s&&o&&l.push("and"),o&&l.push(`version name "${e}" contains illegal characters (whitespace or "/")`),an.warn(l.join(" "));return}Go(new us(`${i}-version`,()=>({library:i,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const tx="firebase-heartbeat-database",nx=1,fs="firebase-heartbeat-store";let Sa=null;function Sg(){return Sa||(Sa=m1(tx,nx,{upgrade:(t,e)=>{switch(e){case 0:try{t.createObjectStore(fs)}catch(n){console.warn(n)}}}}).catch(t=>{throw Rn.create("idb-open",{originalErrorMessage:t.message})})),Sa}async function rx(t){try{const n=(await Sg()).transaction(fs),r=await n.objectStore(fs).get(wg(t));return await n.done,r}catch(e){if(e instanceof Ns)an.warn(e.message);else{const n=Rn.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});an.warn(n.message)}}}async function Zf(t,e){try{const r=(await Sg()).transaction(fs,"readwrite");await r.objectStore(fs).put(e,wg(t)),await r.done}catch(n){if(n instanceof Ns)an.warn(n.message);else{const r=Rn.create("idb-set",{originalErrorMessage:n==null?void 0:n.message});an.warn(r.message)}}}function wg(t){return`${t.name}!${t.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ix=1024,sx=30;class ox{constructor(e){this.container=e,this._heartbeatsCache=null;const n=this.container.getProvider("app").getImmediate();this._storage=new ax(n),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}async triggerHeartbeat(){var e,n;try{const i=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),s=Jf();if(((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((n=this._heartbeatsCache)===null||n===void 0?void 0:n.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===s||this._heartbeatsCache.heartbeats.some(o=>o.date===s))return;if(this._heartbeatsCache.heartbeats.push({date:s,agent:i}),this._heartbeatsCache.heartbeats.length>sx){const o=cx(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(o,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(r){an.warn(r)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const n=Jf(),{heartbeatsToSend:r,unsentEntries:i}=lx(this._heartbeatsCache.heartbeats),s=Uo(JSON.stringify({version:2,heartbeats:r}));return this._heartbeatsCache.lastSentHeartbeatDate=n,i.length>0?(this._heartbeatsCache.heartbeats=i,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),s}catch(n){return an.warn(n),""}}}function Jf(){return new Date().toISOString().substring(0,10)}function lx(t,e=ix){const n=[];let r=t.slice();for(const i of t){const s=n.find(o=>o.agent===i.agent);if(s){if(s.dates.push(i.date),eh(n)>e){s.dates.pop();break}}else if(n.push({agent:i.agent,dates:[i.date]}),eh(n)>e){n.pop();break}r=r.slice(1)}return{heartbeatsToSend:n,unsentEntries:r}}class ax{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return U0()?H0().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const n=await rx(this.app);return n!=null&&n.heartbeats?n:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){var n;if(await this._canUseIndexedDBPromise){const i=await this.read();return Zf(this.app,{lastSentHeartbeatDate:(n=e.lastSentHeartbeatDate)!==null&&n!==void 0?n:i.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){var n;if(await this._canUseIndexedDBPromise){const i=await this.read();return Zf(this.app,{lastSentHeartbeatDate:(n=e.lastSentHeartbeatDate)!==null&&n!==void 0?n:i.lastSentHeartbeatDate,heartbeats:[...i.heartbeats,...e.heartbeats]})}else return}}function eh(t){return Uo(JSON.stringify({version:2,heartbeats:t})).length}function cx(t){if(t.length===0)return-1;let e=0,n=t[0].date;for(let r=1;r<t.length;r++)t[r].date<n&&(n=t[r].date,e=r);return e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ux(t){Go(new us("platform-logger",e=>new v1(e),"PRIVATE")),Go(new us("heartbeat",e=>new ox(e),"PRIVATE")),Gr(bc,Yf,t),Gr(bc,Yf,"esm2017"),Gr("fire-js","")}ux("");var dx="firebase",fx="11.10.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Gr(dx,fx,"app");var th={};const nh="@firebase/database",rh="1.0.20";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Cg="";function hx(t){Cg=t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class px{constructor(e){this.domStorage_=e,this.prefix_="firebase:"}set(e,n){n==null?this.domStorage_.removeItem(this.prefixedName_(e)):this.domStorage_.setItem(this.prefixedName_(e),ze(n))}get(e){const n=this.domStorage_.getItem(this.prefixedName_(e));return n==null?null:cs(n)}remove(e){this.domStorage_.removeItem(this.prefixedName_(e))}prefixedName_(e){return this.prefix_+e}toString(){return this.domStorage_.toString()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mx{constructor(){this.cache_={},this.isInMemoryStorage=!0}set(e,n){n==null?delete this.cache_[e]:this.cache_[e]=n}get(e){return Bt(this.cache_,e)?this.cache_[e]:null}remove(e){delete this.cache_[e]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const kg=function(t){try{if(typeof window<"u"&&typeof window[t]<"u"){const e=window[t];return e.setItem("firebase:sentinel","cache"),e.removeItem("firebase:sentinel"),new px(e)}}catch{}return new mx},tr=kg("localStorage"),gx=kg("sessionStorage");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Qr=new yg("@firebase/database"),Eg=function(){let t=1;return function(){return t++}}(),Tg=function(t){const e=Z0(t),n=new X0;n.update(e);const r=n.digest();return Hu.encodeByteArray(r)},Is=function(...t){let e="";for(let n=0;n<t.length;n++){const r=t[n];Array.isArray(r)||r&&typeof r=="object"&&typeof r.length=="number"?e+=Is.apply(null,r):typeof r=="object"?e+=ze(r):e+=r,e+=" "}return e};let Wi=null,ih=!0;const yx=function(t,e){A(!0,"Can't turn on custom loggers persistently."),Qr.logLevel=ye.VERBOSE,Wi=Qr.log.bind(Qr)},Qe=function(...t){if(ih===!0&&(ih=!1,Wi===null&&gx.get("logging_enabled")===!0&&yx()),Wi){const e=Is.apply(null,t);Wi(e)}},bs=function(t){return function(...e){Qe(t,...e)}},jc=function(...t){const e="FIREBASE INTERNAL ERROR: "+Is(...t);Qr.error(e)},cn=function(...t){const e=`FIREBASE FATAL ERROR: ${Is(...t)}`;throw Qr.error(e),new Error(e)},ot=function(...t){const e="FIREBASE WARNING: "+Is(...t);Qr.warn(e)},vx=function(){typeof window<"u"&&window.location&&window.location.protocol&&window.location.protocol.indexOf("https:")!==-1&&ot("Insecure Firebase access from a secure page. Please use https in calls to new Firebase().")},Qu=function(t){return typeof t=="number"&&(t!==t||t===Number.POSITIVE_INFINITY||t===Number.NEGATIVE_INFINITY)},_x=function(t){if(document.readyState==="complete")t();else{let e=!1;const n=function(){if(!document.body){setTimeout(n,Math.floor(10));return}e||(e=!0,t())};document.addEventListener?(document.addEventListener("DOMContentLoaded",n,!1),window.addEventListener("load",n,!1)):document.attachEvent&&(document.attachEvent("onreadystatechange",()=>{document.readyState==="complete"&&n()}),window.attachEvent("onload",n))}},dr="[MIN_NAME]",Ln="[MAX_NAME]",yr=function(t,e){if(t===e)return 0;if(t===dr||e===Ln)return-1;if(e===dr||t===Ln)return 1;{const n=sh(t),r=sh(e);return n!==null?r!==null?n-r===0?t.length-e.length:n-r:-1:r!==null?1:t<e?-1:1}},xx=function(t,e){return t===e?0:t<e?-1:1},Ci=function(t,e){if(e&&t in e)return e[t];throw new Error("Missing required key ("+t+") in object: "+ze(e))},Ku=function(t){if(typeof t!="object"||t===null)return ze(t);const e=[];for(const r in t)e.push(r);e.sort();let n="{";for(let r=0;r<e.length;r++)r!==0&&(n+=","),n+=ze(e[r]),n+=":",n+=Ku(t[e[r]]);return n+="}",n},Ng=function(t,e){const n=t.length;if(n<=e)return[t];const r=[];for(let i=0;i<n;i+=e)i+e>n?r.push(t.substring(i,n)):r.push(t.substring(i,i+e));return r};function qe(t,e){for(const n in t)t.hasOwnProperty(n)&&e(n,t[n])}const Ig=function(t){A(!Qu(t),"Invalid JSON number");const e=11,n=52,r=(1<<e-1)-1;let i,s,o,l,a;t===0?(s=0,o=0,i=1/t===-1/0?1:0):(i=t<0,t=Math.abs(t),t>=Math.pow(2,1-r)?(l=Math.min(Math.floor(Math.log(t)/Math.LN2),r),s=l+r,o=Math.round(t*Math.pow(2,n-l)-Math.pow(2,n))):(s=0,o=Math.round(t/Math.pow(2,1-r-n))));const u=[];for(a=n;a;a-=1)u.push(o%2?1:0),o=Math.floor(o/2);for(a=e;a;a-=1)u.push(s%2?1:0),s=Math.floor(s/2);u.push(i?1:0),u.reverse();const h=u.join("");let f="";for(a=0;a<64;a+=8){let d=parseInt(h.substr(a,8),2).toString(16);d.length===1&&(d="0"+d),f=f+d}return f.toLowerCase()},Sx=function(){return!!(typeof window=="object"&&window.chrome&&window.chrome.extension&&!/^chrome/.test(window.location.href))},wx=function(){return typeof Windows=="object"&&typeof Windows.UI=="object"};function Cx(t,e){let n="Unknown Error";t==="too_big"?n="The data requested exceeds the maximum size that can be accessed with a single request.":t==="permission_denied"?n="Client doesn't have permission to access the desired data.":t==="unavailable"&&(n="The service is unavailable");const r=new Error(t+" at "+e._path.toString()+": "+n);return r.code=t.toUpperCase(),r}const kx=new RegExp("^-?(0*)\\d{1,10}$"),Ex=-2147483648,Tx=2147483647,sh=function(t){if(kx.test(t)){const e=Number(t);if(e>=Ex&&e<=Tx)return e}return null},fi=function(t){try{t()}catch(e){setTimeout(()=>{const n=e.stack||"";throw ot("Exception was thrown by user callback.",n),e},Math.floor(0))}},Nx=function(){return(typeof window=="object"&&window.navigator&&window.navigator.userAgent||"").search(/googlebot|google webmaster tools|bingbot|yahoo! slurp|baiduspider|yandexbot|duckduckbot/i)>=0},$i=function(t,e){const n=setTimeout(t,e);return typeof n=="number"&&typeof Deno<"u"&&Deno.unrefTimer?Deno.unrefTimer(n):typeof n=="object"&&n.unref&&n.unref(),n};/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ix{constructor(e,n){this.appCheckProvider=n,this.appName=e.name,q1(e)&&e.settings.appCheckToken&&(this.serverAppAppCheckToken=e.settings.appCheckToken),this.appCheck=n==null?void 0:n.getImmediate({optional:!0}),this.appCheck||n==null||n.get().then(r=>this.appCheck=r)}getToken(e){if(this.serverAppAppCheckToken){if(e)throw new Error("Attempted reuse of `FirebaseServerApp.appCheckToken` after previous usage failed.");return Promise.resolve({token:this.serverAppAppCheckToken})}return this.appCheck?this.appCheck.getToken(e):new Promise((n,r)=>{setTimeout(()=>{this.appCheck?this.getToken(e).then(n,r):n(null)},0)})}addTokenChangeListener(e){var n;(n=this.appCheckProvider)===null||n===void 0||n.get().then(r=>r.addTokenListener(e))}notifyForInvalidToken(){ot(`Provided AppCheck credentials for the app named "${this.appName}" are invalid. This usually indicates your app was not initialized correctly.`)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bx{constructor(e,n,r){this.appName_=e,this.firebaseOptions_=n,this.authProvider_=r,this.auth_=null,this.auth_=r.getImmediate({optional:!0}),this.auth_||r.onInit(i=>this.auth_=i)}getToken(e){return this.auth_?this.auth_.getToken(e).catch(n=>n&&n.code==="auth/token-not-initialized"?(Qe("Got auth/token-not-initialized error.  Treating as null token."),null):Promise.reject(n)):new Promise((n,r)=>{setTimeout(()=>{this.auth_?this.getToken(e).then(n,r):n(null)},0)})}addTokenChangeListener(e){this.auth_?this.auth_.addAuthTokenListener(e):this.authProvider_.get().then(n=>n.addAuthTokenListener(e))}removeTokenChangeListener(e){this.authProvider_.get().then(n=>n.removeAuthTokenListener(e))}notifyForInvalidToken(){let e='Provided authentication credentials for the app named "'+this.appName_+'" are invalid. This usually indicates your app was not initialized correctly. ';"credential"in this.firebaseOptions_?e+='Make sure the "credential" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':"serviceAccount"in this.firebaseOptions_?e+='Make sure the "serviceAccount" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':e+='Make sure the "apiKey" and "databaseURL" properties provided to initializeApp() match the values provided for your app at https://console.firebase.google.com/.',ot(e)}}class go{constructor(e){this.accessToken=e}getToken(e){return Promise.resolve({accessToken:this.accessToken})}addTokenChangeListener(e){e(this.accessToken)}removeTokenChangeListener(e){}notifyForInvalidToken(){}}go.OWNER="owner";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Yu="5",bg="v",Pg="s",Rg="r",jg="f",Ag=/(console\.firebase|firebase-console-\w+\.corp|firebase\.corp)\.google\.com/,Dg="ls",Og="p",Ac="ac",Mg="websocket",Lg="long_polling";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fg{constructor(e,n,r,i,s=!1,o="",l=!1,a=!1,u=null){this.secure=n,this.namespace=r,this.webSocketOnly=i,this.nodeAdmin=s,this.persistenceKey=o,this.includeNamespaceInQueryParams=l,this.isUsingEmulator=a,this.emulatorOptions=u,this._host=e.toLowerCase(),this._domain=this._host.substr(this._host.indexOf(".")+1),this.internalHost=tr.get("host:"+e)||this._host}isCacheableHost(){return this.internalHost.substr(0,2)==="s-"}isCustomHost(){return this._domain!=="firebaseio.com"&&this._domain!=="firebaseio-demo.com"}get host(){return this._host}set host(e){e!==this.internalHost&&(this.internalHost=e,this.isCacheableHost()&&tr.set("host:"+this._host,this.internalHost))}toString(){let e=this.toURLString();return this.persistenceKey&&(e+="<"+this.persistenceKey+">"),e}toURLString(){const e=this.secure?"https://":"http://",n=this.includeNamespaceInQueryParams?`?ns=${this.namespace}`:"";return`${e}${this.host}/${n}`}}function Px(t){return t.host!==t.internalHost||t.isCustomHost()||t.includeNamespaceInQueryParams}function zg(t,e,n){A(typeof e=="string","typeof type must == string"),A(typeof n=="object","typeof params must == object");let r;if(e===Mg)r=(t.secure?"wss://":"ws://")+t.internalHost+"/.ws?";else if(e===Lg)r=(t.secure?"https://":"http://")+t.internalHost+"/.lp?";else throw new Error("Unknown connection type: "+e);Px(t)&&(n.ns=t.namespace);const i=[];return qe(n,(s,o)=>{i.push(s+"="+o)}),r+i.join("&")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rx{constructor(){this.counters_={}}incrementCounter(e,n=1){Bt(this.counters_,e)||(this.counters_[e]=0),this.counters_[e]+=n}get(){return N0(this.counters_)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wa={},Ca={};function qu(t){const e=t.toString();return wa[e]||(wa[e]=new Rx),wa[e]}function jx(t,e){const n=t.toString();return Ca[n]||(Ca[n]=e()),Ca[n]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ax{constructor(e){this.onMessage_=e,this.pendingResponses=[],this.currentResponseNum=0,this.closeAfterResponse=-1,this.onClose=null}closeAfter(e,n){this.closeAfterResponse=e,this.onClose=n,this.closeAfterResponse<this.currentResponseNum&&(this.onClose(),this.onClose=null)}handleResponse(e,n){for(this.pendingResponses[e]=n;this.pendingResponses[this.currentResponseNum];){const r=this.pendingResponses[this.currentResponseNum];delete this.pendingResponses[this.currentResponseNum];for(let i=0;i<r.length;++i)r[i]&&fi(()=>{this.onMessage_(r[i])});if(this.currentResponseNum===this.closeAfterResponse){this.onClose&&(this.onClose(),this.onClose=null);break}this.currentResponseNum++}}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const oh="start",Dx="close",Ox="pLPCommand",Mx="pRTLPCB",Bg="id",Wg="pw",$g="ser",Lx="cb",Fx="seg",zx="ts",Bx="d",Wx="dframe",Ug=1870,Hg=30,$x=Ug-Hg,Ux=25e3,Hx=3e4;class Fr{constructor(e,n,r,i,s,o,l){this.connId=e,this.repoInfo=n,this.applicationId=r,this.appCheckToken=i,this.authToken=s,this.transportSessionId=o,this.lastSessionId=l,this.bytesSent=0,this.bytesReceived=0,this.everConnected_=!1,this.log_=bs(e),this.stats_=qu(n),this.urlFn=a=>(this.appCheckToken&&(a[Ac]=this.appCheckToken),zg(n,Lg,a))}open(e,n){this.curSegmentNum=0,this.onDisconnect_=n,this.myPacketOrderer=new Ax(e),this.isClosed_=!1,this.connectTimeoutTimer_=setTimeout(()=>{this.log_("Timed out trying to connect."),this.onClosed_(),this.connectTimeoutTimer_=null},Math.floor(Hx)),_x(()=>{if(this.isClosed_)return;this.scriptTagHolder=new Xu((...s)=>{const[o,l,a,u,h]=s;if(this.incrementIncomingBytes_(s),!!this.scriptTagHolder)if(this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null),this.everConnected_=!0,o===oh)this.id=l,this.password=a;else if(o===Dx)l?(this.scriptTagHolder.sendNewPolls=!1,this.myPacketOrderer.closeAfter(l,()=>{this.onClosed_()})):this.onClosed_();else throw new Error("Unrecognized command received: "+o)},(...s)=>{const[o,l]=s;this.incrementIncomingBytes_(s),this.myPacketOrderer.handleResponse(o,l)},()=>{this.onClosed_()},this.urlFn);const r={};r[oh]="t",r[$g]=Math.floor(Math.random()*1e8),this.scriptTagHolder.uniqueCallbackIdentifier&&(r[Lx]=this.scriptTagHolder.uniqueCallbackIdentifier),r[bg]=Yu,this.transportSessionId&&(r[Pg]=this.transportSessionId),this.lastSessionId&&(r[Dg]=this.lastSessionId),this.applicationId&&(r[Og]=this.applicationId),this.appCheckToken&&(r[Ac]=this.appCheckToken),typeof location<"u"&&location.hostname&&Ag.test(location.hostname)&&(r[Rg]=jg);const i=this.urlFn(r);this.log_("Connecting via long-poll to "+i),this.scriptTagHolder.addTag(i,()=>{})})}start(){this.scriptTagHolder.startLongPoll(this.id,this.password),this.addDisconnectPingFrame(this.id,this.password)}static forceAllow(){Fr.forceAllow_=!0}static forceDisallow(){Fr.forceDisallow_=!0}static isAvailable(){return Fr.forceAllow_?!0:!Fr.forceDisallow_&&typeof document<"u"&&document.createElement!=null&&!Sx()&&!wx()}markConnectionHealthy(){}shutdown_(){this.isClosed_=!0,this.scriptTagHolder&&(this.scriptTagHolder.close(),this.scriptTagHolder=null),this.myDisconnFrame&&(document.body.removeChild(this.myDisconnFrame),this.myDisconnFrame=null),this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null)}onClosed_(){this.isClosed_||(this.log_("Longpoll is closing itself"),this.shutdown_(),this.onDisconnect_&&(this.onDisconnect_(this.everConnected_),this.onDisconnect_=null))}close(){this.isClosed_||(this.log_("Longpoll is being closed."),this.shutdown_())}send(e){const n=ze(e);this.bytesSent+=n.length,this.stats_.incrementCounter("bytes_sent",n.length);const r=ug(n),i=Ng(r,$x);for(let s=0;s<i.length;s++)this.scriptTagHolder.enqueueSegment(this.curSegmentNum,i.length,i[s]),this.curSegmentNum++}addDisconnectPingFrame(e,n){this.myDisconnFrame=document.createElement("iframe");const r={};r[Wx]="t",r[Bg]=e,r[Wg]=n,this.myDisconnFrame.src=this.urlFn(r),this.myDisconnFrame.style.display="none",document.body.appendChild(this.myDisconnFrame)}incrementIncomingBytes_(e){const n=ze(e).length;this.bytesReceived+=n,this.stats_.incrementCounter("bytes_received",n)}}class Xu{constructor(e,n,r,i){this.onDisconnect=r,this.urlFn=i,this.outstandingRequests=new Set,this.pendingSegs=[],this.currentSerial=Math.floor(Math.random()*1e8),this.sendNewPolls=!0;{this.uniqueCallbackIdentifier=Eg(),window[Ox+this.uniqueCallbackIdentifier]=e,window[Mx+this.uniqueCallbackIdentifier]=n,this.myIFrame=Xu.createIFrame_();let s="";this.myIFrame.src&&this.myIFrame.src.substr(0,11)==="javascript:"&&(s='<script>document.domain="'+document.domain+'";<\/script>');const o="<html><body>"+s+"</body></html>";try{this.myIFrame.doc.open(),this.myIFrame.doc.write(o),this.myIFrame.doc.close()}catch(l){Qe("frame writing exception"),l.stack&&Qe(l.stack),Qe(l)}}}static createIFrame_(){const e=document.createElement("iframe");if(e.style.display="none",document.body){document.body.appendChild(e);try{e.contentWindow.document||Qe("No IE domain setting required")}catch{const r=document.domain;e.src="javascript:void((function(){document.open();document.domain='"+r+"';document.close();})())"}}else throw"Document body has not initialized. Wait to initialize Firebase until after the document is ready.";return e.contentDocument?e.doc=e.contentDocument:e.contentWindow?e.doc=e.contentWindow.document:e.document&&(e.doc=e.document),e}close(){this.alive=!1,this.myIFrame&&(this.myIFrame.doc.body.textContent="",setTimeout(()=>{this.myIFrame!==null&&(document.body.removeChild(this.myIFrame),this.myIFrame=null)},Math.floor(0)));const e=this.onDisconnect;e&&(this.onDisconnect=null,e())}startLongPoll(e,n){for(this.myID=e,this.myPW=n,this.alive=!0;this.newRequest_(););}newRequest_(){if(this.alive&&this.sendNewPolls&&this.outstandingRequests.size<(this.pendingSegs.length>0?2:1)){this.currentSerial++;const e={};e[Bg]=this.myID,e[Wg]=this.myPW,e[$g]=this.currentSerial;let n=this.urlFn(e),r="",i=0;for(;this.pendingSegs.length>0&&this.pendingSegs[0].d.length+Hg+r.length<=Ug;){const o=this.pendingSegs.shift();r=r+"&"+Fx+i+"="+o.seg+"&"+zx+i+"="+o.ts+"&"+Bx+i+"="+o.d,i++}return n=n+r,this.addLongPollTag_(n,this.currentSerial),!0}else return!1}enqueueSegment(e,n,r){this.pendingSegs.push({seg:e,ts:n,d:r}),this.alive&&this.newRequest_()}addLongPollTag_(e,n){this.outstandingRequests.add(n);const r=()=>{this.outstandingRequests.delete(n),this.newRequest_()},i=setTimeout(r,Math.floor(Ux)),s=()=>{clearTimeout(i),r()};this.addTag(e,s)}addTag(e,n){setTimeout(()=>{try{if(!this.sendNewPolls)return;const r=this.myIFrame.doc.createElement("script");r.type="text/javascript",r.async=!0,r.src=e,r.onload=r.onreadystatechange=function(){const i=r.readyState;(!i||i==="loaded"||i==="complete")&&(r.onload=r.onreadystatechange=null,r.parentNode&&r.parentNode.removeChild(r),n())},r.onerror=()=>{Qe("Long-poll script failed to load: "+e),this.sendNewPolls=!1,this.close()},this.myIFrame.doc.body.appendChild(r)}catch{}},Math.floor(1))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Vx=16384,Gx=45e3;let Qo=null;typeof MozWebSocket<"u"?Qo=MozWebSocket:typeof WebSocket<"u"&&(Qo=WebSocket);class At{constructor(e,n,r,i,s,o,l){this.connId=e,this.applicationId=r,this.appCheckToken=i,this.authToken=s,this.keepaliveTimer=null,this.frames=null,this.totalFrames=0,this.bytesSent=0,this.bytesReceived=0,this.log_=bs(this.connId),this.stats_=qu(n),this.connURL=At.connectionURL_(n,o,l,i,r),this.nodeAdmin=n.nodeAdmin}static connectionURL_(e,n,r,i,s){const o={};return o[bg]=Yu,typeof location<"u"&&location.hostname&&Ag.test(location.hostname)&&(o[Rg]=jg),n&&(o[Pg]=n),r&&(o[Dg]=r),i&&(o[Ac]=i),s&&(o[Og]=s),zg(e,Mg,o)}open(e,n){this.onDisconnect=n,this.onMessage=e,this.log_("Websocket connecting to "+this.connURL),this.everConnected_=!1,tr.set("previous_websocket_failure",!0);try{let r;$0(),this.mySock=new Qo(this.connURL,[],r)}catch(r){this.log_("Error instantiating WebSocket.");const i=r.message||r.data;i&&this.log_(i),this.onClosed_();return}this.mySock.onopen=()=>{this.log_("Websocket connected."),this.everConnected_=!0},this.mySock.onclose=()=>{this.log_("Websocket connection was disconnected."),this.mySock=null,this.onClosed_()},this.mySock.onmessage=r=>{this.handleIncomingFrame(r)},this.mySock.onerror=r=>{this.log_("WebSocket error.  Closing connection.");const i=r.message||r.data;i&&this.log_(i),this.onClosed_()}}start(){}static forceDisallow(){At.forceDisallow_=!0}static isAvailable(){let e=!1;if(typeof navigator<"u"&&navigator.userAgent){const n=/Android ([0-9]{0,}\.[0-9]{0,})/,r=navigator.userAgent.match(n);r&&r.length>1&&parseFloat(r[1])<4.4&&(e=!0)}return!e&&Qo!==null&&!At.forceDisallow_}static previouslyFailed(){return tr.isInMemoryStorage||tr.get("previous_websocket_failure")===!0}markConnectionHealthy(){tr.remove("previous_websocket_failure")}appendFrame_(e){if(this.frames.push(e),this.frames.length===this.totalFrames){const n=this.frames.join("");this.frames=null;const r=cs(n);this.onMessage(r)}}handleNewFrameCount_(e){this.totalFrames=e,this.frames=[]}extractFrameCount_(e){if(A(this.frames===null,"We already have a frame buffer"),e.length<=6){const n=Number(e);if(!isNaN(n))return this.handleNewFrameCount_(n),null}return this.handleNewFrameCount_(1),e}handleIncomingFrame(e){if(this.mySock===null)return;const n=e.data;if(this.bytesReceived+=n.length,this.stats_.incrementCounter("bytes_received",n.length),this.resetKeepAlive(),this.frames!==null)this.appendFrame_(n);else{const r=this.extractFrameCount_(n);r!==null&&this.appendFrame_(r)}}send(e){this.resetKeepAlive();const n=ze(e);this.bytesSent+=n.length,this.stats_.incrementCounter("bytes_sent",n.length);const r=Ng(n,Vx);r.length>1&&this.sendString_(String(r.length));for(let i=0;i<r.length;i++)this.sendString_(r[i])}shutdown_(){this.isClosed_=!0,this.keepaliveTimer&&(clearInterval(this.keepaliveTimer),this.keepaliveTimer=null),this.mySock&&(this.mySock.close(),this.mySock=null)}onClosed_(){this.isClosed_||(this.log_("WebSocket is closing itself"),this.shutdown_(),this.onDisconnect&&(this.onDisconnect(this.everConnected_),this.onDisconnect=null))}close(){this.isClosed_||(this.log_("WebSocket is being closed"),this.shutdown_())}resetKeepAlive(){clearInterval(this.keepaliveTimer),this.keepaliveTimer=setInterval(()=>{this.mySock&&this.sendString_("0"),this.resetKeepAlive()},Math.floor(Gx))}sendString_(e){try{this.mySock.send(e)}catch(n){this.log_("Exception thrown from WebSocket.send():",n.message||n.data,"Closing connection."),setTimeout(this.onClosed_.bind(this),0)}}}At.responsesRequiredToBeHealthy=2;At.healthyTimeout=3e4;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hs{static get ALL_TRANSPORTS(){return[Fr,At]}static get IS_TRANSPORT_INITIALIZED(){return this.globalTransportInitialized_}constructor(e){this.initTransports_(e)}initTransports_(e){const n=At&&At.isAvailable();let r=n&&!At.previouslyFailed();if(e.webSocketOnly&&(n||ot("wss:// URL used, but browser isn't known to support websockets.  Trying anyway."),r=!0),r)this.transports_=[At];else{const i=this.transports_=[];for(const s of hs.ALL_TRANSPORTS)s&&s.isAvailable()&&i.push(s);hs.globalTransportInitialized_=!0}}initialTransport(){if(this.transports_.length>0)return this.transports_[0];throw new Error("No transports available")}upgradeTransport(){return this.transports_.length>1?this.transports_[1]:null}}hs.globalTransportInitialized_=!1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Qx=6e4,Kx=5e3,Yx=10*1024,qx=100*1024,ka="t",lh="d",Xx="s",ah="r",Zx="e",ch="o",uh="a",dh="n",fh="p",Jx="h";class eS{constructor(e,n,r,i,s,o,l,a,u,h){this.id=e,this.repoInfo_=n,this.applicationId_=r,this.appCheckToken_=i,this.authToken_=s,this.onMessage_=o,this.onReady_=l,this.onDisconnect_=a,this.onKill_=u,this.lastSessionId=h,this.connectionCount=0,this.pendingDataMessages=[],this.state_=0,this.log_=bs("c:"+this.id+":"),this.transportManager_=new hs(n),this.log_("Connection created"),this.start_()}start_(){const e=this.transportManager_.initialTransport();this.conn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,null,this.lastSessionId),this.primaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;const n=this.connReceiver_(this.conn_),r=this.disconnReceiver_(this.conn_);this.tx_=this.conn_,this.rx_=this.conn_,this.secondaryConn_=null,this.isHealthy_=!1,setTimeout(()=>{this.conn_&&this.conn_.open(n,r)},Math.floor(0));const i=e.healthyTimeout||0;i>0&&(this.healthyTimeout_=$i(()=>{this.healthyTimeout_=null,this.isHealthy_||(this.conn_&&this.conn_.bytesReceived>qx?(this.log_("Connection exceeded healthy timeout but has received "+this.conn_.bytesReceived+" bytes.  Marking connection healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()):this.conn_&&this.conn_.bytesSent>Yx?this.log_("Connection exceeded healthy timeout but has sent "+this.conn_.bytesSent+" bytes.  Leaving connection alive."):(this.log_("Closing unhealthy connection after timeout."),this.close()))},Math.floor(i)))}nextTransportId_(){return"c:"+this.id+":"+this.connectionCount++}disconnReceiver_(e){return n=>{e===this.conn_?this.onConnectionLost_(n):e===this.secondaryConn_?(this.log_("Secondary connection lost."),this.onSecondaryConnectionLost_()):this.log_("closing an old connection")}}connReceiver_(e){return n=>{this.state_!==2&&(e===this.rx_?this.onPrimaryMessageReceived_(n):e===this.secondaryConn_?this.onSecondaryMessageReceived_(n):this.log_("message on old connection"))}}sendRequest(e){const n={t:"d",d:e};this.sendData_(n)}tryCleanupConnection(){this.tx_===this.secondaryConn_&&this.rx_===this.secondaryConn_&&(this.log_("cleaning up and promoting a connection: "+this.secondaryConn_.connId),this.conn_=this.secondaryConn_,this.secondaryConn_=null)}onSecondaryControl_(e){if(ka in e){const n=e[ka];n===uh?this.upgradeIfSecondaryHealthy_():n===ah?(this.log_("Got a reset on secondary, closing it"),this.secondaryConn_.close(),(this.tx_===this.secondaryConn_||this.rx_===this.secondaryConn_)&&this.close()):n===ch&&(this.log_("got pong on secondary."),this.secondaryResponsesRequired_--,this.upgradeIfSecondaryHealthy_())}}onSecondaryMessageReceived_(e){const n=Ci("t",e),r=Ci("d",e);if(n==="c")this.onSecondaryControl_(r);else if(n==="d")this.pendingDataMessages.push(r);else throw new Error("Unknown protocol layer: "+n)}upgradeIfSecondaryHealthy_(){this.secondaryResponsesRequired_<=0?(this.log_("Secondary connection is healthy."),this.isHealthy_=!0,this.secondaryConn_.markConnectionHealthy(),this.proceedWithUpgrade_()):(this.log_("sending ping on secondary."),this.secondaryConn_.send({t:"c",d:{t:fh,d:{}}}))}proceedWithUpgrade_(){this.secondaryConn_.start(),this.log_("sending client ack on secondary"),this.secondaryConn_.send({t:"c",d:{t:uh,d:{}}}),this.log_("Ending transmission on primary"),this.conn_.send({t:"c",d:{t:dh,d:{}}}),this.tx_=this.secondaryConn_,this.tryCleanupConnection()}onPrimaryMessageReceived_(e){const n=Ci("t",e),r=Ci("d",e);n==="c"?this.onControl_(r):n==="d"&&this.onDataMessage_(r)}onDataMessage_(e){this.onPrimaryResponse_(),this.onMessage_(e)}onPrimaryResponse_(){this.isHealthy_||(this.primaryResponsesRequired_--,this.primaryResponsesRequired_<=0&&(this.log_("Primary connection is healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()))}onControl_(e){const n=Ci(ka,e);if(lh in e){const r=e[lh];if(n===Jx){const i=Object.assign({},r);this.repoInfo_.isUsingEmulator&&(i.h=this.repoInfo_.host),this.onHandshake_(i)}else if(n===dh){this.log_("recvd end transmission on primary"),this.rx_=this.secondaryConn_;for(let i=0;i<this.pendingDataMessages.length;++i)this.onDataMessage_(this.pendingDataMessages[i]);this.pendingDataMessages=[],this.tryCleanupConnection()}else n===Xx?this.onConnectionShutdown_(r):n===ah?this.onReset_(r):n===Zx?jc("Server Error: "+r):n===ch?(this.log_("got pong on primary."),this.onPrimaryResponse_(),this.sendPingOnPrimaryIfNecessary_()):jc("Unknown control packet command: "+n)}}onHandshake_(e){const n=e.ts,r=e.v,i=e.h;this.sessionId=e.s,this.repoInfo_.host=i,this.state_===0&&(this.conn_.start(),this.onConnectionEstablished_(this.conn_,n),Yu!==r&&ot("Protocol version mismatch detected"),this.tryStartUpgrade_())}tryStartUpgrade_(){const e=this.transportManager_.upgradeTransport();e&&this.startUpgrade_(e)}startUpgrade_(e){this.secondaryConn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,this.sessionId),this.secondaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;const n=this.connReceiver_(this.secondaryConn_),r=this.disconnReceiver_(this.secondaryConn_);this.secondaryConn_.open(n,r),$i(()=>{this.secondaryConn_&&(this.log_("Timed out trying to upgrade."),this.secondaryConn_.close())},Math.floor(Qx))}onReset_(e){this.log_("Reset packet received.  New host: "+e),this.repoInfo_.host=e,this.state_===1?this.close():(this.closeConnections_(),this.start_())}onConnectionEstablished_(e,n){this.log_("Realtime connection established."),this.conn_=e,this.state_=1,this.onReady_&&(this.onReady_(n,this.sessionId),this.onReady_=null),this.primaryResponsesRequired_===0?(this.log_("Primary connection is healthy."),this.isHealthy_=!0):$i(()=>{this.sendPingOnPrimaryIfNecessary_()},Math.floor(Kx))}sendPingOnPrimaryIfNecessary_(){!this.isHealthy_&&this.state_===1&&(this.log_("sending ping on primary."),this.sendData_({t:"c",d:{t:fh,d:{}}}))}onSecondaryConnectionLost_(){const e=this.secondaryConn_;this.secondaryConn_=null,(this.tx_===e||this.rx_===e)&&this.close()}onConnectionLost_(e){this.conn_=null,!e&&this.state_===0?(this.log_("Realtime connection failed."),this.repoInfo_.isCacheableHost()&&(tr.remove("host:"+this.repoInfo_.host),this.repoInfo_.internalHost=this.repoInfo_.host)):this.state_===1&&this.log_("Realtime connection lost."),this.close()}onConnectionShutdown_(e){this.log_("Connection shutdown command received. Shutting down..."),this.onKill_&&(this.onKill_(e),this.onKill_=null),this.onDisconnect_=null,this.close()}sendData_(e){if(this.state_!==1)throw"Connection is not connected";this.tx_.send(e)}close(){this.state_!==2&&(this.log_("Closing realtime connection."),this.state_=2,this.closeConnections_(),this.onDisconnect_&&(this.onDisconnect_(),this.onDisconnect_=null))}closeConnections_(){this.log_("Shutting down all connections"),this.conn_&&(this.conn_.close(),this.conn_=null),this.secondaryConn_&&(this.secondaryConn_.close(),this.secondaryConn_=null),this.healthyTimeout_&&(clearTimeout(this.healthyTimeout_),this.healthyTimeout_=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vg{put(e,n,r,i){}merge(e,n,r,i){}refreshAuthToken(e){}refreshAppCheckToken(e){}onDisconnectPut(e,n,r){}onDisconnectMerge(e,n,r){}onDisconnectCancel(e,n){}reportStats(e){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gg{constructor(e){this.allowedEvents_=e,this.listeners_={},A(Array.isArray(e)&&e.length>0,"Requires a non-empty array")}trigger(e,...n){if(Array.isArray(this.listeners_[e])){const r=[...this.listeners_[e]];for(let i=0;i<r.length;i++)r[i].callback.apply(r[i].context,n)}}on(e,n,r){this.validateEventType_(e),this.listeners_[e]=this.listeners_[e]||[],this.listeners_[e].push({callback:n,context:r});const i=this.getInitialEvent(e);i&&n.apply(r,i)}off(e,n,r){this.validateEventType_(e);const i=this.listeners_[e]||[];for(let s=0;s<i.length;s++)if(i[s].callback===n&&(!r||r===i[s].context)){i.splice(s,1);return}}validateEventType_(e){A(this.allowedEvents_.find(n=>n===e),"Unknown event: "+e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ko extends Gg{static getInstance(){return new Ko}constructor(){super(["online"]),this.online_=!0,typeof window<"u"&&typeof window.addEventListener<"u"&&!pg()&&(window.addEventListener("online",()=>{this.online_||(this.online_=!0,this.trigger("online",!0))},!1),window.addEventListener("offline",()=>{this.online_&&(this.online_=!1,this.trigger("online",!1))},!1))}getInitialEvent(e){return A(e==="online","Unknown event type: "+e),[this.online_]}currentlyOnline(){return this.online_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hh=32,ph=768;class he{constructor(e,n){if(n===void 0){this.pieces_=e.split("/");let r=0;for(let i=0;i<this.pieces_.length;i++)this.pieces_[i].length>0&&(this.pieces_[r]=this.pieces_[i],r++);this.pieces_.length=r,this.pieceNum_=0}else this.pieces_=e,this.pieceNum_=n}toString(){let e="";for(let n=this.pieceNum_;n<this.pieces_.length;n++)this.pieces_[n]!==""&&(e+="/"+this.pieces_[n]);return e||"/"}}function ae(){return new he("")}function ee(t){return t.pieceNum_>=t.pieces_.length?null:t.pieces_[t.pieceNum_]}function Fn(t){return t.pieces_.length-t.pieceNum_}function ve(t){let e=t.pieceNum_;return e<t.pieces_.length&&e++,new he(t.pieces_,e)}function Zu(t){return t.pieceNum_<t.pieces_.length?t.pieces_[t.pieces_.length-1]:null}function tS(t){let e="";for(let n=t.pieceNum_;n<t.pieces_.length;n++)t.pieces_[n]!==""&&(e+="/"+encodeURIComponent(String(t.pieces_[n])));return e||"/"}function ps(t,e=0){return t.pieces_.slice(t.pieceNum_+e)}function Qg(t){if(t.pieceNum_>=t.pieces_.length)return null;const e=[];for(let n=t.pieceNum_;n<t.pieces_.length-1;n++)e.push(t.pieces_[n]);return new he(e,0)}function Ae(t,e){const n=[];for(let r=t.pieceNum_;r<t.pieces_.length;r++)n.push(t.pieces_[r]);if(e instanceof he)for(let r=e.pieceNum_;r<e.pieces_.length;r++)n.push(e.pieces_[r]);else{const r=e.split("/");for(let i=0;i<r.length;i++)r[i].length>0&&n.push(r[i])}return new he(n,0)}function te(t){return t.pieceNum_>=t.pieces_.length}function it(t,e){const n=ee(t),r=ee(e);if(n===null)return e;if(n===r)return it(ve(t),ve(e));throw new Error("INTERNAL ERROR: innerPath ("+e+") is not within outerPath ("+t+")")}function nS(t,e){const n=ps(t,0),r=ps(e,0);for(let i=0;i<n.length&&i<r.length;i++){const s=yr(n[i],r[i]);if(s!==0)return s}return n.length===r.length?0:n.length<r.length?-1:1}function Ju(t,e){if(Fn(t)!==Fn(e))return!1;for(let n=t.pieceNum_,r=e.pieceNum_;n<=t.pieces_.length;n++,r++)if(t.pieces_[n]!==e.pieces_[r])return!1;return!0}function Et(t,e){let n=t.pieceNum_,r=e.pieceNum_;if(Fn(t)>Fn(e))return!1;for(;n<t.pieces_.length;){if(t.pieces_[n]!==e.pieces_[r])return!1;++n,++r}return!0}class rS{constructor(e,n){this.errorPrefix_=n,this.parts_=ps(e,0),this.byteLength_=Math.max(1,this.parts_.length);for(let r=0;r<this.parts_.length;r++)this.byteLength_+=kl(this.parts_[r]);Kg(this)}}function iS(t,e){t.parts_.length>0&&(t.byteLength_+=1),t.parts_.push(e),t.byteLength_+=kl(e),Kg(t)}function sS(t){const e=t.parts_.pop();t.byteLength_-=kl(e),t.parts_.length>0&&(t.byteLength_-=1)}function Kg(t){if(t.byteLength_>ph)throw new Error(t.errorPrefix_+"has a key path longer than "+ph+" bytes ("+t.byteLength_+").");if(t.parts_.length>hh)throw new Error(t.errorPrefix_+"path specified exceeds the maximum depth that can be written ("+hh+") or object contains a cycle "+Yn(t))}function Yn(t){return t.parts_.length===0?"":"in property '"+t.parts_.join(".")+"'"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ed extends Gg{static getInstance(){return new ed}constructor(){super(["visible"]);let e,n;typeof document<"u"&&typeof document.addEventListener<"u"&&(typeof document.hidden<"u"?(n="visibilitychange",e="hidden"):typeof document.mozHidden<"u"?(n="mozvisibilitychange",e="mozHidden"):typeof document.msHidden<"u"?(n="msvisibilitychange",e="msHidden"):typeof document.webkitHidden<"u"&&(n="webkitvisibilitychange",e="webkitHidden")),this.visible_=!0,n&&document.addEventListener(n,()=>{const r=!document[e];r!==this.visible_&&(this.visible_=r,this.trigger("visible",r))},!1)}getInitialEvent(e){return A(e==="visible","Unknown event type: "+e),[this.visible_]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ki=1e3,oS=60*5*1e3,mh=30*1e3,lS=1.3,aS=3e4,cS="server_kill",gh=3;class tn extends Vg{constructor(e,n,r,i,s,o,l,a){if(super(),this.repoInfo_=e,this.applicationId_=n,this.onDataUpdate_=r,this.onConnectStatus_=i,this.onServerInfoUpdate_=s,this.authTokenProvider_=o,this.appCheckTokenProvider_=l,this.authOverride_=a,this.id=tn.nextPersistentConnectionId_++,this.log_=bs("p:"+this.id+":"),this.interruptReasons_={},this.listens=new Map,this.outstandingPuts_=[],this.outstandingGets_=[],this.outstandingPutCount_=0,this.outstandingGetCount_=0,this.onDisconnectRequestQueue_=[],this.connected_=!1,this.reconnectDelay_=ki,this.maxReconnectDelay_=oS,this.securityDebugCallback_=null,this.lastSessionId=null,this.establishConnectionTimer_=null,this.visible_=!1,this.requestCBHash_={},this.requestNumber_=0,this.realtime_=null,this.authToken_=null,this.appCheckToken_=null,this.forceTokenRefresh_=!1,this.invalidAuthTokenCount_=0,this.invalidAppCheckTokenCount_=0,this.firstConnection_=!0,this.lastConnectionAttemptTime_=null,this.lastConnectionEstablishedTime_=null,a)throw new Error("Auth override specified in options, but not supported on non Node.js platforms");ed.getInstance().on("visible",this.onVisible_,this),e.host.indexOf("fblocal")===-1&&Ko.getInstance().on("online",this.onOnline_,this)}sendRequest(e,n,r){const i=++this.requestNumber_,s={r:i,a:e,b:n};this.log_(ze(s)),A(this.connected_,"sendRequest call when we're not connected not allowed."),this.realtime_.sendRequest(s),r&&(this.requestCBHash_[i]=r)}get(e){this.initConnection_();const n=new di,i={action:"g",request:{p:e._path.toString(),q:e._queryObject},onComplete:o=>{const l=o.d;o.s==="ok"?n.resolve(l):n.reject(l)}};this.outstandingGets_.push(i),this.outstandingGetCount_++;const s=this.outstandingGets_.length-1;return this.connected_&&this.sendGet_(s),n.promise}listen(e,n,r,i){this.initConnection_();const s=e._queryIdentifier,o=e._path.toString();this.log_("Listen called for "+o+" "+s),this.listens.has(o)||this.listens.set(o,new Map),A(e._queryParams.isDefault()||!e._queryParams.loadsAllData(),"listen() called for non-default but complete query"),A(!this.listens.get(o).has(s),"listen() called twice for same path/queryId.");const l={onComplete:i,hashFn:n,query:e,tag:r};this.listens.get(o).set(s,l),this.connected_&&this.sendListen_(l)}sendGet_(e){const n=this.outstandingGets_[e];this.sendRequest("g",n.request,r=>{delete this.outstandingGets_[e],this.outstandingGetCount_--,this.outstandingGetCount_===0&&(this.outstandingGets_=[]),n.onComplete&&n.onComplete(r)})}sendListen_(e){const n=e.query,r=n._path.toString(),i=n._queryIdentifier;this.log_("Listen on "+r+" for "+i);const s={p:r},o="q";e.tag&&(s.q=n._queryObject,s.t=e.tag),s.h=e.hashFn(),this.sendRequest(o,s,l=>{const a=l.d,u=l.s;tn.warnOnListenWarnings_(a,n),(this.listens.get(r)&&this.listens.get(r).get(i))===e&&(this.log_("listen response",l),u!=="ok"&&this.removeListen_(r,i),e.onComplete&&e.onComplete(u,a))})}static warnOnListenWarnings_(e,n){if(e&&typeof e=="object"&&Bt(e,"w")){const r=ur(e,"w");if(Array.isArray(r)&&~r.indexOf("no_index")){const i='".indexOn": "'+n._queryParams.getIndex().toString()+'"',s=n._path.toString();ot(`Using an unspecified index. Your data will be downloaded and filtered on the client. Consider adding ${i} at ${s} to your security rules for better performance.`)}}}refreshAuthToken(e){this.authToken_=e,this.log_("Auth token refreshed"),this.authToken_?this.tryAuth():this.connected_&&this.sendRequest("unauth",{},()=>{}),this.reduceReconnectDelayIfAdminCredential_(e)}reduceReconnectDelayIfAdminCredential_(e){(e&&e.length===40||Y0(e))&&(this.log_("Admin auth credential detected.  Reducing max reconnect time."),this.maxReconnectDelay_=mh)}refreshAppCheckToken(e){this.appCheckToken_=e,this.log_("App check token refreshed"),this.appCheckToken_?this.tryAppCheck():this.connected_&&this.sendRequest("unappeck",{},()=>{})}tryAuth(){if(this.connected_&&this.authToken_){const e=this.authToken_,n=K0(e)?"auth":"gauth",r={cred:e};this.authOverride_===null?r.noauth=!0:typeof this.authOverride_=="object"&&(r.authvar=this.authOverride_),this.sendRequest(n,r,i=>{const s=i.s,o=i.d||"error";this.authToken_===e&&(s==="ok"?this.invalidAuthTokenCount_=0:this.onAuthRevoked_(s,o))})}}tryAppCheck(){this.connected_&&this.appCheckToken_&&this.sendRequest("appcheck",{token:this.appCheckToken_},e=>{const n=e.s,r=e.d||"error";n==="ok"?this.invalidAppCheckTokenCount_=0:this.onAppCheckRevoked_(n,r)})}unlisten(e,n){const r=e._path.toString(),i=e._queryIdentifier;this.log_("Unlisten called for "+r+" "+i),A(e._queryParams.isDefault()||!e._queryParams.loadsAllData(),"unlisten() called for non-default but complete query"),this.removeListen_(r,i)&&this.connected_&&this.sendUnlisten_(r,i,e._queryObject,n)}sendUnlisten_(e,n,r,i){this.log_("Unlisten on "+e+" for "+n);const s={p:e},o="n";i&&(s.q=r,s.t=i),this.sendRequest(o,s)}onDisconnectPut(e,n,r){this.initConnection_(),this.connected_?this.sendOnDisconnect_("o",e,n,r):this.onDisconnectRequestQueue_.push({pathString:e,action:"o",data:n,onComplete:r})}onDisconnectMerge(e,n,r){this.initConnection_(),this.connected_?this.sendOnDisconnect_("om",e,n,r):this.onDisconnectRequestQueue_.push({pathString:e,action:"om",data:n,onComplete:r})}onDisconnectCancel(e,n){this.initConnection_(),this.connected_?this.sendOnDisconnect_("oc",e,null,n):this.onDisconnectRequestQueue_.push({pathString:e,action:"oc",data:null,onComplete:n})}sendOnDisconnect_(e,n,r,i){const s={p:n,d:r};this.log_("onDisconnect "+e,s),this.sendRequest(e,s,o=>{i&&setTimeout(()=>{i(o.s,o.d)},Math.floor(0))})}put(e,n,r,i){this.putInternal("p",e,n,r,i)}merge(e,n,r,i){this.putInternal("m",e,n,r,i)}putInternal(e,n,r,i,s){this.initConnection_();const o={p:n,d:r};s!==void 0&&(o.h=s),this.outstandingPuts_.push({action:e,request:o,onComplete:i}),this.outstandingPutCount_++;const l=this.outstandingPuts_.length-1;this.connected_?this.sendPut_(l):this.log_("Buffering put: "+n)}sendPut_(e){const n=this.outstandingPuts_[e].action,r=this.outstandingPuts_[e].request,i=this.outstandingPuts_[e].onComplete;this.outstandingPuts_[e].queued=this.connected_,this.sendRequest(n,r,s=>{this.log_(n+" response",s),delete this.outstandingPuts_[e],this.outstandingPutCount_--,this.outstandingPutCount_===0&&(this.outstandingPuts_=[]),i&&i(s.s,s.d)})}reportStats(e){if(this.connected_){const n={c:e};this.log_("reportStats",n),this.sendRequest("s",n,r=>{if(r.s!=="ok"){const s=r.d;this.log_("reportStats","Error sending stats: "+s)}})}}onDataMessage_(e){if("r"in e){this.log_("from server: "+ze(e));const n=e.r,r=this.requestCBHash_[n];r&&(delete this.requestCBHash_[n],r(e.b))}else{if("error"in e)throw"A server-side error has occurred: "+e.error;"a"in e&&this.onDataPush_(e.a,e.b)}}onDataPush_(e,n){this.log_("handleServerMessage",e,n),e==="d"?this.onDataUpdate_(n.p,n.d,!1,n.t):e==="m"?this.onDataUpdate_(n.p,n.d,!0,n.t):e==="c"?this.onListenRevoked_(n.p,n.q):e==="ac"?this.onAuthRevoked_(n.s,n.d):e==="apc"?this.onAppCheckRevoked_(n.s,n.d):e==="sd"?this.onSecurityDebugPacket_(n):jc("Unrecognized action received from server: "+ze(e)+`
Are you using the latest client?`)}onReady_(e,n){this.log_("connection ready"),this.connected_=!0,this.lastConnectionEstablishedTime_=new Date().getTime(),this.handleTimestamp_(e),this.lastSessionId=n,this.firstConnection_&&this.sendConnectStats_(),this.restoreState_(),this.firstConnection_=!1,this.onConnectStatus_(!0)}scheduleConnect_(e){A(!this.realtime_,"Scheduling a connect when we're already connected/ing?"),this.establishConnectionTimer_&&clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=setTimeout(()=>{this.establishConnectionTimer_=null,this.establishConnection_()},Math.floor(e))}initConnection_(){!this.realtime_&&this.firstConnection_&&this.scheduleConnect_(0)}onVisible_(e){e&&!this.visible_&&this.reconnectDelay_===this.maxReconnectDelay_&&(this.log_("Window became visible.  Reducing delay."),this.reconnectDelay_=ki,this.realtime_||this.scheduleConnect_(0)),this.visible_=e}onOnline_(e){e?(this.log_("Browser went online."),this.reconnectDelay_=ki,this.realtime_||this.scheduleConnect_(0)):(this.log_("Browser went offline.  Killing connection."),this.realtime_&&this.realtime_.close())}onRealtimeDisconnect_(){if(this.log_("data client disconnected"),this.connected_=!1,this.realtime_=null,this.cancelSentTransactions_(),this.requestCBHash_={},this.shouldReconnect_()){this.visible_?this.lastConnectionEstablishedTime_&&(new Date().getTime()-this.lastConnectionEstablishedTime_>aS&&(this.reconnectDelay_=ki),this.lastConnectionEstablishedTime_=null):(this.log_("Window isn't visible.  Delaying reconnect."),this.reconnectDelay_=this.maxReconnectDelay_,this.lastConnectionAttemptTime_=new Date().getTime());const e=Math.max(0,new Date().getTime()-this.lastConnectionAttemptTime_);let n=Math.max(0,this.reconnectDelay_-e);n=Math.random()*n,this.log_("Trying to reconnect in "+n+"ms"),this.scheduleConnect_(n),this.reconnectDelay_=Math.min(this.maxReconnectDelay_,this.reconnectDelay_*lS)}this.onConnectStatus_(!1)}async establishConnection_(){if(this.shouldReconnect_()){this.log_("Making a connection attempt"),this.lastConnectionAttemptTime_=new Date().getTime(),this.lastConnectionEstablishedTime_=null;const e=this.onDataMessage_.bind(this),n=this.onReady_.bind(this),r=this.onRealtimeDisconnect_.bind(this),i=this.id+":"+tn.nextConnectionId_++,s=this.lastSessionId;let o=!1,l=null;const a=function(){l?l.close():(o=!0,r())},u=function(f){A(l,"sendRequest call when we're not connected not allowed."),l.sendRequest(f)};this.realtime_={close:a,sendRequest:u};const h=this.forceTokenRefresh_;this.forceTokenRefresh_=!1;try{const[f,d]=await Promise.all([this.authTokenProvider_.getToken(h),this.appCheckTokenProvider_.getToken(h)]);o?Qe("getToken() completed but was canceled"):(Qe("getToken() completed. Creating connection."),this.authToken_=f&&f.accessToken,this.appCheckToken_=d&&d.token,l=new eS(i,this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,e,n,r,v=>{ot(v+" ("+this.repoInfo_.toString()+")"),this.interrupt(cS)},s))}catch(f){this.log_("Failed to get token: "+f),o||(this.repoInfo_.nodeAdmin&&ot(f),a())}}}interrupt(e){Qe("Interrupting connection for reason: "+e),this.interruptReasons_[e]=!0,this.realtime_?this.realtime_.close():(this.establishConnectionTimer_&&(clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=null),this.connected_&&this.onRealtimeDisconnect_())}resume(e){Qe("Resuming connection for reason: "+e),delete this.interruptReasons_[e],Hf(this.interruptReasons_)&&(this.reconnectDelay_=ki,this.realtime_||this.scheduleConnect_(0))}handleTimestamp_(e){const n=e-new Date().getTime();this.onServerInfoUpdate_({serverTimeOffset:n})}cancelSentTransactions_(){for(let e=0;e<this.outstandingPuts_.length;e++){const n=this.outstandingPuts_[e];n&&"h"in n.request&&n.queued&&(n.onComplete&&n.onComplete("disconnect"),delete this.outstandingPuts_[e],this.outstandingPutCount_--)}this.outstandingPutCount_===0&&(this.outstandingPuts_=[])}onListenRevoked_(e,n){let r;n?r=n.map(s=>Ku(s)).join("$"):r="default";const i=this.removeListen_(e,r);i&&i.onComplete&&i.onComplete("permission_denied")}removeListen_(e,n){const r=new he(e).toString();let i;if(this.listens.has(r)){const s=this.listens.get(r);i=s.get(n),s.delete(n),s.size===0&&this.listens.delete(r)}else i=void 0;return i}onAuthRevoked_(e,n){Qe("Auth token revoked: "+e+"/"+n),this.authToken_=null,this.forceTokenRefresh_=!0,this.realtime_.close(),(e==="invalid_token"||e==="permission_denied")&&(this.invalidAuthTokenCount_++,this.invalidAuthTokenCount_>=gh&&(this.reconnectDelay_=mh,this.authTokenProvider_.notifyForInvalidToken()))}onAppCheckRevoked_(e,n){Qe("App check token revoked: "+e+"/"+n),this.appCheckToken_=null,this.forceTokenRefresh_=!0,(e==="invalid_token"||e==="permission_denied")&&(this.invalidAppCheckTokenCount_++,this.invalidAppCheckTokenCount_>=gh&&this.appCheckTokenProvider_.notifyForInvalidToken())}onSecurityDebugPacket_(e){this.securityDebugCallback_?this.securityDebugCallback_(e):"msg"in e&&console.log("FIREBASE: "+e.msg.replace(`
`,`
FIREBASE: `))}restoreState_(){this.tryAuth(),this.tryAppCheck();for(const e of this.listens.values())for(const n of e.values())this.sendListen_(n);for(let e=0;e<this.outstandingPuts_.length;e++)this.outstandingPuts_[e]&&this.sendPut_(e);for(;this.onDisconnectRequestQueue_.length;){const e=this.onDisconnectRequestQueue_.shift();this.sendOnDisconnect_(e.action,e.pathString,e.data,e.onComplete)}for(let e=0;e<this.outstandingGets_.length;e++)this.outstandingGets_[e]&&this.sendGet_(e)}sendConnectStats_(){const e={};let n="js";e["sdk."+n+"."+Cg.replace(/\./g,"-")]=1,pg()?e["framework.cordova"]=1:W0()&&(e["framework.reactnative"]=1),this.reportStats(e)}shouldReconnect_(){const e=Ko.getInstance().currentlyOnline();return Hf(this.interruptReasons_)&&e}}tn.nextPersistentConnectionId_=0;tn.nextConnectionId_=0;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ne{constructor(e,n){this.name=e,this.node=n}static Wrap(e,n){return new ne(e,n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class El{getCompare(){return this.compare.bind(this)}indexedValueChanged(e,n){const r=new ne(dr,e),i=new ne(dr,n);return this.compare(r,i)!==0}minPost(){return ne.MIN}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let eo;class Yg extends El{static get __EMPTY_NODE(){return eo}static set __EMPTY_NODE(e){eo=e}compare(e,n){return yr(e.name,n.name)}isDefinedOn(e){throw ui("KeyIndex.isDefinedOn not expected to be called.")}indexedValueChanged(e,n){return!1}minPost(){return ne.MIN}maxPost(){return new ne(Ln,eo)}makePost(e,n){return A(typeof e=="string","KeyIndex indexValue must always be a string."),new ne(e,eo)}toString(){return".key"}}const ir=new Yg;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class to{constructor(e,n,r,i,s=null){this.isReverse_=i,this.resultGenerator_=s,this.nodeStack_=[];let o=1;for(;!e.isEmpty();)if(e=e,o=n?r(e.key,n):1,i&&(o*=-1),o<0)this.isReverse_?e=e.left:e=e.right;else if(o===0){this.nodeStack_.push(e);break}else this.nodeStack_.push(e),this.isReverse_?e=e.right:e=e.left}getNext(){if(this.nodeStack_.length===0)return null;let e=this.nodeStack_.pop(),n;if(this.resultGenerator_?n=this.resultGenerator_(e.key,e.value):n={key:e.key,value:e.value},this.isReverse_)for(e=e.left;!e.isEmpty();)this.nodeStack_.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack_.push(e),e=e.left;return n}hasNext(){return this.nodeStack_.length>0}peek(){if(this.nodeStack_.length===0)return null;const e=this.nodeStack_[this.nodeStack_.length-1];return this.resultGenerator_?this.resultGenerator_(e.key,e.value):{key:e.key,value:e.value}}}class Ue{constructor(e,n,r,i,s){this.key=e,this.value=n,this.color=r??Ue.RED,this.left=i??dt.EMPTY_NODE,this.right=s??dt.EMPTY_NODE}copy(e,n,r,i,s){return new Ue(e??this.key,n??this.value,r??this.color,i??this.left,s??this.right)}count(){return this.left.count()+1+this.right.count()}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||!!e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min_(){return this.left.isEmpty()?this:this.left.min_()}minKey(){return this.min_().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,n,r){let i=this;const s=r(e,i.key);return s<0?i=i.copy(null,null,null,i.left.insert(e,n,r),null):s===0?i=i.copy(null,n,null,null,null):i=i.copy(null,null,null,null,i.right.insert(e,n,r)),i.fixUp_()}removeMin_(){if(this.left.isEmpty())return dt.EMPTY_NODE;let e=this;return!e.left.isRed_()&&!e.left.left.isRed_()&&(e=e.moveRedLeft_()),e=e.copy(null,null,null,e.left.removeMin_(),null),e.fixUp_()}remove(e,n){let r,i;if(r=this,n(e,r.key)<0)!r.left.isEmpty()&&!r.left.isRed_()&&!r.left.left.isRed_()&&(r=r.moveRedLeft_()),r=r.copy(null,null,null,r.left.remove(e,n),null);else{if(r.left.isRed_()&&(r=r.rotateRight_()),!r.right.isEmpty()&&!r.right.isRed_()&&!r.right.left.isRed_()&&(r=r.moveRedRight_()),n(e,r.key)===0){if(r.right.isEmpty())return dt.EMPTY_NODE;i=r.right.min_(),r=r.copy(i.key,i.value,null,null,r.right.removeMin_())}r=r.copy(null,null,null,null,r.right.remove(e,n))}return r.fixUp_()}isRed_(){return this.color}fixUp_(){let e=this;return e.right.isRed_()&&!e.left.isRed_()&&(e=e.rotateLeft_()),e.left.isRed_()&&e.left.left.isRed_()&&(e=e.rotateRight_()),e.left.isRed_()&&e.right.isRed_()&&(e=e.colorFlip_()),e}moveRedLeft_(){let e=this.colorFlip_();return e.right.left.isRed_()&&(e=e.copy(null,null,null,null,e.right.rotateRight_()),e=e.rotateLeft_(),e=e.colorFlip_()),e}moveRedRight_(){let e=this.colorFlip_();return e.left.left.isRed_()&&(e=e.rotateRight_(),e=e.colorFlip_()),e}rotateLeft_(){const e=this.copy(null,null,Ue.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight_(){const e=this.copy(null,null,Ue.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip_(){const e=this.left.copy(null,null,!this.left.color,null,null),n=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,n)}checkMaxDepth_(){const e=this.check_();return Math.pow(2,e)<=this.count()+1}check_(){if(this.isRed_()&&this.left.isRed_())throw new Error("Red node has red child("+this.key+","+this.value+")");if(this.right.isRed_())throw new Error("Right child of ("+this.key+","+this.value+") is red");const e=this.left.check_();if(e!==this.right.check_())throw new Error("Black depths differ");return e+(this.isRed_()?0:1)}}Ue.RED=!0;Ue.BLACK=!1;class uS{copy(e,n,r,i,s){return this}insert(e,n,r){return new Ue(e,n,null)}remove(e,n){return this}count(){return 0}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}check_(){return 0}isRed_(){return!1}}class dt{constructor(e,n=dt.EMPTY_NODE){this.comparator_=e,this.root_=n}insert(e,n){return new dt(this.comparator_,this.root_.insert(e,n,this.comparator_).copy(null,null,Ue.BLACK,null,null))}remove(e){return new dt(this.comparator_,this.root_.remove(e,this.comparator_).copy(null,null,Ue.BLACK,null,null))}get(e){let n,r=this.root_;for(;!r.isEmpty();){if(n=this.comparator_(e,r.key),n===0)return r.value;n<0?r=r.left:n>0&&(r=r.right)}return null}getPredecessorKey(e){let n,r=this.root_,i=null;for(;!r.isEmpty();)if(n=this.comparator_(e,r.key),n===0){if(r.left.isEmpty())return i?i.key:null;for(r=r.left;!r.right.isEmpty();)r=r.right;return r.key}else n<0?r=r.left:n>0&&(i=r,r=r.right);throw new Error("Attempted to find predecessor key for a nonexistent key.  What gives?")}isEmpty(){return this.root_.isEmpty()}count(){return this.root_.count()}minKey(){return this.root_.minKey()}maxKey(){return this.root_.maxKey()}inorderTraversal(e){return this.root_.inorderTraversal(e)}reverseTraversal(e){return this.root_.reverseTraversal(e)}getIterator(e){return new to(this.root_,null,this.comparator_,!1,e)}getIteratorFrom(e,n){return new to(this.root_,e,this.comparator_,!1,n)}getReverseIteratorFrom(e,n){return new to(this.root_,e,this.comparator_,!0,n)}getReverseIterator(e){return new to(this.root_,null,this.comparator_,!0,e)}}dt.EMPTY_NODE=new uS;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function dS(t,e){return yr(t.name,e.name)}function td(t,e){return yr(t,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Dc;function fS(t){Dc=t}const qg=function(t){return typeof t=="number"?"number:"+Ig(t):"string:"+t},Xg=function(t){if(t.isLeafNode()){const e=t.val();A(typeof e=="string"||typeof e=="number"||typeof e=="object"&&Bt(e,".sv"),"Priority must be a string or number.")}else A(t===Dc||t.isEmpty(),"priority of unexpected type.");A(t===Dc||t.getPriority().isEmpty(),"Priority nodes can't have a priority of their own.")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let yh;class We{static set __childrenNodeConstructor(e){yh=e}static get __childrenNodeConstructor(){return yh}constructor(e,n=We.__childrenNodeConstructor.EMPTY_NODE){this.value_=e,this.priorityNode_=n,this.lazyHash_=null,A(this.value_!==void 0&&this.value_!==null,"LeafNode shouldn't be created with null/undefined value."),Xg(this.priorityNode_)}isLeafNode(){return!0}getPriority(){return this.priorityNode_}updatePriority(e){return new We(this.value_,e)}getImmediateChild(e){return e===".priority"?this.priorityNode_:We.__childrenNodeConstructor.EMPTY_NODE}getChild(e){return te(e)?this:ee(e)===".priority"?this.priorityNode_:We.__childrenNodeConstructor.EMPTY_NODE}hasChild(){return!1}getPredecessorChildName(e,n){return null}updateImmediateChild(e,n){return e===".priority"?this.updatePriority(n):n.isEmpty()&&e!==".priority"?this:We.__childrenNodeConstructor.EMPTY_NODE.updateImmediateChild(e,n).updatePriority(this.priorityNode_)}updateChild(e,n){const r=ee(e);return r===null?n:n.isEmpty()&&r!==".priority"?this:(A(r!==".priority"||Fn(e)===1,".priority must be the last token in a path"),this.updateImmediateChild(r,We.__childrenNodeConstructor.EMPTY_NODE.updateChild(ve(e),n)))}isEmpty(){return!1}numChildren(){return 0}forEachChild(e,n){return!1}val(e){return e&&!this.getPriority().isEmpty()?{".value":this.getValue(),".priority":this.getPriority().val()}:this.getValue()}hash(){if(this.lazyHash_===null){let e="";this.priorityNode_.isEmpty()||(e+="priority:"+qg(this.priorityNode_.val())+":");const n=typeof this.value_;e+=n+":",n==="number"?e+=Ig(this.value_):e+=this.value_,this.lazyHash_=Tg(e)}return this.lazyHash_}getValue(){return this.value_}compareTo(e){return e===We.__childrenNodeConstructor.EMPTY_NODE?1:e instanceof We.__childrenNodeConstructor?-1:(A(e.isLeafNode(),"Unknown node type"),this.compareToLeafNode_(e))}compareToLeafNode_(e){const n=typeof e.value_,r=typeof this.value_,i=We.VALUE_TYPE_ORDER.indexOf(n),s=We.VALUE_TYPE_ORDER.indexOf(r);return A(i>=0,"Unknown leaf type: "+n),A(s>=0,"Unknown leaf type: "+r),i===s?r==="object"?0:this.value_<e.value_?-1:this.value_===e.value_?0:1:s-i}withIndex(){return this}isIndexed(){return!0}equals(e){if(e===this)return!0;if(e.isLeafNode()){const n=e;return this.value_===n.value_&&this.priorityNode_.equals(n.priorityNode_)}else return!1}}We.VALUE_TYPE_ORDER=["object","boolean","number","string"];/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Zg,Jg;function hS(t){Zg=t}function pS(t){Jg=t}class mS extends El{compare(e,n){const r=e.node.getPriority(),i=n.node.getPriority(),s=r.compareTo(i);return s===0?yr(e.name,n.name):s}isDefinedOn(e){return!e.getPriority().isEmpty()}indexedValueChanged(e,n){return!e.getPriority().equals(n.getPriority())}minPost(){return ne.MIN}maxPost(){return new ne(Ln,new We("[PRIORITY-POST]",Jg))}makePost(e,n){const r=Zg(e);return new ne(n,new We("[PRIORITY-POST]",r))}toString(){return".priority"}}const ke=new mS;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gS=Math.log(2);class yS{constructor(e){const n=s=>parseInt(Math.log(s)/gS,10),r=s=>parseInt(Array(s+1).join("1"),2);this.count=n(e+1),this.current_=this.count-1;const i=r(this.count);this.bits_=e+1&i}nextBitIsOne(){const e=!(this.bits_&1<<this.current_);return this.current_--,e}}const Yo=function(t,e,n,r){t.sort(e);const i=function(a,u){const h=u-a;let f,d;if(h===0)return null;if(h===1)return f=t[a],d=n?n(f):f,new Ue(d,f.node,Ue.BLACK,null,null);{const v=parseInt(h/2,10)+a,x=i(a,v),g=i(v+1,u);return f=t[v],d=n?n(f):f,new Ue(d,f.node,Ue.BLACK,x,g)}},s=function(a){let u=null,h=null,f=t.length;const d=function(x,g){const E=f-x,y=f;f-=x;const p=i(E+1,y),m=t[E],_=n?n(m):m;v(new Ue(_,m.node,g,null,p))},v=function(x){u?(u.left=x,u=x):(h=x,u=x)};for(let x=0;x<a.count;++x){const g=a.nextBitIsOne(),E=Math.pow(2,a.count-(x+1));g?d(E,Ue.BLACK):(d(E,Ue.BLACK),d(E,Ue.RED))}return h},o=new yS(t.length),l=s(o);return new dt(r||e,l)};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Ea;const kr={};class Jt{static get Default(){return A(kr&&ke,"ChildrenNode.ts has not been loaded"),Ea=Ea||new Jt({".priority":kr},{".priority":ke}),Ea}constructor(e,n){this.indexes_=e,this.indexSet_=n}get(e){const n=ur(this.indexes_,e);if(!n)throw new Error("No index defined for "+e);return n instanceof dt?n:null}hasIndex(e){return Bt(this.indexSet_,e.toString())}addIndex(e,n){A(e!==ir,"KeyIndex always exists and isn't meant to be added to the IndexMap.");const r=[];let i=!1;const s=n.getIterator(ne.Wrap);let o=s.getNext();for(;o;)i=i||e.isDefinedOn(o.node),r.push(o),o=s.getNext();let l;i?l=Yo(r,e.getCompare()):l=kr;const a=e.toString(),u=Object.assign({},this.indexSet_);u[a]=e;const h=Object.assign({},this.indexes_);return h[a]=l,new Jt(h,u)}addToIndexes(e,n){const r=Ho(this.indexes_,(i,s)=>{const o=ur(this.indexSet_,s);if(A(o,"Missing index implementation for "+s),i===kr)if(o.isDefinedOn(e.node)){const l=[],a=n.getIterator(ne.Wrap);let u=a.getNext();for(;u;)u.name!==e.name&&l.push(u),u=a.getNext();return l.push(e),Yo(l,o.getCompare())}else return kr;else{const l=n.get(e.name);let a=i;return l&&(a=a.remove(new ne(e.name,l))),a.insert(e,e.node)}});return new Jt(r,this.indexSet_)}removeFromIndexes(e,n){const r=Ho(this.indexes_,i=>{if(i===kr)return i;{const s=n.get(e.name);return s?i.remove(new ne(e.name,s)):i}});return new Jt(r,this.indexSet_)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Ei;class K{static get EMPTY_NODE(){return Ei||(Ei=new K(new dt(td),null,Jt.Default))}constructor(e,n,r){this.children_=e,this.priorityNode_=n,this.indexMap_=r,this.lazyHash_=null,this.priorityNode_&&Xg(this.priorityNode_),this.children_.isEmpty()&&A(!this.priorityNode_||this.priorityNode_.isEmpty(),"An empty node cannot have a priority")}isLeafNode(){return!1}getPriority(){return this.priorityNode_||Ei}updatePriority(e){return this.children_.isEmpty()?this:new K(this.children_,e,this.indexMap_)}getImmediateChild(e){if(e===".priority")return this.getPriority();{const n=this.children_.get(e);return n===null?Ei:n}}getChild(e){const n=ee(e);return n===null?this:this.getImmediateChild(n).getChild(ve(e))}hasChild(e){return this.children_.get(e)!==null}updateImmediateChild(e,n){if(A(n,"We should always be passing snapshot nodes"),e===".priority")return this.updatePriority(n);{const r=new ne(e,n);let i,s;n.isEmpty()?(i=this.children_.remove(e),s=this.indexMap_.removeFromIndexes(r,this.children_)):(i=this.children_.insert(e,n),s=this.indexMap_.addToIndexes(r,this.children_));const o=i.isEmpty()?Ei:this.priorityNode_;return new K(i,o,s)}}updateChild(e,n){const r=ee(e);if(r===null)return n;{A(ee(e)!==".priority"||Fn(e)===1,".priority must be the last token in a path");const i=this.getImmediateChild(r).updateChild(ve(e),n);return this.updateImmediateChild(r,i)}}isEmpty(){return this.children_.isEmpty()}numChildren(){return this.children_.count()}val(e){if(this.isEmpty())return null;const n={};let r=0,i=0,s=!0;if(this.forEachChild(ke,(o,l)=>{n[o]=l.val(e),r++,s&&K.INTEGER_REGEXP_.test(o)?i=Math.max(i,Number(o)):s=!1}),!e&&s&&i<2*r){const o=[];for(const l in n)o[l]=n[l];return o}else return e&&!this.getPriority().isEmpty()&&(n[".priority"]=this.getPriority().val()),n}hash(){if(this.lazyHash_===null){let e="";this.getPriority().isEmpty()||(e+="priority:"+qg(this.getPriority().val())+":"),this.forEachChild(ke,(n,r)=>{const i=r.hash();i!==""&&(e+=":"+n+":"+i)}),this.lazyHash_=e===""?"":Tg(e)}return this.lazyHash_}getPredecessorChildName(e,n,r){const i=this.resolveIndex_(r);if(i){const s=i.getPredecessorKey(new ne(e,n));return s?s.name:null}else return this.children_.getPredecessorKey(e)}getFirstChildName(e){const n=this.resolveIndex_(e);if(n){const r=n.minKey();return r&&r.name}else return this.children_.minKey()}getFirstChild(e){const n=this.getFirstChildName(e);return n?new ne(n,this.children_.get(n)):null}getLastChildName(e){const n=this.resolveIndex_(e);if(n){const r=n.maxKey();return r&&r.name}else return this.children_.maxKey()}getLastChild(e){const n=this.getLastChildName(e);return n?new ne(n,this.children_.get(n)):null}forEachChild(e,n){const r=this.resolveIndex_(e);return r?r.inorderTraversal(i=>n(i.name,i.node)):this.children_.inorderTraversal(n)}getIterator(e){return this.getIteratorFrom(e.minPost(),e)}getIteratorFrom(e,n){const r=this.resolveIndex_(n);if(r)return r.getIteratorFrom(e,i=>i);{const i=this.children_.getIteratorFrom(e.name,ne.Wrap);let s=i.peek();for(;s!=null&&n.compare(s,e)<0;)i.getNext(),s=i.peek();return i}}getReverseIterator(e){return this.getReverseIteratorFrom(e.maxPost(),e)}getReverseIteratorFrom(e,n){const r=this.resolveIndex_(n);if(r)return r.getReverseIteratorFrom(e,i=>i);{const i=this.children_.getReverseIteratorFrom(e.name,ne.Wrap);let s=i.peek();for(;s!=null&&n.compare(s,e)>0;)i.getNext(),s=i.peek();return i}}compareTo(e){return this.isEmpty()?e.isEmpty()?0:-1:e.isLeafNode()||e.isEmpty()?1:e===Ps?-1:0}withIndex(e){if(e===ir||this.indexMap_.hasIndex(e))return this;{const n=this.indexMap_.addIndex(e,this.children_);return new K(this.children_,this.priorityNode_,n)}}isIndexed(e){return e===ir||this.indexMap_.hasIndex(e)}equals(e){if(e===this)return!0;if(e.isLeafNode())return!1;{const n=e;if(this.getPriority().equals(n.getPriority()))if(this.children_.count()===n.children_.count()){const r=this.getIterator(ke),i=n.getIterator(ke);let s=r.getNext(),o=i.getNext();for(;s&&o;){if(s.name!==o.name||!s.node.equals(o.node))return!1;s=r.getNext(),o=i.getNext()}return s===null&&o===null}else return!1;else return!1}}resolveIndex_(e){return e===ir?null:this.indexMap_.get(e.toString())}}K.INTEGER_REGEXP_=/^(0|[1-9]\d*)$/;class vS extends K{constructor(){super(new dt(td),K.EMPTY_NODE,Jt.Default)}compareTo(e){return e===this?0:1}equals(e){return e===this}getPriority(){return this}getImmediateChild(e){return K.EMPTY_NODE}isEmpty(){return!1}}const Ps=new vS;Object.defineProperties(ne,{MIN:{value:new ne(dr,K.EMPTY_NODE)},MAX:{value:new ne(Ln,Ps)}});Yg.__EMPTY_NODE=K.EMPTY_NODE;We.__childrenNodeConstructor=K;fS(Ps);pS(Ps);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _S=!0;function Me(t,e=null){if(t===null)return K.EMPTY_NODE;if(typeof t=="object"&&".priority"in t&&(e=t[".priority"]),A(e===null||typeof e=="string"||typeof e=="number"||typeof e=="object"&&".sv"in e,"Invalid priority type found: "+typeof e),typeof t=="object"&&".value"in t&&t[".value"]!==null&&(t=t[".value"]),typeof t!="object"||".sv"in t){const n=t;return new We(n,Me(e))}if(!(t instanceof Array)&&_S){const n=[];let r=!1;if(qe(t,(o,l)=>{if(o.substring(0,1)!=="."){const a=Me(l);a.isEmpty()||(r=r||!a.getPriority().isEmpty(),n.push(new ne(o,a)))}}),n.length===0)return K.EMPTY_NODE;const s=Yo(n,dS,o=>o.name,td);if(r){const o=Yo(n,ke.getCompare());return new K(s,Me(e),new Jt({".priority":o},{".priority":ke}))}else return new K(s,Me(e),Jt.Default)}else{let n=K.EMPTY_NODE;return qe(t,(r,i)=>{if(Bt(t,r)&&r.substring(0,1)!=="."){const s=Me(i);(s.isLeafNode()||!s.isEmpty())&&(n=n.updateImmediateChild(r,s))}}),n.updatePriority(Me(e))}}hS(Me);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nd extends El{constructor(e){super(),this.indexPath_=e,A(!te(e)&&ee(e)!==".priority","Can't create PathIndex with empty path or .priority key")}extractChild(e){return e.getChild(this.indexPath_)}isDefinedOn(e){return!e.getChild(this.indexPath_).isEmpty()}compare(e,n){const r=this.extractChild(e.node),i=this.extractChild(n.node),s=r.compareTo(i);return s===0?yr(e.name,n.name):s}makePost(e,n){const r=Me(e),i=K.EMPTY_NODE.updateChild(this.indexPath_,r);return new ne(n,i)}maxPost(){const e=K.EMPTY_NODE.updateChild(this.indexPath_,Ps);return new ne(Ln,e)}toString(){return ps(this.indexPath_,0).join("/")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xS extends El{compare(e,n){const r=e.node.compareTo(n.node);return r===0?yr(e.name,n.name):r}isDefinedOn(e){return!0}indexedValueChanged(e,n){return!e.equals(n)}minPost(){return ne.MIN}maxPost(){return ne.MAX}makePost(e,n){const r=Me(e);return new ne(n,r)}toString(){return".value"}}const ey=new xS;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ty(t){return{type:"value",snapshotNode:t}}function ti(t,e){return{type:"child_added",snapshotNode:e,childName:t}}function ms(t,e){return{type:"child_removed",snapshotNode:e,childName:t}}function gs(t,e,n){return{type:"child_changed",snapshotNode:e,childName:t,oldSnap:n}}function SS(t,e){return{type:"child_moved",snapshotNode:e,childName:t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rd{constructor(e){this.index_=e}updateChild(e,n,r,i,s,o){A(e.isIndexed(this.index_),"A node must be indexed if only a child is updated");const l=e.getImmediateChild(n);return l.getChild(i).equals(r.getChild(i))&&l.isEmpty()===r.isEmpty()||(o!=null&&(r.isEmpty()?e.hasChild(n)?o.trackChildChange(ms(n,l)):A(e.isLeafNode(),"A child remove without an old child only makes sense on a leaf node"):l.isEmpty()?o.trackChildChange(ti(n,r)):o.trackChildChange(gs(n,r,l))),e.isLeafNode()&&r.isEmpty())?e:e.updateImmediateChild(n,r).withIndex(this.index_)}updateFullNode(e,n,r){return r!=null&&(e.isLeafNode()||e.forEachChild(ke,(i,s)=>{n.hasChild(i)||r.trackChildChange(ms(i,s))}),n.isLeafNode()||n.forEachChild(ke,(i,s)=>{if(e.hasChild(i)){const o=e.getImmediateChild(i);o.equals(s)||r.trackChildChange(gs(i,s,o))}else r.trackChildChange(ti(i,s))})),n.withIndex(this.index_)}updatePriority(e,n){return e.isEmpty()?K.EMPTY_NODE:e.updatePriority(n)}filtersNodes(){return!1}getIndexedFilter(){return this}getIndex(){return this.index_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ys{constructor(e){this.indexedFilter_=new rd(e.getIndex()),this.index_=e.getIndex(),this.startPost_=ys.getStartPost_(e),this.endPost_=ys.getEndPost_(e),this.startIsInclusive_=!e.startAfterSet_,this.endIsInclusive_=!e.endBeforeSet_}getStartPost(){return this.startPost_}getEndPost(){return this.endPost_}matches(e){const n=this.startIsInclusive_?this.index_.compare(this.getStartPost(),e)<=0:this.index_.compare(this.getStartPost(),e)<0,r=this.endIsInclusive_?this.index_.compare(e,this.getEndPost())<=0:this.index_.compare(e,this.getEndPost())<0;return n&&r}updateChild(e,n,r,i,s,o){return this.matches(new ne(n,r))||(r=K.EMPTY_NODE),this.indexedFilter_.updateChild(e,n,r,i,s,o)}updateFullNode(e,n,r){n.isLeafNode()&&(n=K.EMPTY_NODE);let i=n.withIndex(this.index_);i=i.updatePriority(K.EMPTY_NODE);const s=this;return n.forEachChild(ke,(o,l)=>{s.matches(new ne(o,l))||(i=i.updateImmediateChild(o,K.EMPTY_NODE))}),this.indexedFilter_.updateFullNode(e,i,r)}updatePriority(e,n){return e}filtersNodes(){return!0}getIndexedFilter(){return this.indexedFilter_}getIndex(){return this.index_}static getStartPost_(e){if(e.hasStart()){const n=e.getIndexStartName();return e.getIndex().makePost(e.getIndexStartValue(),n)}else return e.getIndex().minPost()}static getEndPost_(e){if(e.hasEnd()){const n=e.getIndexEndName();return e.getIndex().makePost(e.getIndexEndValue(),n)}else return e.getIndex().maxPost()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wS{constructor(e){this.withinDirectionalStart=n=>this.reverse_?this.withinEndPost(n):this.withinStartPost(n),this.withinDirectionalEnd=n=>this.reverse_?this.withinStartPost(n):this.withinEndPost(n),this.withinStartPost=n=>{const r=this.index_.compare(this.rangedFilter_.getStartPost(),n);return this.startIsInclusive_?r<=0:r<0},this.withinEndPost=n=>{const r=this.index_.compare(n,this.rangedFilter_.getEndPost());return this.endIsInclusive_?r<=0:r<0},this.rangedFilter_=new ys(e),this.index_=e.getIndex(),this.limit_=e.getLimit(),this.reverse_=!e.isViewFromLeft(),this.startIsInclusive_=!e.startAfterSet_,this.endIsInclusive_=!e.endBeforeSet_}updateChild(e,n,r,i,s,o){return this.rangedFilter_.matches(new ne(n,r))||(r=K.EMPTY_NODE),e.getImmediateChild(n).equals(r)?e:e.numChildren()<this.limit_?this.rangedFilter_.getIndexedFilter().updateChild(e,n,r,i,s,o):this.fullLimitUpdateChild_(e,n,r,s,o)}updateFullNode(e,n,r){let i;if(n.isLeafNode()||n.isEmpty())i=K.EMPTY_NODE.withIndex(this.index_);else if(this.limit_*2<n.numChildren()&&n.isIndexed(this.index_)){i=K.EMPTY_NODE.withIndex(this.index_);let s;this.reverse_?s=n.getReverseIteratorFrom(this.rangedFilter_.getEndPost(),this.index_):s=n.getIteratorFrom(this.rangedFilter_.getStartPost(),this.index_);let o=0;for(;s.hasNext()&&o<this.limit_;){const l=s.getNext();if(this.withinDirectionalStart(l))if(this.withinDirectionalEnd(l))i=i.updateImmediateChild(l.name,l.node),o++;else break;else continue}}else{i=n.withIndex(this.index_),i=i.updatePriority(K.EMPTY_NODE);let s;this.reverse_?s=i.getReverseIterator(this.index_):s=i.getIterator(this.index_);let o=0;for(;s.hasNext();){const l=s.getNext();o<this.limit_&&this.withinDirectionalStart(l)&&this.withinDirectionalEnd(l)?o++:i=i.updateImmediateChild(l.name,K.EMPTY_NODE)}}return this.rangedFilter_.getIndexedFilter().updateFullNode(e,i,r)}updatePriority(e,n){return e}filtersNodes(){return!0}getIndexedFilter(){return this.rangedFilter_.getIndexedFilter()}getIndex(){return this.index_}fullLimitUpdateChild_(e,n,r,i,s){let o;if(this.reverse_){const f=this.index_.getCompare();o=(d,v)=>f(v,d)}else o=this.index_.getCompare();const l=e;A(l.numChildren()===this.limit_,"");const a=new ne(n,r),u=this.reverse_?l.getFirstChild(this.index_):l.getLastChild(this.index_),h=this.rangedFilter_.matches(a);if(l.hasChild(n)){const f=l.getImmediateChild(n);let d=i.getChildAfterChild(this.index_,u,this.reverse_);for(;d!=null&&(d.name===n||l.hasChild(d.name));)d=i.getChildAfterChild(this.index_,d,this.reverse_);const v=d==null?1:o(d,a);if(h&&!r.isEmpty()&&v>=0)return s!=null&&s.trackChildChange(gs(n,r,f)),l.updateImmediateChild(n,r);{s!=null&&s.trackChildChange(ms(n,f));const g=l.updateImmediateChild(n,K.EMPTY_NODE);return d!=null&&this.rangedFilter_.matches(d)?(s!=null&&s.trackChildChange(ti(d.name,d.node)),g.updateImmediateChild(d.name,d.node)):g}}else return r.isEmpty()?e:h&&o(u,a)>=0?(s!=null&&(s.trackChildChange(ms(u.name,u.node)),s.trackChildChange(ti(n,r))),l.updateImmediateChild(n,r).updateImmediateChild(u.name,K.EMPTY_NODE)):e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class id{constructor(){this.limitSet_=!1,this.startSet_=!1,this.startNameSet_=!1,this.startAfterSet_=!1,this.endSet_=!1,this.endNameSet_=!1,this.endBeforeSet_=!1,this.limit_=0,this.viewFrom_="",this.indexStartValue_=null,this.indexStartName_="",this.indexEndValue_=null,this.indexEndName_="",this.index_=ke}hasStart(){return this.startSet_}isViewFromLeft(){return this.viewFrom_===""?this.startSet_:this.viewFrom_==="l"}getIndexStartValue(){return A(this.startSet_,"Only valid if start has been set"),this.indexStartValue_}getIndexStartName(){return A(this.startSet_,"Only valid if start has been set"),this.startNameSet_?this.indexStartName_:dr}hasEnd(){return this.endSet_}getIndexEndValue(){return A(this.endSet_,"Only valid if end has been set"),this.indexEndValue_}getIndexEndName(){return A(this.endSet_,"Only valid if end has been set"),this.endNameSet_?this.indexEndName_:Ln}hasLimit(){return this.limitSet_}hasAnchoredLimit(){return this.limitSet_&&this.viewFrom_!==""}getLimit(){return A(this.limitSet_,"Only valid if limit has been set"),this.limit_}getIndex(){return this.index_}loadsAllData(){return!(this.startSet_||this.endSet_||this.limitSet_)}isDefault(){return this.loadsAllData()&&this.index_===ke}copy(){const e=new id;return e.limitSet_=this.limitSet_,e.limit_=this.limit_,e.startSet_=this.startSet_,e.startAfterSet_=this.startAfterSet_,e.indexStartValue_=this.indexStartValue_,e.startNameSet_=this.startNameSet_,e.indexStartName_=this.indexStartName_,e.endSet_=this.endSet_,e.endBeforeSet_=this.endBeforeSet_,e.indexEndValue_=this.indexEndValue_,e.endNameSet_=this.endNameSet_,e.indexEndName_=this.indexEndName_,e.index_=this.index_,e.viewFrom_=this.viewFrom_,e}}function CS(t){return t.loadsAllData()?new rd(t.getIndex()):t.hasLimit()?new wS(t):new ys(t)}function kS(t,e){const n=t.copy();return n.limitSet_=!0,n.limit_=e,n.viewFrom_="r",n}function ES(t,e,n){const r=t.copy();return r.startSet_=!0,e===void 0&&(e=null),r.indexStartValue_=e,n!=null?(r.startNameSet_=!0,r.indexStartName_=n):(r.startNameSet_=!1,r.indexStartName_=""),r}function TS(t,e,n){const r=t.copy();return r.endSet_=!0,e===void 0&&(e=null),r.indexEndValue_=e,n!==void 0?(r.endNameSet_=!0,r.indexEndName_=n):(r.endNameSet_=!1,r.indexEndName_=""),r}function NS(t,e){const n=t.copy();return n.index_=e,n}function vh(t){const e={};if(t.isDefault())return e;let n;if(t.index_===ke?n="$priority":t.index_===ey?n="$value":t.index_===ir?n="$key":(A(t.index_ instanceof nd,"Unrecognized index type!"),n=t.index_.toString()),e.orderBy=ze(n),t.startSet_){const r=t.startAfterSet_?"startAfter":"startAt";e[r]=ze(t.indexStartValue_),t.startNameSet_&&(e[r]+=","+ze(t.indexStartName_))}if(t.endSet_){const r=t.endBeforeSet_?"endBefore":"endAt";e[r]=ze(t.indexEndValue_),t.endNameSet_&&(e[r]+=","+ze(t.indexEndName_))}return t.limitSet_&&(t.isViewFromLeft()?e.limitToFirst=t.limit_:e.limitToLast=t.limit_),e}function _h(t){const e={};if(t.startSet_&&(e.sp=t.indexStartValue_,t.startNameSet_&&(e.sn=t.indexStartName_),e.sin=!t.startAfterSet_),t.endSet_&&(e.ep=t.indexEndValue_,t.endNameSet_&&(e.en=t.indexEndName_),e.ein=!t.endBeforeSet_),t.limitSet_){e.l=t.limit_;let n=t.viewFrom_;n===""&&(t.isViewFromLeft()?n="l":n="r"),e.vf=n}return t.index_!==ke&&(e.i=t.index_.toString()),e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qo extends Vg{reportStats(e){throw new Error("Method not implemented.")}static getListenId_(e,n){return n!==void 0?"tag$"+n:(A(e._queryParams.isDefault(),"should have a tag if it's not a default query."),e._path.toString())}constructor(e,n,r,i){super(),this.repoInfo_=e,this.onDataUpdate_=n,this.authTokenProvider_=r,this.appCheckTokenProvider_=i,this.log_=bs("p:rest:"),this.listens_={}}listen(e,n,r,i){const s=e._path.toString();this.log_("Listen called for "+s+" "+e._queryIdentifier);const o=qo.getListenId_(e,r),l={};this.listens_[o]=l;const a=vh(e._queryParams);this.restRequest_(s+".json",a,(u,h)=>{let f=h;if(u===404&&(f=null,u=null),u===null&&this.onDataUpdate_(s,f,!1,r),ur(this.listens_,o)===l){let d;u?u===401?d="permission_denied":d="rest_error:"+u:d="ok",i(d,null)}})}unlisten(e,n){const r=qo.getListenId_(e,n);delete this.listens_[r]}get(e){const n=vh(e._queryParams),r=e._path.toString(),i=new di;return this.restRequest_(r+".json",n,(s,o)=>{let l=o;s===404&&(l=null,s=null),s===null?(this.onDataUpdate_(r,l,!1,null),i.resolve(l)):i.reject(new Error(l))}),i.promise}refreshAuthToken(e){}restRequest_(e,n={},r){return n.format="export",Promise.all([this.authTokenProvider_.getToken(!1),this.appCheckTokenProvider_.getToken(!1)]).then(([i,s])=>{i&&i.accessToken&&(n.auth=i.accessToken),s&&s.token&&(n.ac=s.token);const o=(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host+e+"?ns="+this.repoInfo_.namespace+q0(n);this.log_("Sending REST request for "+o);const l=new XMLHttpRequest;l.onreadystatechange=()=>{if(r&&l.readyState===4){this.log_("REST Response for "+o+" received. status:",l.status,"response:",l.responseText);let a=null;if(l.status>=200&&l.status<300){try{a=cs(l.responseText)}catch{ot("Failed to parse JSON response for "+o+": "+l.responseText)}r(null,a)}else l.status!==401&&l.status!==404&&ot("Got unsuccessful REST response for "+o+" Status: "+l.status),r(l.status);r=null}},l.open("GET",o,!0),l.send()})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class IS{constructor(){this.rootNode_=K.EMPTY_NODE}getNode(e){return this.rootNode_.getChild(e)}updateSnapshot(e,n){this.rootNode_=this.rootNode_.updateChild(e,n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Xo(){return{value:null,children:new Map}}function ny(t,e,n){if(te(e))t.value=n,t.children.clear();else if(t.value!==null)t.value=t.value.updateChild(e,n);else{const r=ee(e);t.children.has(r)||t.children.set(r,Xo());const i=t.children.get(r);e=ve(e),ny(i,e,n)}}function Oc(t,e,n){t.value!==null?n(e,t.value):bS(t,(r,i)=>{const s=new he(e.toString()+"/"+r);Oc(i,s,n)})}function bS(t,e){t.children.forEach((n,r)=>{e(r,n)})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class PS{constructor(e){this.collection_=e,this.last_=null}get(){const e=this.collection_.get(),n=Object.assign({},e);return this.last_&&qe(this.last_,(r,i)=>{n[r]=n[r]-i}),this.last_=e,n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xh=10*1e3,RS=30*1e3,jS=5*60*1e3;class AS{constructor(e,n){this.server_=n,this.statsToReport_={},this.statsListener_=new PS(e);const r=xh+(RS-xh)*Math.random();$i(this.reportStats_.bind(this),Math.floor(r))}reportStats_(){const e=this.statsListener_.get(),n={};let r=!1;qe(e,(i,s)=>{s>0&&Bt(this.statsToReport_,i)&&(n[i]=s,r=!0)}),r&&this.server_.reportStats(n),$i(this.reportStats_.bind(this),Math.floor(Math.random()*2*jS))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Dt;(function(t){t[t.OVERWRITE=0]="OVERWRITE",t[t.MERGE=1]="MERGE",t[t.ACK_USER_WRITE=2]="ACK_USER_WRITE",t[t.LISTEN_COMPLETE=3]="LISTEN_COMPLETE"})(Dt||(Dt={}));function sd(){return{fromUser:!0,fromServer:!1,queryId:null,tagged:!1}}function od(){return{fromUser:!1,fromServer:!0,queryId:null,tagged:!1}}function ld(t){return{fromUser:!1,fromServer:!0,queryId:t,tagged:!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zo{constructor(e,n,r){this.path=e,this.affectedTree=n,this.revert=r,this.type=Dt.ACK_USER_WRITE,this.source=sd()}operationForChild(e){if(te(this.path)){if(this.affectedTree.value!=null)return A(this.affectedTree.children.isEmpty(),"affectedTree should not have overlapping affected paths."),this;{const n=this.affectedTree.subtree(new he(e));return new Zo(ae(),n,this.revert)}}else return A(ee(this.path)===e,"operationForChild called for unrelated child."),new Zo(ve(this.path),this.affectedTree,this.revert)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vs{constructor(e,n){this.source=e,this.path=n,this.type=Dt.LISTEN_COMPLETE}operationForChild(e){return te(this.path)?new vs(this.source,ae()):new vs(this.source,ve(this.path))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fr{constructor(e,n,r){this.source=e,this.path=n,this.snap=r,this.type=Dt.OVERWRITE}operationForChild(e){return te(this.path)?new fr(this.source,ae(),this.snap.getImmediateChild(e)):new fr(this.source,ve(this.path),this.snap)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ni{constructor(e,n,r){this.source=e,this.path=n,this.children=r,this.type=Dt.MERGE}operationForChild(e){if(te(this.path)){const n=this.children.subtree(new he(e));return n.isEmpty()?null:n.value?new fr(this.source,ae(),n.value):new ni(this.source,ae(),n)}else return A(ee(this.path)===e,"Can't get a merge for a child not on the path of the operation"),new ni(this.source,ve(this.path),this.children)}toString(){return"Operation("+this.path+": "+this.source.toString()+" merge: "+this.children.toString()+")"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zn{constructor(e,n,r){this.node_=e,this.fullyInitialized_=n,this.filtered_=r}isFullyInitialized(){return this.fullyInitialized_}isFiltered(){return this.filtered_}isCompleteForPath(e){if(te(e))return this.isFullyInitialized()&&!this.filtered_;const n=ee(e);return this.isCompleteForChild(n)}isCompleteForChild(e){return this.isFullyInitialized()&&!this.filtered_||this.node_.hasChild(e)}getNode(){return this.node_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class DS{constructor(e){this.query_=e,this.index_=this.query_._queryParams.getIndex()}}function OS(t,e,n,r){const i=[],s=[];return e.forEach(o=>{o.type==="child_changed"&&t.index_.indexedValueChanged(o.oldSnap,o.snapshotNode)&&s.push(SS(o.childName,o.snapshotNode))}),Ti(t,i,"child_removed",e,r,n),Ti(t,i,"child_added",e,r,n),Ti(t,i,"child_moved",s,r,n),Ti(t,i,"child_changed",e,r,n),Ti(t,i,"value",e,r,n),i}function Ti(t,e,n,r,i,s){const o=r.filter(l=>l.type===n);o.sort((l,a)=>LS(t,l,a)),o.forEach(l=>{const a=MS(t,l,s);i.forEach(u=>{u.respondsTo(l.type)&&e.push(u.createEvent(a,t.query_))})})}function MS(t,e,n){return e.type==="value"||e.type==="child_removed"||(e.prevName=n.getPredecessorChildName(e.childName,e.snapshotNode,t.index_)),e}function LS(t,e,n){if(e.childName==null||n.childName==null)throw ui("Should only compare child_ events.");const r=new ne(e.childName,e.snapshotNode),i=new ne(n.childName,n.snapshotNode);return t.index_.compare(r,i)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Tl(t,e){return{eventCache:t,serverCache:e}}function Ui(t,e,n,r){return Tl(new zn(e,n,r),t.serverCache)}function ry(t,e,n,r){return Tl(t.eventCache,new zn(e,n,r))}function Jo(t){return t.eventCache.isFullyInitialized()?t.eventCache.getNode():null}function hr(t){return t.serverCache.isFullyInitialized()?t.serverCache.getNode():null}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Ta;const FS=()=>(Ta||(Ta=new dt(xx)),Ta);class ge{static fromObject(e){let n=new ge(null);return qe(e,(r,i)=>{n=n.set(new he(r),i)}),n}constructor(e,n=FS()){this.value=e,this.children=n}isEmpty(){return this.value===null&&this.children.isEmpty()}findRootMostMatchingPathAndValue(e,n){if(this.value!=null&&n(this.value))return{path:ae(),value:this.value};if(te(e))return null;{const r=ee(e),i=this.children.get(r);if(i!==null){const s=i.findRootMostMatchingPathAndValue(ve(e),n);return s!=null?{path:Ae(new he(r),s.path),value:s.value}:null}else return null}}findRootMostValueAndPath(e){return this.findRootMostMatchingPathAndValue(e,()=>!0)}subtree(e){if(te(e))return this;{const n=ee(e),r=this.children.get(n);return r!==null?r.subtree(ve(e)):new ge(null)}}set(e,n){if(te(e))return new ge(n,this.children);{const r=ee(e),s=(this.children.get(r)||new ge(null)).set(ve(e),n),o=this.children.insert(r,s);return new ge(this.value,o)}}remove(e){if(te(e))return this.children.isEmpty()?new ge(null):new ge(null,this.children);{const n=ee(e),r=this.children.get(n);if(r){const i=r.remove(ve(e));let s;return i.isEmpty()?s=this.children.remove(n):s=this.children.insert(n,i),this.value===null&&s.isEmpty()?new ge(null):new ge(this.value,s)}else return this}}get(e){if(te(e))return this.value;{const n=ee(e),r=this.children.get(n);return r?r.get(ve(e)):null}}setTree(e,n){if(te(e))return n;{const r=ee(e),s=(this.children.get(r)||new ge(null)).setTree(ve(e),n);let o;return s.isEmpty()?o=this.children.remove(r):o=this.children.insert(r,s),new ge(this.value,o)}}fold(e){return this.fold_(ae(),e)}fold_(e,n){const r={};return this.children.inorderTraversal((i,s)=>{r[i]=s.fold_(Ae(e,i),n)}),n(e,this.value,r)}findOnPath(e,n){return this.findOnPath_(e,ae(),n)}findOnPath_(e,n,r){const i=this.value?r(n,this.value):!1;if(i)return i;if(te(e))return null;{const s=ee(e),o=this.children.get(s);return o?o.findOnPath_(ve(e),Ae(n,s),r):null}}foreachOnPath(e,n){return this.foreachOnPath_(e,ae(),n)}foreachOnPath_(e,n,r){if(te(e))return this;{this.value&&r(n,this.value);const i=ee(e),s=this.children.get(i);return s?s.foreachOnPath_(ve(e),Ae(n,i),r):new ge(null)}}foreach(e){this.foreach_(ae(),e)}foreach_(e,n){this.children.inorderTraversal((r,i)=>{i.foreach_(Ae(e,r),n)}),this.value&&n(e,this.value)}foreachChild(e){this.children.inorderTraversal((n,r)=>{r.value&&e(n,r.value)})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lt{constructor(e){this.writeTree_=e}static empty(){return new Lt(new ge(null))}}function Hi(t,e,n){if(te(e))return new Lt(new ge(n));{const r=t.writeTree_.findRootMostValueAndPath(e);if(r!=null){const i=r.path;let s=r.value;const o=it(i,e);return s=s.updateChild(o,n),new Lt(t.writeTree_.set(i,s))}else{const i=new ge(n),s=t.writeTree_.setTree(e,i);return new Lt(s)}}}function Mc(t,e,n){let r=t;return qe(n,(i,s)=>{r=Hi(r,Ae(e,i),s)}),r}function Sh(t,e){if(te(e))return Lt.empty();{const n=t.writeTree_.setTree(e,new ge(null));return new Lt(n)}}function Lc(t,e){return vr(t,e)!=null}function vr(t,e){const n=t.writeTree_.findRootMostValueAndPath(e);return n!=null?t.writeTree_.get(n.path).getChild(it(n.path,e)):null}function wh(t){const e=[],n=t.writeTree_.value;return n!=null?n.isLeafNode()||n.forEachChild(ke,(r,i)=>{e.push(new ne(r,i))}):t.writeTree_.children.inorderTraversal((r,i)=>{i.value!=null&&e.push(new ne(r,i.value))}),e}function jn(t,e){if(te(e))return t;{const n=vr(t,e);return n!=null?new Lt(new ge(n)):new Lt(t.writeTree_.subtree(e))}}function Fc(t){return t.writeTree_.isEmpty()}function ri(t,e){return iy(ae(),t.writeTree_,e)}function iy(t,e,n){if(e.value!=null)return n.updateChild(t,e.value);{let r=null;return e.children.inorderTraversal((i,s)=>{i===".priority"?(A(s.value!==null,"Priority writes must always be leaf nodes"),r=s.value):n=iy(Ae(t,i),s,n)}),!n.getChild(t).isEmpty()&&r!==null&&(n=n.updateChild(Ae(t,".priority"),r)),n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Nl(t,e){return ay(e,t)}function zS(t,e,n,r,i){A(r>t.lastWriteId,"Stacking an older write on top of newer ones"),i===void 0&&(i=!0),t.allWrites.push({path:e,snap:n,writeId:r,visible:i}),i&&(t.visibleWrites=Hi(t.visibleWrites,e,n)),t.lastWriteId=r}function BS(t,e,n,r){A(r>t.lastWriteId,"Stacking an older merge on top of newer ones"),t.allWrites.push({path:e,children:n,writeId:r,visible:!0}),t.visibleWrites=Mc(t.visibleWrites,e,n),t.lastWriteId=r}function WS(t,e){for(let n=0;n<t.allWrites.length;n++){const r=t.allWrites[n];if(r.writeId===e)return r}return null}function $S(t,e){const n=t.allWrites.findIndex(l=>l.writeId===e);A(n>=0,"removeWrite called with nonexistent writeId.");const r=t.allWrites[n];t.allWrites.splice(n,1);let i=r.visible,s=!1,o=t.allWrites.length-1;for(;i&&o>=0;){const l=t.allWrites[o];l.visible&&(o>=n&&US(l,r.path)?i=!1:Et(r.path,l.path)&&(s=!0)),o--}if(i){if(s)return HS(t),!0;if(r.snap)t.visibleWrites=Sh(t.visibleWrites,r.path);else{const l=r.children;qe(l,a=>{t.visibleWrites=Sh(t.visibleWrites,Ae(r.path,a))})}return!0}else return!1}function US(t,e){if(t.snap)return Et(t.path,e);for(const n in t.children)if(t.children.hasOwnProperty(n)&&Et(Ae(t.path,n),e))return!0;return!1}function HS(t){t.visibleWrites=sy(t.allWrites,VS,ae()),t.allWrites.length>0?t.lastWriteId=t.allWrites[t.allWrites.length-1].writeId:t.lastWriteId=-1}function VS(t){return t.visible}function sy(t,e,n){let r=Lt.empty();for(let i=0;i<t.length;++i){const s=t[i];if(e(s)){const o=s.path;let l;if(s.snap)Et(n,o)?(l=it(n,o),r=Hi(r,l,s.snap)):Et(o,n)&&(l=it(o,n),r=Hi(r,ae(),s.snap.getChild(l)));else if(s.children){if(Et(n,o))l=it(n,o),r=Mc(r,l,s.children);else if(Et(o,n))if(l=it(o,n),te(l))r=Mc(r,ae(),s.children);else{const a=ur(s.children,ee(l));if(a){const u=a.getChild(ve(l));r=Hi(r,ae(),u)}}}else throw ui("WriteRecord should have .snap or .children")}}return r}function oy(t,e,n,r,i){if(!r&&!i){const s=vr(t.visibleWrites,e);if(s!=null)return s;{const o=jn(t.visibleWrites,e);if(Fc(o))return n;if(n==null&&!Lc(o,ae()))return null;{const l=n||K.EMPTY_NODE;return ri(o,l)}}}else{const s=jn(t.visibleWrites,e);if(!i&&Fc(s))return n;if(!i&&n==null&&!Lc(s,ae()))return null;{const o=function(u){return(u.visible||i)&&(!r||!~r.indexOf(u.writeId))&&(Et(u.path,e)||Et(e,u.path))},l=sy(t.allWrites,o,e),a=n||K.EMPTY_NODE;return ri(l,a)}}}function GS(t,e,n){let r=K.EMPTY_NODE;const i=vr(t.visibleWrites,e);if(i)return i.isLeafNode()||i.forEachChild(ke,(s,o)=>{r=r.updateImmediateChild(s,o)}),r;if(n){const s=jn(t.visibleWrites,e);return n.forEachChild(ke,(o,l)=>{const a=ri(jn(s,new he(o)),l);r=r.updateImmediateChild(o,a)}),wh(s).forEach(o=>{r=r.updateImmediateChild(o.name,o.node)}),r}else{const s=jn(t.visibleWrites,e);return wh(s).forEach(o=>{r=r.updateImmediateChild(o.name,o.node)}),r}}function QS(t,e,n,r,i){A(r||i,"Either existingEventSnap or existingServerSnap must exist");const s=Ae(e,n);if(Lc(t.visibleWrites,s))return null;{const o=jn(t.visibleWrites,s);return Fc(o)?i.getChild(n):ri(o,i.getChild(n))}}function KS(t,e,n,r){const i=Ae(e,n),s=vr(t.visibleWrites,i);if(s!=null)return s;if(r.isCompleteForChild(n)){const o=jn(t.visibleWrites,i);return ri(o,r.getNode().getImmediateChild(n))}else return null}function YS(t,e){return vr(t.visibleWrites,e)}function qS(t,e,n,r,i,s,o){let l;const a=jn(t.visibleWrites,e),u=vr(a,ae());if(u!=null)l=u;else if(n!=null)l=ri(a,n);else return[];if(l=l.withIndex(o),!l.isEmpty()&&!l.isLeafNode()){const h=[],f=o.getCompare(),d=s?l.getReverseIteratorFrom(r,o):l.getIteratorFrom(r,o);let v=d.getNext();for(;v&&h.length<i;)f(v,r)!==0&&h.push(v),v=d.getNext();return h}else return[]}function XS(){return{visibleWrites:Lt.empty(),allWrites:[],lastWriteId:-1}}function el(t,e,n,r){return oy(t.writeTree,t.treePath,e,n,r)}function ad(t,e){return GS(t.writeTree,t.treePath,e)}function Ch(t,e,n,r){return QS(t.writeTree,t.treePath,e,n,r)}function tl(t,e){return YS(t.writeTree,Ae(t.treePath,e))}function ZS(t,e,n,r,i,s){return qS(t.writeTree,t.treePath,e,n,r,i,s)}function cd(t,e,n){return KS(t.writeTree,t.treePath,e,n)}function ly(t,e){return ay(Ae(t.treePath,e),t.writeTree)}function ay(t,e){return{treePath:t,writeTree:e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class JS{constructor(){this.changeMap=new Map}trackChildChange(e){const n=e.type,r=e.childName;A(n==="child_added"||n==="child_changed"||n==="child_removed","Only child changes supported for tracking"),A(r!==".priority","Only non-priority child changes can be tracked.");const i=this.changeMap.get(r);if(i){const s=i.type;if(n==="child_added"&&s==="child_removed")this.changeMap.set(r,gs(r,e.snapshotNode,i.snapshotNode));else if(n==="child_removed"&&s==="child_added")this.changeMap.delete(r);else if(n==="child_removed"&&s==="child_changed")this.changeMap.set(r,ms(r,i.oldSnap));else if(n==="child_changed"&&s==="child_added")this.changeMap.set(r,ti(r,e.snapshotNode));else if(n==="child_changed"&&s==="child_changed")this.changeMap.set(r,gs(r,e.snapshotNode,i.oldSnap));else throw ui("Illegal combination of changes: "+e+" occurred after "+i)}else this.changeMap.set(r,e)}getChanges(){return Array.from(this.changeMap.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ew{getCompleteChild(e){return null}getChildAfterChild(e,n,r){return null}}const cy=new ew;class ud{constructor(e,n,r=null){this.writes_=e,this.viewCache_=n,this.optCompleteServerCache_=r}getCompleteChild(e){const n=this.viewCache_.eventCache;if(n.isCompleteForChild(e))return n.getNode().getImmediateChild(e);{const r=this.optCompleteServerCache_!=null?new zn(this.optCompleteServerCache_,!0,!1):this.viewCache_.serverCache;return cd(this.writes_,e,r)}}getChildAfterChild(e,n,r){const i=this.optCompleteServerCache_!=null?this.optCompleteServerCache_:hr(this.viewCache_),s=ZS(this.writes_,i,n,1,r,e);return s.length===0?null:s[0]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function tw(t){return{filter:t}}function nw(t,e){A(e.eventCache.getNode().isIndexed(t.filter.getIndex()),"Event snap not indexed"),A(e.serverCache.getNode().isIndexed(t.filter.getIndex()),"Server snap not indexed")}function rw(t,e,n,r,i){const s=new JS;let o,l;if(n.type===Dt.OVERWRITE){const u=n;u.source.fromUser?o=zc(t,e,u.path,u.snap,r,i,s):(A(u.source.fromServer,"Unknown source."),l=u.source.tagged||e.serverCache.isFiltered()&&!te(u.path),o=nl(t,e,u.path,u.snap,r,i,l,s))}else if(n.type===Dt.MERGE){const u=n;u.source.fromUser?o=sw(t,e,u.path,u.children,r,i,s):(A(u.source.fromServer,"Unknown source."),l=u.source.tagged||e.serverCache.isFiltered(),o=Bc(t,e,u.path,u.children,r,i,l,s))}else if(n.type===Dt.ACK_USER_WRITE){const u=n;u.revert?o=aw(t,e,u.path,r,i,s):o=ow(t,e,u.path,u.affectedTree,r,i,s)}else if(n.type===Dt.LISTEN_COMPLETE)o=lw(t,e,n.path,r,s);else throw ui("Unknown operation type: "+n.type);const a=s.getChanges();return iw(e,o,a),{viewCache:o,changes:a}}function iw(t,e,n){const r=e.eventCache;if(r.isFullyInitialized()){const i=r.getNode().isLeafNode()||r.getNode().isEmpty(),s=Jo(t);(n.length>0||!t.eventCache.isFullyInitialized()||i&&!r.getNode().equals(s)||!r.getNode().getPriority().equals(s.getPriority()))&&n.push(ty(Jo(e)))}}function uy(t,e,n,r,i,s){const o=e.eventCache;if(tl(r,n)!=null)return e;{let l,a;if(te(n))if(A(e.serverCache.isFullyInitialized(),"If change path is empty, we must have complete server data"),e.serverCache.isFiltered()){const u=hr(e),h=u instanceof K?u:K.EMPTY_NODE,f=ad(r,h);l=t.filter.updateFullNode(e.eventCache.getNode(),f,s)}else{const u=el(r,hr(e));l=t.filter.updateFullNode(e.eventCache.getNode(),u,s)}else{const u=ee(n);if(u===".priority"){A(Fn(n)===1,"Can't have a priority with additional path components");const h=o.getNode();a=e.serverCache.getNode();const f=Ch(r,n,h,a);f!=null?l=t.filter.updatePriority(h,f):l=o.getNode()}else{const h=ve(n);let f;if(o.isCompleteForChild(u)){a=e.serverCache.getNode();const d=Ch(r,n,o.getNode(),a);d!=null?f=o.getNode().getImmediateChild(u).updateChild(h,d):f=o.getNode().getImmediateChild(u)}else f=cd(r,u,e.serverCache);f!=null?l=t.filter.updateChild(o.getNode(),u,f,h,i,s):l=o.getNode()}}return Ui(e,l,o.isFullyInitialized()||te(n),t.filter.filtersNodes())}}function nl(t,e,n,r,i,s,o,l){const a=e.serverCache;let u;const h=o?t.filter:t.filter.getIndexedFilter();if(te(n))u=h.updateFullNode(a.getNode(),r,null);else if(h.filtersNodes()&&!a.isFiltered()){const v=a.getNode().updateChild(n,r);u=h.updateFullNode(a.getNode(),v,null)}else{const v=ee(n);if(!a.isCompleteForPath(n)&&Fn(n)>1)return e;const x=ve(n),E=a.getNode().getImmediateChild(v).updateChild(x,r);v===".priority"?u=h.updatePriority(a.getNode(),E):u=h.updateChild(a.getNode(),v,E,x,cy,null)}const f=ry(e,u,a.isFullyInitialized()||te(n),h.filtersNodes()),d=new ud(i,f,s);return uy(t,f,n,i,d,l)}function zc(t,e,n,r,i,s,o){const l=e.eventCache;let a,u;const h=new ud(i,e,s);if(te(n))u=t.filter.updateFullNode(e.eventCache.getNode(),r,o),a=Ui(e,u,!0,t.filter.filtersNodes());else{const f=ee(n);if(f===".priority")u=t.filter.updatePriority(e.eventCache.getNode(),r),a=Ui(e,u,l.isFullyInitialized(),l.isFiltered());else{const d=ve(n),v=l.getNode().getImmediateChild(f);let x;if(te(d))x=r;else{const g=h.getCompleteChild(f);g!=null?Zu(d)===".priority"&&g.getChild(Qg(d)).isEmpty()?x=g:x=g.updateChild(d,r):x=K.EMPTY_NODE}if(v.equals(x))a=e;else{const g=t.filter.updateChild(l.getNode(),f,x,d,h,o);a=Ui(e,g,l.isFullyInitialized(),t.filter.filtersNodes())}}}return a}function kh(t,e){return t.eventCache.isCompleteForChild(e)}function sw(t,e,n,r,i,s,o){let l=e;return r.foreach((a,u)=>{const h=Ae(n,a);kh(e,ee(h))&&(l=zc(t,l,h,u,i,s,o))}),r.foreach((a,u)=>{const h=Ae(n,a);kh(e,ee(h))||(l=zc(t,l,h,u,i,s,o))}),l}function Eh(t,e,n){return n.foreach((r,i)=>{e=e.updateChild(r,i)}),e}function Bc(t,e,n,r,i,s,o,l){if(e.serverCache.getNode().isEmpty()&&!e.serverCache.isFullyInitialized())return e;let a=e,u;te(n)?u=r:u=new ge(null).setTree(n,r);const h=e.serverCache.getNode();return u.children.inorderTraversal((f,d)=>{if(h.hasChild(f)){const v=e.serverCache.getNode().getImmediateChild(f),x=Eh(t,v,d);a=nl(t,a,new he(f),x,i,s,o,l)}}),u.children.inorderTraversal((f,d)=>{const v=!e.serverCache.isCompleteForChild(f)&&d.value===null;if(!h.hasChild(f)&&!v){const x=e.serverCache.getNode().getImmediateChild(f),g=Eh(t,x,d);a=nl(t,a,new he(f),g,i,s,o,l)}}),a}function ow(t,e,n,r,i,s,o){if(tl(i,n)!=null)return e;const l=e.serverCache.isFiltered(),a=e.serverCache;if(r.value!=null){if(te(n)&&a.isFullyInitialized()||a.isCompleteForPath(n))return nl(t,e,n,a.getNode().getChild(n),i,s,l,o);if(te(n)){let u=new ge(null);return a.getNode().forEachChild(ir,(h,f)=>{u=u.set(new he(h),f)}),Bc(t,e,n,u,i,s,l,o)}else return e}else{let u=new ge(null);return r.foreach((h,f)=>{const d=Ae(n,h);a.isCompleteForPath(d)&&(u=u.set(h,a.getNode().getChild(d)))}),Bc(t,e,n,u,i,s,l,o)}}function lw(t,e,n,r,i){const s=e.serverCache,o=ry(e,s.getNode(),s.isFullyInitialized()||te(n),s.isFiltered());return uy(t,o,n,r,cy,i)}function aw(t,e,n,r,i,s){let o;if(tl(r,n)!=null)return e;{const l=new ud(r,e,i),a=e.eventCache.getNode();let u;if(te(n)||ee(n)===".priority"){let h;if(e.serverCache.isFullyInitialized())h=el(r,hr(e));else{const f=e.serverCache.getNode();A(f instanceof K,"serverChildren would be complete if leaf node"),h=ad(r,f)}h=h,u=t.filter.updateFullNode(a,h,s)}else{const h=ee(n);let f=cd(r,h,e.serverCache);f==null&&e.serverCache.isCompleteForChild(h)&&(f=a.getImmediateChild(h)),f!=null?u=t.filter.updateChild(a,h,f,ve(n),l,s):e.eventCache.getNode().hasChild(h)?u=t.filter.updateChild(a,h,K.EMPTY_NODE,ve(n),l,s):u=a,u.isEmpty()&&e.serverCache.isFullyInitialized()&&(o=el(r,hr(e)),o.isLeafNode()&&(u=t.filter.updateFullNode(u,o,s)))}return o=e.serverCache.isFullyInitialized()||tl(r,ae())!=null,Ui(e,u,o,t.filter.filtersNodes())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cw{constructor(e,n){this.query_=e,this.eventRegistrations_=[];const r=this.query_._queryParams,i=new rd(r.getIndex()),s=CS(r);this.processor_=tw(s);const o=n.serverCache,l=n.eventCache,a=i.updateFullNode(K.EMPTY_NODE,o.getNode(),null),u=s.updateFullNode(K.EMPTY_NODE,l.getNode(),null),h=new zn(a,o.isFullyInitialized(),i.filtersNodes()),f=new zn(u,l.isFullyInitialized(),s.filtersNodes());this.viewCache_=Tl(f,h),this.eventGenerator_=new DS(this.query_)}get query(){return this.query_}}function uw(t){return t.viewCache_.serverCache.getNode()}function dw(t){return Jo(t.viewCache_)}function fw(t,e){const n=hr(t.viewCache_);return n&&(t.query._queryParams.loadsAllData()||!te(e)&&!n.getImmediateChild(ee(e)).isEmpty())?n.getChild(e):null}function Th(t){return t.eventRegistrations_.length===0}function hw(t,e){t.eventRegistrations_.push(e)}function Nh(t,e,n){const r=[];if(n){A(e==null,"A cancel should cancel all event registrations.");const i=t.query._path;t.eventRegistrations_.forEach(s=>{const o=s.createCancelEvent(n,i);o&&r.push(o)})}if(e){let i=[];for(let s=0;s<t.eventRegistrations_.length;++s){const o=t.eventRegistrations_[s];if(!o.matches(e))i.push(o);else if(e.hasAnyCallback()){i=i.concat(t.eventRegistrations_.slice(s+1));break}}t.eventRegistrations_=i}else t.eventRegistrations_=[];return r}function Ih(t,e,n,r){e.type===Dt.MERGE&&e.source.queryId!==null&&(A(hr(t.viewCache_),"We should always have a full cache before handling merges"),A(Jo(t.viewCache_),"Missing event cache, even though we have a server cache"));const i=t.viewCache_,s=rw(t.processor_,i,e,n,r);return nw(t.processor_,s.viewCache),A(s.viewCache.serverCache.isFullyInitialized()||!i.serverCache.isFullyInitialized(),"Once a server snap is complete, it should never go back"),t.viewCache_=s.viewCache,dy(t,s.changes,s.viewCache.eventCache.getNode(),null)}function pw(t,e){const n=t.viewCache_.eventCache,r=[];return n.getNode().isLeafNode()||n.getNode().forEachChild(ke,(s,o)=>{r.push(ti(s,o))}),n.isFullyInitialized()&&r.push(ty(n.getNode())),dy(t,r,n.getNode(),e)}function dy(t,e,n,r){const i=r?[r]:t.eventRegistrations_;return OS(t.eventGenerator_,e,n,i)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let rl;class fy{constructor(){this.views=new Map}}function mw(t){A(!rl,"__referenceConstructor has already been defined"),rl=t}function gw(){return A(rl,"Reference.ts has not been loaded"),rl}function yw(t){return t.views.size===0}function dd(t,e,n,r){const i=e.source.queryId;if(i!==null){const s=t.views.get(i);return A(s!=null,"SyncTree gave us an op for an invalid query."),Ih(s,e,n,r)}else{let s=[];for(const o of t.views.values())s=s.concat(Ih(o,e,n,r));return s}}function hy(t,e,n,r,i){const s=e._queryIdentifier,o=t.views.get(s);if(!o){let l=el(n,i?r:null),a=!1;l?a=!0:r instanceof K?(l=ad(n,r),a=!1):(l=K.EMPTY_NODE,a=!1);const u=Tl(new zn(l,a,!1),new zn(r,i,!1));return new cw(e,u)}return o}function vw(t,e,n,r,i,s){const o=hy(t,e,r,i,s);return t.views.has(e._queryIdentifier)||t.views.set(e._queryIdentifier,o),hw(o,n),pw(o,n)}function _w(t,e,n,r){const i=e._queryIdentifier,s=[];let o=[];const l=Bn(t);if(i==="default")for(const[a,u]of t.views.entries())o=o.concat(Nh(u,n,r)),Th(u)&&(t.views.delete(a),u.query._queryParams.loadsAllData()||s.push(u.query));else{const a=t.views.get(i);a&&(o=o.concat(Nh(a,n,r)),Th(a)&&(t.views.delete(i),a.query._queryParams.loadsAllData()||s.push(a.query)))}return l&&!Bn(t)&&s.push(new(gw())(e._repo,e._path)),{removed:s,events:o}}function py(t){const e=[];for(const n of t.views.values())n.query._queryParams.loadsAllData()||e.push(n);return e}function An(t,e){let n=null;for(const r of t.views.values())n=n||fw(r,e);return n}function my(t,e){if(e._queryParams.loadsAllData())return Il(t);{const r=e._queryIdentifier;return t.views.get(r)}}function gy(t,e){return my(t,e)!=null}function Bn(t){return Il(t)!=null}function Il(t){for(const e of t.views.values())if(e.query._queryParams.loadsAllData())return e;return null}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let il;function xw(t){A(!il,"__referenceConstructor has already been defined"),il=t}function Sw(){return A(il,"Reference.ts has not been loaded"),il}let ww=1;class bh{constructor(e){this.listenProvider_=e,this.syncPointTree_=new ge(null),this.pendingWriteTree_=XS(),this.tagToQueryMap=new Map,this.queryToTagMap=new Map}}function fd(t,e,n,r,i){return zS(t.pendingWriteTree_,e,n,r,i),i?hi(t,new fr(sd(),e,n)):[]}function Cw(t,e,n,r){BS(t.pendingWriteTree_,e,n,r);const i=ge.fromObject(n);return hi(t,new ni(sd(),e,i))}function Sn(t,e,n=!1){const r=WS(t.pendingWriteTree_,e);if($S(t.pendingWriteTree_,e)){let s=new ge(null);return r.snap!=null?s=s.set(ae(),!0):qe(r.children,o=>{s=s.set(new he(o),!0)}),hi(t,new Zo(r.path,s,n))}else return[]}function Rs(t,e,n){return hi(t,new fr(od(),e,n))}function kw(t,e,n){const r=ge.fromObject(n);return hi(t,new ni(od(),e,r))}function Ew(t,e){return hi(t,new vs(od(),e))}function Tw(t,e,n){const r=hd(t,n);if(r){const i=pd(r),s=i.path,o=i.queryId,l=it(s,e),a=new vs(ld(o),l);return md(t,s,a)}else return[]}function sl(t,e,n,r,i=!1){const s=e._path,o=t.syncPointTree_.get(s);let l=[];if(o&&(e._queryIdentifier==="default"||gy(o,e))){const a=_w(o,e,n,r);yw(o)&&(t.syncPointTree_=t.syncPointTree_.remove(s));const u=a.removed;if(l=a.events,!i){const h=u.findIndex(d=>d._queryParams.loadsAllData())!==-1,f=t.syncPointTree_.findOnPath(s,(d,v)=>Bn(v));if(h&&!f){const d=t.syncPointTree_.subtree(s);if(!d.isEmpty()){const v=bw(d);for(let x=0;x<v.length;++x){const g=v[x],E=g.query,y=xy(t,g);t.listenProvider_.startListening(Vi(E),_s(t,E),y.hashFn,y.onComplete)}}}!f&&u.length>0&&!r&&(h?t.listenProvider_.stopListening(Vi(e),null):u.forEach(d=>{const v=t.queryToTagMap.get(Pl(d));t.listenProvider_.stopListening(Vi(d),v)}))}Pw(t,u)}return l}function yy(t,e,n,r){const i=hd(t,r);if(i!=null){const s=pd(i),o=s.path,l=s.queryId,a=it(o,e),u=new fr(ld(l),a,n);return md(t,o,u)}else return[]}function Nw(t,e,n,r){const i=hd(t,r);if(i){const s=pd(i),o=s.path,l=s.queryId,a=it(o,e),u=ge.fromObject(n),h=new ni(ld(l),a,u);return md(t,o,h)}else return[]}function Wc(t,e,n,r=!1){const i=e._path;let s=null,o=!1;t.syncPointTree_.foreachOnPath(i,(d,v)=>{const x=it(d,i);s=s||An(v,x),o=o||Bn(v)});let l=t.syncPointTree_.get(i);l?(o=o||Bn(l),s=s||An(l,ae())):(l=new fy,t.syncPointTree_=t.syncPointTree_.set(i,l));let a;s!=null?a=!0:(a=!1,s=K.EMPTY_NODE,t.syncPointTree_.subtree(i).foreachChild((v,x)=>{const g=An(x,ae());g&&(s=s.updateImmediateChild(v,g))}));const u=gy(l,e);if(!u&&!e._queryParams.loadsAllData()){const d=Pl(e);A(!t.queryToTagMap.has(d),"View does not exist, but we have a tag");const v=Rw();t.queryToTagMap.set(d,v),t.tagToQueryMap.set(v,d)}const h=Nl(t.pendingWriteTree_,i);let f=vw(l,e,n,h,s,a);if(!u&&!o&&!r){const d=my(l,e);f=f.concat(jw(t,e,d))}return f}function bl(t,e,n){const i=t.pendingWriteTree_,s=t.syncPointTree_.findOnPath(e,(o,l)=>{const a=it(o,e),u=An(l,a);if(u)return u});return oy(i,e,s,n,!0)}function Iw(t,e){const n=e._path;let r=null;t.syncPointTree_.foreachOnPath(n,(u,h)=>{const f=it(u,n);r=r||An(h,f)});let i=t.syncPointTree_.get(n);i?r=r||An(i,ae()):(i=new fy,t.syncPointTree_=t.syncPointTree_.set(n,i));const s=r!=null,o=s?new zn(r,!0,!1):null,l=Nl(t.pendingWriteTree_,e._path),a=hy(i,e,l,s?o.getNode():K.EMPTY_NODE,s);return dw(a)}function hi(t,e){return vy(e,t.syncPointTree_,null,Nl(t.pendingWriteTree_,ae()))}function vy(t,e,n,r){if(te(t.path))return _y(t,e,n,r);{const i=e.get(ae());n==null&&i!=null&&(n=An(i,ae()));let s=[];const o=ee(t.path),l=t.operationForChild(o),a=e.children.get(o);if(a&&l){const u=n?n.getImmediateChild(o):null,h=ly(r,o);s=s.concat(vy(l,a,u,h))}return i&&(s=s.concat(dd(i,t,r,n))),s}}function _y(t,e,n,r){const i=e.get(ae());n==null&&i!=null&&(n=An(i,ae()));let s=[];return e.children.inorderTraversal((o,l)=>{const a=n?n.getImmediateChild(o):null,u=ly(r,o),h=t.operationForChild(o);h&&(s=s.concat(_y(h,l,a,u)))}),i&&(s=s.concat(dd(i,t,r,n))),s}function xy(t,e){const n=e.query,r=_s(t,n);return{hashFn:()=>(uw(e)||K.EMPTY_NODE).hash(),onComplete:i=>{if(i==="ok")return r?Tw(t,n._path,r):Ew(t,n._path);{const s=Cx(i,n);return sl(t,n,null,s)}}}}function _s(t,e){const n=Pl(e);return t.queryToTagMap.get(n)}function Pl(t){return t._path.toString()+"$"+t._queryIdentifier}function hd(t,e){return t.tagToQueryMap.get(e)}function pd(t){const e=t.indexOf("$");return A(e!==-1&&e<t.length-1,"Bad queryKey."),{queryId:t.substr(e+1),path:new he(t.substr(0,e))}}function md(t,e,n){const r=t.syncPointTree_.get(e);A(r,"Missing sync point for query tag that we're tracking");const i=Nl(t.pendingWriteTree_,e);return dd(r,n,i,null)}function bw(t){return t.fold((e,n,r)=>{if(n&&Bn(n))return[Il(n)];{let i=[];return n&&(i=py(n)),qe(r,(s,o)=>{i=i.concat(o)}),i}})}function Vi(t){return t._queryParams.loadsAllData()&&!t._queryParams.isDefault()?new(Sw())(t._repo,t._path):t}function Pw(t,e){for(let n=0;n<e.length;++n){const r=e[n];if(!r._queryParams.loadsAllData()){const i=Pl(r),s=t.queryToTagMap.get(i);t.queryToTagMap.delete(i),t.tagToQueryMap.delete(s)}}}function Rw(){return ww++}function jw(t,e,n){const r=e._path,i=_s(t,e),s=xy(t,n),o=t.listenProvider_.startListening(Vi(e),i,s.hashFn,s.onComplete),l=t.syncPointTree_.subtree(r);if(i)A(!Bn(l.value),"If we're adding a query, it shouldn't be shadowed");else{const a=l.fold((u,h,f)=>{if(!te(u)&&h&&Bn(h))return[Il(h).query];{let d=[];return h&&(d=d.concat(py(h).map(v=>v.query))),qe(f,(v,x)=>{d=d.concat(x)}),d}});for(let u=0;u<a.length;++u){const h=a[u];t.listenProvider_.stopListening(Vi(h),_s(t,h))}}return o}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gd{constructor(e){this.node_=e}getImmediateChild(e){const n=this.node_.getImmediateChild(e);return new gd(n)}node(){return this.node_}}class yd{constructor(e,n){this.syncTree_=e,this.path_=n}getImmediateChild(e){const n=Ae(this.path_,e);return new yd(this.syncTree_,n)}node(){return bl(this.syncTree_,this.path_)}}const Aw=function(t){return t=t||{},t.timestamp=t.timestamp||new Date().getTime(),t},Ph=function(t,e,n){if(!t||typeof t!="object")return t;if(A(".sv"in t,"Unexpected leaf node or priority contents"),typeof t[".sv"]=="string")return Dw(t[".sv"],e,n);if(typeof t[".sv"]=="object")return Ow(t[".sv"],e);A(!1,"Unexpected server value: "+JSON.stringify(t,null,2))},Dw=function(t,e,n){switch(t){case"timestamp":return n.timestamp;default:A(!1,"Unexpected server value: "+t)}},Ow=function(t,e,n){t.hasOwnProperty("increment")||A(!1,"Unexpected server value: "+JSON.stringify(t,null,2));const r=t.increment;typeof r!="number"&&A(!1,"Unexpected increment value: "+r);const i=e.node();if(A(i!==null&&typeof i<"u","Expected ChildrenNode.EMPTY_NODE for nulls"),!i.isLeafNode())return r;const o=i.getValue();return typeof o!="number"?r:o+r},Sy=function(t,e,n,r){return _d(e,new yd(n,t),r)},vd=function(t,e,n){return _d(t,new gd(e),n)};function _d(t,e,n){const r=t.getPriority().val(),i=Ph(r,e.getImmediateChild(".priority"),n);let s;if(t.isLeafNode()){const o=t,l=Ph(o.getValue(),e,n);return l!==o.getValue()||i!==o.getPriority().val()?new We(l,Me(i)):t}else{const o=t;return s=o,i!==o.getPriority().val()&&(s=s.updatePriority(new We(i))),o.forEachChild(ke,(l,a)=>{const u=_d(a,e.getImmediateChild(l),n);u!==a&&(s=s.updateImmediateChild(l,u))}),s}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xd{constructor(e="",n=null,r={children:{},childCount:0}){this.name=e,this.parent=n,this.node=r}}function Rl(t,e){let n=e instanceof he?e:new he(e),r=t,i=ee(n);for(;i!==null;){const s=ur(r.node.children,i)||{children:{},childCount:0};r=new xd(i,r,s),n=ve(n),i=ee(n)}return r}function _r(t){return t.node.value}function Sd(t,e){t.node.value=e,$c(t)}function wy(t){return t.node.childCount>0}function Mw(t){return _r(t)===void 0&&!wy(t)}function jl(t,e){qe(t.node.children,(n,r)=>{e(new xd(n,t,r))})}function Cy(t,e,n,r){n&&e(t),jl(t,i=>{Cy(i,e,!0)})}function Lw(t,e,n){let r=t.parent;for(;r!==null;){if(e(r))return!0;r=r.parent}return!1}function js(t){return new he(t.parent===null?t.name:js(t.parent)+"/"+t.name)}function $c(t){t.parent!==null&&Fw(t.parent,t.name,t)}function Fw(t,e,n){const r=Mw(n),i=Bt(t.node.children,e);r&&i?(delete t.node.children[e],t.node.childCount--,$c(t)):!r&&!i&&(t.node.children[e]=n.node,t.node.childCount++,$c(t))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zw=/[\[\].#$\/\u0000-\u001F\u007F]/,Bw=/[\[\].#$\u0000-\u001F\u007F]/,Na=10*1024*1024,wd=function(t){return typeof t=="string"&&t.length!==0&&!zw.test(t)},ky=function(t){return typeof t=="string"&&t.length!==0&&!Bw.test(t)},Ww=function(t){return t&&(t=t.replace(/^\/*\.info(\/|$)/,"/")),ky(t)},ol=function(t){return t===null||typeof t=="string"||typeof t=="number"&&!Qu(t)||t&&typeof t=="object"&&Bt(t,".sv")},Al=function(t,e,n,r){r&&e===void 0||As(Cl(t,"value"),e,n)},As=function(t,e,n){const r=n instanceof he?new rS(n,t):n;if(e===void 0)throw new Error(t+"contains undefined "+Yn(r));if(typeof e=="function")throw new Error(t+"contains a function "+Yn(r)+" with contents = "+e.toString());if(Qu(e))throw new Error(t+"contains "+e.toString()+" "+Yn(r));if(typeof e=="string"&&e.length>Na/3&&kl(e)>Na)throw new Error(t+"contains a string greater than "+Na+" utf8 bytes "+Yn(r)+" ('"+e.substring(0,50)+"...')");if(e&&typeof e=="object"){let i=!1,s=!1;if(qe(e,(o,l)=>{if(o===".value")i=!0;else if(o!==".priority"&&o!==".sv"&&(s=!0,!wd(o)))throw new Error(t+" contains an invalid key ("+o+") "+Yn(r)+`.  Keys must be non-empty strings and can't contain ".", "#", "$", "/", "[", or "]"`);iS(r,o),As(t,l,r),sS(r)}),i&&s)throw new Error(t+' contains ".value" child '+Yn(r)+" in addition to actual children.")}},$w=function(t,e){let n,r;for(n=0;n<e.length;n++){r=e[n];const s=ps(r);for(let o=0;o<s.length;o++)if(!(s[o]===".priority"&&o===s.length-1)){if(!wd(s[o]))throw new Error(t+"contains an invalid key ("+s[o]+") in path "+r.toString()+`. Keys must be non-empty strings and can't contain ".", "#", "$", "/", "[", or "]"`)}}e.sort(nS);let i=null;for(n=0;n<e.length;n++){if(r=e[n],i!==null&&Et(i,r))throw new Error(t+"contains a path "+i.toString()+" that is ancestor of another path "+r.toString());i=r}},Uw=function(t,e,n,r){const i=Cl(t,"values");if(!(e&&typeof e=="object")||Array.isArray(e))throw new Error(i+" must be an object containing the children to replace.");const s=[];qe(e,(o,l)=>{const a=new he(o);if(As(i,l,Ae(n,a)),Zu(a)===".priority"&&!ol(l))throw new Error(i+"contains an invalid value for '"+a.toString()+"', which must be a valid Firebase priority (a string, finite number, server value, or null).");s.push(a)}),$w(i,s)},Cd=function(t,e,n,r){if(!ky(n))throw new Error(Cl(t,e)+'was an invalid path = "'+n+`". Paths must be non-empty strings and can't contain ".", "#", "$", "[", or "]"`)},Hw=function(t,e,n,r){n&&(n=n.replace(/^\/*\.info(\/|$)/,"/")),Cd(t,e,n)},Dl=function(t,e){if(ee(e)===".info")throw new Error(t+" failed = Can't modify data under /.info/")},Vw=function(t,e){const n=e.path.toString();if(typeof e.repoInfo.host!="string"||e.repoInfo.host.length===0||!wd(e.repoInfo.namespace)&&e.repoInfo.host.split(":")[0]!=="localhost"||n.length!==0&&!Ww(n))throw new Error(Cl(t,"url")+`must be a valid firebase URL and the path can't contain ".", "#", "$", "[", or "]".`)};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gw{constructor(){this.eventLists_=[],this.recursionDepth_=0}}function Ol(t,e){let n=null;for(let r=0;r<e.length;r++){const i=e[r],s=i.getPath();n!==null&&!Ju(s,n.path)&&(t.eventLists_.push(n),n=null),n===null&&(n={events:[],path:s}),n.events.push(i)}n&&t.eventLists_.push(n)}function Ey(t,e,n){Ol(t,n),Ty(t,r=>Ju(r,e))}function _t(t,e,n){Ol(t,n),Ty(t,r=>Et(r,e)||Et(e,r))}function Ty(t,e){t.recursionDepth_++;let n=!0;for(let r=0;r<t.eventLists_.length;r++){const i=t.eventLists_[r];if(i){const s=i.path;e(s)?(Qw(t.eventLists_[r]),t.eventLists_[r]=null):n=!1}}n&&(t.eventLists_=[]),t.recursionDepth_--}function Qw(t){for(let e=0;e<t.events.length;e++){const n=t.events[e];if(n!==null){t.events[e]=null;const r=n.getEventRunner();Wi&&Qe("event: "+n.toString()),fi(r)}}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Kw="repo_interrupt",Yw=25;class qw{constructor(e,n,r,i){this.repoInfo_=e,this.forceRestClient_=n,this.authTokenProvider_=r,this.appCheckProvider_=i,this.dataUpdateCount=0,this.statsListener_=null,this.eventQueue_=new Gw,this.nextWriteId_=1,this.interceptServerDataCallback_=null,this.onDisconnect_=Xo(),this.transactionQueueTree_=new xd,this.persistentConnection_=null,this.key=this.repoInfo_.toURLString()}toString(){return(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host}}function Xw(t,e,n){if(t.stats_=qu(t.repoInfo_),t.forceRestClient_||Nx())t.server_=new qo(t.repoInfo_,(r,i,s,o)=>{Rh(t,r,i,s,o)},t.authTokenProvider_,t.appCheckProvider_),setTimeout(()=>jh(t,!0),0);else{if(typeof n<"u"&&n!==null){if(typeof n!="object")throw new Error("Only objects are supported for option databaseAuthVariableOverride");try{ze(n)}catch(r){throw new Error("Invalid authOverride provided: "+r)}}t.persistentConnection_=new tn(t.repoInfo_,e,(r,i,s,o)=>{Rh(t,r,i,s,o)},r=>{jh(t,r)},r=>{Zw(t,r)},t.authTokenProvider_,t.appCheckProvider_,n),t.server_=t.persistentConnection_}t.authTokenProvider_.addTokenChangeListener(r=>{t.server_.refreshAuthToken(r)}),t.appCheckProvider_.addTokenChangeListener(r=>{t.server_.refreshAppCheckToken(r.token)}),t.statsReporter_=jx(t.repoInfo_,()=>new AS(t.stats_,t.server_)),t.infoData_=new IS,t.infoSyncTree_=new bh({startListening:(r,i,s,o)=>{let l=[];const a=t.infoData_.getNode(r._path);return a.isEmpty()||(l=Rs(t.infoSyncTree_,r._path,a),setTimeout(()=>{o("ok")},0)),l},stopListening:()=>{}}),kd(t,"connected",!1),t.serverSyncTree_=new bh({startListening:(r,i,s,o)=>(t.server_.listen(r,s,i,(l,a)=>{const u=o(l,a);_t(t.eventQueue_,r._path,u)}),[]),stopListening:(r,i)=>{t.server_.unlisten(r,i)}})}function Ny(t){const n=t.infoData_.getNode(new he(".info/serverTimeOffset")).val()||0;return new Date().getTime()+n}function Ds(t){return Aw({timestamp:Ny(t)})}function Rh(t,e,n,r,i){t.dataUpdateCount++;const s=new he(e);n=t.interceptServerDataCallback_?t.interceptServerDataCallback_(e,n):n;let o=[];if(i)if(r){const a=Ho(n,u=>Me(u));o=Nw(t.serverSyncTree_,s,a,i)}else{const a=Me(n);o=yy(t.serverSyncTree_,s,a,i)}else if(r){const a=Ho(n,u=>Me(u));o=kw(t.serverSyncTree_,s,a)}else{const a=Me(n);o=Rs(t.serverSyncTree_,s,a)}let l=s;o.length>0&&(l=ii(t,s)),_t(t.eventQueue_,l,o)}function jh(t,e){kd(t,"connected",e),e===!1&&nC(t)}function Zw(t,e){qe(e,(n,r)=>{kd(t,n,r)})}function kd(t,e,n){const r=new he("/.info/"+e),i=Me(n);t.infoData_.updateSnapshot(r,i);const s=Rs(t.infoSyncTree_,r,i);_t(t.eventQueue_,r,s)}function Ml(t){return t.nextWriteId_++}function Jw(t,e,n){const r=Iw(t.serverSyncTree_,e);return r!=null?Promise.resolve(r):t.server_.get(e).then(i=>{const s=Me(i).withIndex(e._queryParams.getIndex());Wc(t.serverSyncTree_,e,n,!0);let o;if(e._queryParams.loadsAllData())o=Rs(t.serverSyncTree_,e._path,s);else{const l=_s(t.serverSyncTree_,e);o=yy(t.serverSyncTree_,e._path,s,l)}return _t(t.eventQueue_,e._path,o),sl(t.serverSyncTree_,e,n,null,!0),s},i=>(pi(t,"get for query "+ze(e)+" failed: "+i),Promise.reject(new Error(i))))}function eC(t,e,n,r,i){pi(t,"set",{path:e.toString(),value:n,priority:r});const s=Ds(t),o=Me(n,r),l=bl(t.serverSyncTree_,e),a=vd(o,l,s),u=Ml(t),h=fd(t.serverSyncTree_,e,a,u,!0);Ol(t.eventQueue_,h),t.server_.put(e.toString(),o.val(!0),(d,v)=>{const x=d==="ok";x||ot("set at "+e+" failed: "+d);const g=Sn(t.serverSyncTree_,u,!x);_t(t.eventQueue_,e,g),Uc(t,i,d,v)});const f=Td(t,e);ii(t,f),_t(t.eventQueue_,f,[])}function tC(t,e,n,r){pi(t,"update",{path:e.toString(),value:n});let i=!0;const s=Ds(t),o={};if(qe(n,(l,a)=>{i=!1,o[l]=Sy(Ae(e,l),Me(a),t.serverSyncTree_,s)}),i)Qe("update() called with empty data.  Don't do anything."),Uc(t,r,"ok",void 0);else{const l=Ml(t),a=Cw(t.serverSyncTree_,e,o,l);Ol(t.eventQueue_,a),t.server_.merge(e.toString(),n,(u,h)=>{const f=u==="ok";f||ot("update at "+e+" failed: "+u);const d=Sn(t.serverSyncTree_,l,!f),v=d.length>0?ii(t,e):e;_t(t.eventQueue_,v,d),Uc(t,r,u,h)}),qe(n,u=>{const h=Td(t,Ae(e,u));ii(t,h)}),_t(t.eventQueue_,e,[])}}function nC(t){pi(t,"onDisconnectEvents");const e=Ds(t),n=Xo();Oc(t.onDisconnect_,ae(),(i,s)=>{const o=Sy(i,s,t.serverSyncTree_,e);ny(n,i,o)});let r=[];Oc(n,ae(),(i,s)=>{r=r.concat(Rs(t.serverSyncTree_,i,s));const o=Td(t,i);ii(t,o)}),t.onDisconnect_=Xo(),_t(t.eventQueue_,ae(),r)}function rC(t,e,n){let r;ee(e._path)===".info"?r=Wc(t.infoSyncTree_,e,n):r=Wc(t.serverSyncTree_,e,n),Ey(t.eventQueue_,e._path,r)}function iC(t,e,n){let r;ee(e._path)===".info"?r=sl(t.infoSyncTree_,e,n):r=sl(t.serverSyncTree_,e,n),Ey(t.eventQueue_,e._path,r)}function sC(t){t.persistentConnection_&&t.persistentConnection_.interrupt(Kw)}function pi(t,...e){let n="";t.persistentConnection_&&(n=t.persistentConnection_.id+":"),Qe(n,...e)}function Uc(t,e,n,r){e&&fi(()=>{if(n==="ok")e(null);else{const i=(n||"error").toUpperCase();let s=i;r&&(s+=": "+r);const o=new Error(s);o.code=i,e(o)}})}function oC(t,e,n,r,i,s){pi(t,"transaction on "+e);const o={path:e,update:n,onComplete:r,status:null,order:Eg(),applyLocally:s,retryCount:0,unwatcher:i,abortReason:null,currentWriteId:null,currentInputSnapshot:null,currentOutputSnapshotRaw:null,currentOutputSnapshotResolved:null},l=Ed(t,e,void 0);o.currentInputSnapshot=l;const a=o.update(l.val());if(a===void 0)o.unwatcher(),o.currentOutputSnapshotRaw=null,o.currentOutputSnapshotResolved=null,o.onComplete&&o.onComplete(null,!1,o.currentInputSnapshot);else{As("transaction failed: Data returned ",a,o.path),o.status=0;const u=Rl(t.transactionQueueTree_,e),h=_r(u)||[];h.push(o),Sd(u,h);let f;typeof a=="object"&&a!==null&&Bt(a,".priority")?(f=ur(a,".priority"),A(ol(f),"Invalid priority returned by transaction. Priority must be a valid string, finite number, server value, or null.")):f=(bl(t.serverSyncTree_,e)||K.EMPTY_NODE).getPriority().val();const d=Ds(t),v=Me(a,f),x=vd(v,l,d);o.currentOutputSnapshotRaw=v,o.currentOutputSnapshotResolved=x,o.currentWriteId=Ml(t);const g=fd(t.serverSyncTree_,e,x,o.currentWriteId,o.applyLocally);_t(t.eventQueue_,e,g),Ll(t,t.transactionQueueTree_)}}function Ed(t,e,n){return bl(t.serverSyncTree_,e,n)||K.EMPTY_NODE}function Ll(t,e=t.transactionQueueTree_){if(e||Fl(t,e),_r(e)){const n=by(t,e);A(n.length>0,"Sending zero length transaction queue"),n.every(i=>i.status===0)&&lC(t,js(e),n)}else wy(e)&&jl(e,n=>{Ll(t,n)})}function lC(t,e,n){const r=n.map(u=>u.currentWriteId),i=Ed(t,e,r);let s=i;const o=i.hash();for(let u=0;u<n.length;u++){const h=n[u];A(h.status===0,"tryToSendTransactionQueue_: items in queue should all be run."),h.status=1,h.retryCount++;const f=it(e,h.path);s=s.updateChild(f,h.currentOutputSnapshotRaw)}const l=s.val(!0),a=e;t.server_.put(a.toString(),l,u=>{pi(t,"transaction put response",{path:a.toString(),status:u});let h=[];if(u==="ok"){const f=[];for(let d=0;d<n.length;d++)n[d].status=2,h=h.concat(Sn(t.serverSyncTree_,n[d].currentWriteId)),n[d].onComplete&&f.push(()=>n[d].onComplete(null,!0,n[d].currentOutputSnapshotResolved)),n[d].unwatcher();Fl(t,Rl(t.transactionQueueTree_,e)),Ll(t,t.transactionQueueTree_),_t(t.eventQueue_,e,h);for(let d=0;d<f.length;d++)fi(f[d])}else{if(u==="datastale")for(let f=0;f<n.length;f++)n[f].status===3?n[f].status=4:n[f].status=0;else{ot("transaction at "+a.toString()+" failed: "+u);for(let f=0;f<n.length;f++)n[f].status=4,n[f].abortReason=u}ii(t,e)}},o)}function ii(t,e){const n=Iy(t,e),r=js(n),i=by(t,n);return aC(t,i,r),r}function aC(t,e,n){if(e.length===0)return;const r=[];let i=[];const o=e.filter(l=>l.status===0).map(l=>l.currentWriteId);for(let l=0;l<e.length;l++){const a=e[l],u=it(n,a.path);let h=!1,f;if(A(u!==null,"rerunTransactionsUnderNode_: relativePath should not be null."),a.status===4)h=!0,f=a.abortReason,i=i.concat(Sn(t.serverSyncTree_,a.currentWriteId,!0));else if(a.status===0)if(a.retryCount>=Yw)h=!0,f="maxretry",i=i.concat(Sn(t.serverSyncTree_,a.currentWriteId,!0));else{const d=Ed(t,a.path,o);a.currentInputSnapshot=d;const v=e[l].update(d.val());if(v!==void 0){As("transaction failed: Data returned ",v,a.path);let x=Me(v);typeof v=="object"&&v!=null&&Bt(v,".priority")||(x=x.updatePriority(d.getPriority()));const E=a.currentWriteId,y=Ds(t),p=vd(x,d,y);a.currentOutputSnapshotRaw=x,a.currentOutputSnapshotResolved=p,a.currentWriteId=Ml(t),o.splice(o.indexOf(E),1),i=i.concat(fd(t.serverSyncTree_,a.path,p,a.currentWriteId,a.applyLocally)),i=i.concat(Sn(t.serverSyncTree_,E,!0))}else h=!0,f="nodata",i=i.concat(Sn(t.serverSyncTree_,a.currentWriteId,!0))}_t(t.eventQueue_,n,i),i=[],h&&(e[l].status=2,function(d){setTimeout(d,Math.floor(0))}(e[l].unwatcher),e[l].onComplete&&(f==="nodata"?r.push(()=>e[l].onComplete(null,!1,e[l].currentInputSnapshot)):r.push(()=>e[l].onComplete(new Error(f),!1,null))))}Fl(t,t.transactionQueueTree_);for(let l=0;l<r.length;l++)fi(r[l]);Ll(t,t.transactionQueueTree_)}function Iy(t,e){let n,r=t.transactionQueueTree_;for(n=ee(e);n!==null&&_r(r)===void 0;)r=Rl(r,n),e=ve(e),n=ee(e);return r}function by(t,e){const n=[];return Py(t,e,n),n.sort((r,i)=>r.order-i.order),n}function Py(t,e,n){const r=_r(e);if(r)for(let i=0;i<r.length;i++)n.push(r[i]);jl(e,i=>{Py(t,i,n)})}function Fl(t,e){const n=_r(e);if(n){let r=0;for(let i=0;i<n.length;i++)n[i].status!==2&&(n[r]=n[i],r++);n.length=r,Sd(e,n.length>0?n:void 0)}jl(e,r=>{Fl(t,r)})}function Td(t,e){const n=js(Iy(t,e)),r=Rl(t.transactionQueueTree_,e);return Lw(r,i=>{Ia(t,i)}),Ia(t,r),Cy(r,i=>{Ia(t,i)}),n}function Ia(t,e){const n=_r(e);if(n){const r=[];let i=[],s=-1;for(let o=0;o<n.length;o++)n[o].status===3||(n[o].status===1?(A(s===o-1,"All SENT items should be at beginning of queue."),s=o,n[o].status=3,n[o].abortReason="set"):(A(n[o].status===0,"Unexpected transaction status in abort"),n[o].unwatcher(),i=i.concat(Sn(t.serverSyncTree_,n[o].currentWriteId,!0)),n[o].onComplete&&r.push(n[o].onComplete.bind(null,new Error("set"),!1,null))));s===-1?Sd(e,void 0):n.length=s+1,_t(t.eventQueue_,js(e),i);for(let o=0;o<r.length;o++)fi(r[o])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function cC(t){let e="";const n=t.split("/");for(let r=0;r<n.length;r++)if(n[r].length>0){let i=n[r];try{i=decodeURIComponent(i.replace(/\+/g," "))}catch{}e+="/"+i}return e}function uC(t){const e={};t.charAt(0)==="?"&&(t=t.substring(1));for(const n of t.split("&")){if(n.length===0)continue;const r=n.split("=");r.length===2?e[decodeURIComponent(r[0])]=decodeURIComponent(r[1]):ot(`Invalid query segment '${n}' in query '${t}'`)}return e}const Ah=function(t,e){const n=dC(t),r=n.namespace;n.domain==="firebase.com"&&cn(n.host+" is no longer supported. Please use <YOUR FIREBASE>.firebaseio.com instead"),(!r||r==="undefined")&&n.domain!=="localhost"&&cn("Cannot parse Firebase url. Please use https://<YOUR FIREBASE>.firebaseio.com"),n.secure||vx();const i=n.scheme==="ws"||n.scheme==="wss";return{repoInfo:new Fg(n.host,n.secure,r,i,e,"",r!==n.subdomain),path:new he(n.pathString)}},dC=function(t){let e="",n="",r="",i="",s="",o=!0,l="https",a=443;if(typeof t=="string"){let u=t.indexOf("//");u>=0&&(l=t.substring(0,u-1),t=t.substring(u+2));let h=t.indexOf("/");h===-1&&(h=t.length);let f=t.indexOf("?");f===-1&&(f=t.length),e=t.substring(0,Math.min(h,f)),h<f&&(i=cC(t.substring(h,f)));const d=uC(t.substring(Math.min(t.length,f)));u=e.indexOf(":"),u>=0?(o=l==="https"||l==="wss",a=parseInt(e.substring(u+1),10)):u=e.length;const v=e.slice(0,u);if(v.toLowerCase()==="localhost")n="localhost";else if(v.split(".").length<=2)n=v;else{const x=e.indexOf(".");r=e.substring(0,x).toLowerCase(),n=e.substring(x+1),s=r}"ns"in d&&(s=d.ns)}return{host:e,port:a,domain:n,subdomain:r,secure:o,scheme:l,pathString:i,namespace:s}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Dh="-0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ_abcdefghijklmnopqrstuvwxyz",fC=function(){let t=0;const e=[];return function(n){const r=n===t;t=n;let i;const s=new Array(8);for(i=7;i>=0;i--)s[i]=Dh.charAt(n%64),n=Math.floor(n/64);A(n===0,"Cannot push at time == 0");let o=s.join("");if(r){for(i=11;i>=0&&e[i]===63;i--)e[i]=0;e[i]++}else for(i=0;i<12;i++)e[i]=Math.floor(Math.random()*64);for(i=0;i<12;i++)o+=Dh.charAt(e[i]);return A(o.length===20,"nextPushId: Length should be 20."),o}}();/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ry{constructor(e,n,r,i){this.eventType=e,this.eventRegistration=n,this.snapshot=r,this.prevName=i}getPath(){const e=this.snapshot.ref;return this.eventType==="value"?e._path:e.parent._path}getEventType(){return this.eventType}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.getPath().toString()+":"+this.eventType+":"+ze(this.snapshot.exportVal())}}class jy{constructor(e,n,r){this.eventRegistration=e,this.error=n,this.path=r}getPath(){return this.path}getEventType(){return"cancel"}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.path.toString()+":cancel"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ay{constructor(e,n){this.snapshotCallback=e,this.cancelCallback=n}onValue(e,n){this.snapshotCallback.call(null,e,n)}onCancel(e){return A(this.hasCancelCallback,"Raising a cancel event on a listener with no cancel callback"),this.cancelCallback.call(null,e)}get hasCancelCallback(){return!!this.cancelCallback}matches(e){return this.snapshotCallback===e.snapshotCallback||this.snapshotCallback.userCallback!==void 0&&this.snapshotCallback.userCallback===e.snapshotCallback.userCallback&&this.snapshotCallback.context===e.snapshotCallback.context}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xr{constructor(e,n,r,i){this._repo=e,this._path=n,this._queryParams=r,this._orderByCalled=i}get key(){return te(this._path)?null:Zu(this._path)}get ref(){return new Wt(this._repo,this._path)}get _queryIdentifier(){const e=_h(this._queryParams),n=Ku(e);return n==="{}"?"default":n}get _queryObject(){return _h(this._queryParams)}isEqual(e){if(e=dn(e),!(e instanceof xr))return!1;const n=this._repo===e._repo,r=Ju(this._path,e._path),i=this._queryIdentifier===e._queryIdentifier;return n&&r&&i}toJSON(){return this.toString()}toString(){return this._repo.toString()+tS(this._path)}}function hC(t,e){if(t._orderByCalled===!0)throw new Error(e+": You can't combine multiple orderBy calls.")}function Nd(t){let e=null,n=null;if(t.hasStart()&&(e=t.getIndexStartValue()),t.hasEnd()&&(n=t.getIndexEndValue()),t.getIndex()===ir){const r="Query: When ordering by key, you may only pass one argument to startAt(), endAt(), or equalTo().",i="Query: When ordering by key, the argument passed to startAt(), startAfter(), endAt(), endBefore(), or equalTo() must be a string.";if(t.hasStart()){if(t.getIndexStartName()!==dr)throw new Error(r);if(typeof e!="string")throw new Error(i)}if(t.hasEnd()){if(t.getIndexEndName()!==Ln)throw new Error(r);if(typeof n!="string")throw new Error(i)}}else if(t.getIndex()===ke){if(e!=null&&!ol(e)||n!=null&&!ol(n))throw new Error("Query: When ordering by priority, the first argument passed to startAt(), startAfter() endAt(), endBefore(), or equalTo() must be a valid priority value (null, a number, or a string).")}else if(A(t.getIndex()instanceof nd||t.getIndex()===ey,"unknown index type."),e!=null&&typeof e=="object"||n!=null&&typeof n=="object")throw new Error("Query: First argument passed to startAt(), startAfter(), endAt(), endBefore(), or equalTo() cannot be an object.")}function Dy(t){if(t.hasStart()&&t.hasEnd()&&t.hasLimit()&&!t.hasAnchoredLimit())throw new Error("Query: Can't combine startAt(), startAfter(), endAt(), endBefore(), and limit(). Use limitToFirst() or limitToLast() instead.")}class Wt extends xr{constructor(e,n){super(e,n,new id,!1)}get parent(){const e=Qg(this._path);return e===null?null:new Wt(this._repo,e)}get root(){let e=this;for(;e.parent!==null;)e=e.parent;return e}}class pr{constructor(e,n,r){this._node=e,this.ref=n,this._index=r}get priority(){return this._node.getPriority().val()}get key(){return this.ref.key}get size(){return this._node.numChildren()}child(e){const n=new he(e),r=si(this.ref,e);return new pr(this._node.getChild(n),r,ke)}exists(){return!this._node.isEmpty()}exportVal(){return this._node.val(!0)}forEach(e){return this._node.isLeafNode()?!1:!!this._node.forEachChild(this._index,(r,i)=>e(new pr(i,si(this.ref,r),ke)))}hasChild(e){const n=new he(e);return!this._node.getChild(n).isEmpty()}hasChildren(){return this._node.isLeafNode()?!1:!this._node.isEmpty()}toJSON(){return this.exportVal()}val(){return this._node.val()}}function B(t,e){return t=dn(t),t._checkNotDeleted("ref"),e!==void 0?si(t._root,e):t._root}function si(t,e){return t=dn(t),ee(t._path)===null?Hw("child","path",e):Cd("child","path",e),new Wt(t._repo,Ae(t._path,e))}function xs(t,e){t=dn(t),Dl("push",t._path),Al("push",e,t._path,!0);const n=Ny(t._repo),r=fC(n),i=si(t,r),s=si(t,r);let o;return e!=null?o=Ss(s,e).then(()=>s):o=Promise.resolve(s),i.then=o.then.bind(o),i.catch=o.then.bind(o,void 0),i}function Id(t){return Dl("remove",t._path),Ss(t,null)}function Ss(t,e){t=dn(t),Dl("set",t._path),Al("set",e,t._path,!1);const n=new di;return eC(t._repo,t._path,e,null,n.wrapCallback(()=>{})),n.promise}function je(t,e){Uw("update",e,t._path);const n=new di;return tC(t._repo,t._path,e,n.wrapCallback(()=>{})),n.promise}function Ft(t){t=dn(t);const e=new Ay(()=>{}),n=new zl(e);return Jw(t._repo,t,n).then(r=>new pr(r,new Wt(t._repo,t._path),t._queryParams.getIndex()))}class zl{constructor(e){this.callbackContext=e}respondsTo(e){return e==="value"}createEvent(e,n){const r=n._queryParams.getIndex();return new Ry("value",this,new pr(e.snapshotNode,new Wt(n._repo,n._path),r))}getEventRunner(e){return e.getEventType()==="cancel"?()=>this.callbackContext.onCancel(e.error):()=>this.callbackContext.onValue(e.snapshot,null)}createCancelEvent(e,n){return this.callbackContext.hasCancelCallback?new jy(this,e,n):null}matches(e){return e instanceof zl?!e.callbackContext||!this.callbackContext?!0:e.callbackContext.matches(this.callbackContext):!1}hasAnyCallback(){return this.callbackContext!==null}}class bd{constructor(e,n){this.eventType=e,this.callbackContext=n}respondsTo(e){let n=e==="children_added"?"child_added":e;return n=n==="children_removed"?"child_removed":n,this.eventType===n}createCancelEvent(e,n){return this.callbackContext.hasCancelCallback?new jy(this,e,n):null}createEvent(e,n){A(e.childName!=null,"Child events should have a childName.");const r=si(new Wt(n._repo,n._path),e.childName),i=n._queryParams.getIndex();return new Ry(e.type,this,new pr(e.snapshotNode,r,i),e.prevName)}getEventRunner(e){return e.getEventType()==="cancel"?()=>this.callbackContext.onCancel(e.error):()=>this.callbackContext.onValue(e.snapshot,e.prevName)}matches(e){return e instanceof bd?this.eventType===e.eventType&&(!this.callbackContext||!e.callbackContext||this.callbackContext.matches(e.callbackContext)):!1}hasAnyCallback(){return!!this.callbackContext}}function Oy(t,e,n,r,i){const s=new Ay(n,void 0),o=e==="value"?new zl(s):new bd(e,s);return rC(t._repo,t,o),()=>iC(t._repo,t,o)}function be(t,e,n,r){return Oy(t,"value",e)}function pC(t,e,n,r){return Oy(t,"child_added",e)}class Bl{}class mC extends Bl{constructor(e,n){super(),this._value=e,this._key=n,this.type="endAt"}_apply(e){Al("endAt",this._value,e._path,!0);const n=TS(e._queryParams,this._value,this._key);if(Dy(n),Nd(n),e._queryParams.hasEnd())throw new Error("endAt: Starting point was already set (by another call to endAt, endBefore or equalTo).");return new xr(e._repo,e._path,n,e._orderByCalled)}}function My(t,e){return new mC(t,e)}class gC extends Bl{constructor(e,n){super(),this._value=e,this._key=n,this.type="startAt"}_apply(e){Al("startAt",this._value,e._path,!0);const n=ES(e._queryParams,this._value,this._key);if(Dy(n),Nd(n),e._queryParams.hasStart())throw new Error("startAt: Starting point was already set (by another call to startAt, startBefore or equalTo).");return new xr(e._repo,e._path,n,e._orderByCalled)}}function yC(t=null,e){return new gC(t,e)}class vC extends Bl{constructor(e){super(),this._limit=e,this.type="limitToLast"}_apply(e){if(e._queryParams.hasLimit())throw new Error("limitToLast: Limit was already set (by another call to limitToFirst or limitToLast).");return new xr(e._repo,e._path,kS(e._queryParams,this._limit),e._orderByCalled)}}function Ly(t){if(typeof t!="number"||Math.floor(t)!==t||t<=0)throw new Error("limitToLast: First argument must be a positive integer.");return new vC(t)}class _C extends Bl{constructor(e){super(),this._path=e,this.type="orderByChild"}_apply(e){hC(e,"orderByChild");const n=new he(this._path);if(te(n))throw new Error("orderByChild: cannot pass in empty path. Use orderByValue() instead.");const r=new nd(n),i=NS(e._queryParams,r);return Nd(i),new xr(e._repo,e._path,i,!0)}}function Wl(t){if(t==="$key")throw new Error('orderByChild: "$key" is invalid.  Use orderByKey() instead.');if(t==="$priority")throw new Error('orderByChild: "$priority" is invalid.  Use orderByPriority() instead.');if(t==="$value")throw new Error('orderByChild: "$value" is invalid.  Use orderByValue() instead.');return Cd("orderByChild","path",t),new _C(t)}function $l(t,...e){let n=dn(t);for(const r of e)n=r._apply(n);return n}mw(Wt);xw(Wt);/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xC="FIREBASE_DATABASE_EMULATOR_HOST",Hc={};let SC=!1;function wC(t,e,n,r){const i=e.lastIndexOf(":"),s=e.substring(0,i),o=Vu(s);t.repoInfo_=new Fg(e,o,t.repoInfo_.namespace,t.repoInfo_.webSocketOnly,t.repoInfo_.nodeAdmin,t.repoInfo_.persistenceKey,t.repoInfo_.includeNamespaceInQueryParams,!0,n),r&&(t.authTokenProvider_=r)}function CC(t,e,n,r,i){let s=r||t.options.databaseURL;s===void 0&&(t.options.projectId||cn("Can't determine Firebase Database URL. Be sure to include  a Project ID when calling firebase.initializeApp()."),Qe("Using default host for project ",t.options.projectId),s=`${t.options.projectId}-default-rtdb.firebaseio.com`);let o=Ah(s,i),l=o.repoInfo,a;typeof process<"u"&&th&&(a=th[xC]),a?(s=`http://${a}?ns=${l.namespace}`,o=Ah(s,i),l=o.repoInfo):o.repoInfo.secure;const u=new bx(t.name,t.options,e);Vw("Invalid Firebase Database URL",o),te(o.path)||cn("Database URL must point to the root of a Firebase Database (not including a child path).");const h=EC(l,t,u,new Ix(t,n));return new TC(h,t)}function kC(t,e){const n=Hc[e];(!n||n[t.key]!==t)&&cn(`Database ${e}(${t.repoInfo_}) has already been deleted.`),sC(t),delete n[t.key]}function EC(t,e,n,r){let i=Hc[e.name];i||(i={},Hc[e.name]=i);let s=i[t.toURLString()];return s&&cn("Database initialized multiple times. Please make sure the format of the database URL matches with each database() call."),s=new qw(t,SC,n,r),i[t.toURLString()]=s,s}class TC{constructor(e,n){this._repoInternal=e,this.app=n,this.type="database",this._instanceStarted=!1}get _repo(){return this._instanceStarted||(Xw(this._repoInternal,this.app.options.appId,this.app.options.databaseAuthVariableOverride),this._instanceStarted=!0),this._repoInternal}get _root(){return this._rootInternal||(this._rootInternal=new Wt(this._repo,ae())),this._rootInternal}_delete(){return this._rootInternal!==null&&(kC(this._repo,this.app.name),this._repoInternal=null,this._rootInternal=null),Promise.resolve()}_checkNotDeleted(e){this._rootInternal===null&&cn("Cannot call "+e+" on a deleted database.")}}function NC(t=ex(),e){const n=Y1(t,"database").getImmediate({identifier:e});if(!n._instanceStarted){const r=D0("database");r&&IC(n,...r)}return n}function IC(t,e,n,r={}){t=dn(t),t._checkNotDeleted("useEmulator");const i=`${e}:${n}`,s=t._repoInternal;if(t._instanceStarted){if(i===t._repoInternal.repoInfo_.host&&Vo(r,s.repoInfo_.emulatorOptions))return;cn("connectDatabaseEmulator() cannot initialize or alter the emulator configuration after the database instance has started.")}let o;if(s.repoInfo_.nodeAdmin)r.mockUserToken&&cn('mockUserToken is not supported by the Admin SDK. For client access with mock users, please use the "firebase" package instead of "firebase-admin".'),o=new go(go.OWNER);else if(r.mockUserToken){const l=typeof r.mockUserToken=="string"?r.mockUserToken:M0(r.mockUserToken,t.app.options.projectId);o=new go(l)}Vu(e)&&(O0(e),z0("Database",!0)),wC(s,i,r,o)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function bC(t){hx(J1),Go(new us("database",(e,{instanceIdentifier:n})=>{const r=e.getProvider("app").getImmediate(),i=e.getProvider("auth-internal"),s=e.getProvider("app-check-internal");return CC(r,i,s,n)},"PUBLIC").setMultipleInstances(!0)),Gr(nh,rh,t),Gr(nh,rh,"esm2017")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const PC={".sv":"timestamp"};function Dn(){return PC}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class RC{constructor(e,n){this.committed=e,this.snapshot=n}toJSON(){return{committed:this.committed,snapshot:this.snapshot.toJSON()}}}function nn(t,e,n){var r;if(t=dn(t),Dl("Reference.transaction",t._path),t.key===".length"||t.key===".keys")throw"Reference.transaction failed: "+t.key+" is a read-only object.";const i=(r=void 0)!==null&&r!==void 0?r:!0,s=new di,o=(a,u,h)=>{let f=null;a?s.reject(a):(f=new pr(h,new Wt(t._repo,t._path),ke),s.resolve(new RC(u,f)))},l=be(t,()=>{});return oC(t._repo,t._path,e,o,l,i),s.promise}tn.prototype.simpleListen=function(t,e){this.sendRequest("q",{p:t},e)};tn.prototype.echo=function(t,e){this.sendRequest("echo",{d:t},e)};bC();const jC={apiKey:"AIzaSyCMC0bKqZY9vVxC2a_yGWV1fGnmNSGTYlo",authDomain:"karak-pos-v4.firebaseapp.com",databaseURL:"https://karak-pos-v4-default-rtdb.asia-southeast1.firebasedatabase.app",projectId:"karak-pos-v4",storageBucket:"karak-pos-v4.firebasestorage.app",messagingSenderId:"149652853063",appId:"1:149652853063:web:d8f6e223aa76a6aa503c62"},AC=Xf().length?Xf()[0]:xg(jC),W=NC(AC);function Pd(t){const e=B(W,"alerts"),n=xs(e),r=Ss(n,{...t,createdAt:Dn()});return r.then(()=>{try{setTimeout(()=>{Id(n).catch(()=>{})},30*1e3)}catch{}}).catch(()=>{}),r}const DC=()=>{const t=I.useRef({sound:!0,vibrate:!0});return I.useEffect(()=>{const e=be(B(W,"settings/alerts"),n=>{const r=n.val()||{};t.current={sound:r.sound!==!1,vibrate:r.vibrate!==!1}});return()=>e()},[]),I.useEffect(()=>{const e=B(W,"alerts"),n=pC(e,()=>{lg()&&t.current.sound&&S0()&&x0(),t.current.vibrate&&navigator.vibrate&&navigator.vibrate([300,200,300,200,500])});return()=>{n()}},[]),null},OC={Karak:{"Paper Cup (Regular)":.4,"Glass Cup (Small)":.5,"Glass Cup (Large)":.6},Almohib:{"Paper Cup (Regular)":.3,"Glass Cup (Small)":.4,"Glass Cup (Large)":.5},"Red Tea":{"Paper Cup (Regular)":.3,"Glass Cup (Small)":.4,"Glass Cup (Large)":.5},Lemon:{"Paper Cup (Regular)":.3,"Glass Cup (Small)":.4,"Glass Cup (Large)":.5},"Cold Drink":{"Paper Cup (Regular)":0,"Glass Cup (Small)":0,"Glass Cup (Large)":0},Sweets:{"Paper Cup (Regular)":0,"Glass Cup (Small)":0,"Glass Cup (Large)":0}},MC={"Passion Fruit Mojito":.8,"Blue Mojito":.8,"Hibiscus (Karkadeh)":.7,"Drinking Water":.1},LC=["Biscuit / Other (0.100)","Castir (0.600)","Cookies (0.600)"],Vc={"Biscuit / Other (0.100)":.1,"Castir (0.600)":.6,"Cookies (0.600)":.6},FC={"Paper Cup (Regular)":200,"Glass Cup (Small)":175,"Glass Cup (Large)":210},Oh={hot:{cupType:"Paper Cup (Regular)",sugar:"Medium Sugar (Standard)"}},oi={"Paper Cup (Regular)":.015,"Glass Cup (Small)":.005,"Glass Cup (Large)":.005,Karak:.03,Almohib:.03,"Red Tea":.01,Lemon:.015,"Passion Fruit Mojito":.25,"Blue Mojito":.25,"Hibiscus (Karkadeh)":.15,"Drinking Water":.04,"Biscuit / Other (0.100)":.1,"Castir (0.600)":.35,"Cookies (0.600)":.35};function zC(t,e){const n=e||oi;let r=0,i=0;if(t.drinkType==="Cold Drink"){if(!t.coldDrinkName)throw new Error("Cold drink name required");r=MC[t.coldDrinkName]||0,i=n[t.coldDrinkName]||0}else if(t.drinkType==="Sweets"){if(!t.sweetsOption)throw new Error("Sweets option required");r=typeof t.customPrice=="number"?t.customPrice:Vc[t.sweetsOption],i=n[t.sweetsOption]||r*.5}else{if(!t.cupType)throw new Error("Cup type required");r=OC[t.drinkType][t.cupType];const l=n[t.cupType]||0,a=n[t.drinkType]||0;i=l+a}const s=+(r*t.quantity).toFixed(3),o=+(i*t.quantity).toFixed(3);return{unitPrice:r,totalPrice:s,totalCost:o}}const ba=["Karak","Almohib","Red Tea","Lemon","Cold Drink","Sweets"],BC=["Paper Cup (Regular)","Glass Cup (Small)","Glass Cup (Large)"],WC=["No Sugar","Light Sugar","Medium Sugar (Standard)","Extra Sugar"],$C=["Standard Red Tea","Habak with mint Tea","Habak Tea","Mint Tea"],UC=["Passion Fruit Mojito","Blue Mojito","Hibiscus (Karkadeh)","Drinking Water"];function Y(t){return`${(typeof t=="number"?t:0).toFixed(3)} BHD`}const yo=({type:t,size:e=24})=>{switch(t){case"Karak":return c.jsxs("svg",{width:e,height:e,viewBox:"0 0 24 24",fill:"none",children:[c.jsx("circle",{cx:"12",cy:"12",r:"8",fill:"#fbbf24",stroke:"#b45309",strokeWidth:"2"}),c.jsx("ellipse",{cx:"12",cy:"14",rx:"5.5",ry:"2.5",fill:"#fff7ed"}),c.jsx("ellipse",{cx:"12",cy:"12.5",rx:"5",ry:"2",fill:"#f59e42"})]});case"Almohib":case"Almohib Tea":return c.jsxs("svg",{width:e,height:e,viewBox:"0 0 24 24",fill:"none",children:[c.jsx("rect",{x:"4",y:"8",width:"16",height:"10",rx:"5",fill:"#a7f3d0",stroke:"#065f46",strokeWidth:"2"}),c.jsx("ellipse",{cx:"12",cy:"13",rx:"6",ry:"2.5",fill:"#34d399"})]});case"Red Tea":return c.jsxs("svg",{width:e,height:e,viewBox:"0 0 24 24",fill:"none",children:[c.jsx("rect",{x:"4",y:"8",width:"16",height:"10",rx:"5",fill:"#fee2e2",stroke:"#b91c1c",strokeWidth:"2"}),c.jsx("ellipse",{cx:"12",cy:"13",rx:"6",ry:"2.5",fill:"#f87171"})]});case"Lemon":return c.jsxs("svg",{width:e,height:e,viewBox:"0 0 24 24",fill:"none",children:[c.jsx("circle",{cx:"12",cy:"12",r:"8",fill:"#fef08a",stroke:"#ca8a04",strokeWidth:"2"}),c.jsx("ellipse",{cx:"12",cy:"12",rx:"4",ry:"5",fill:"#fde047"}),c.jsx("circle",{cx:"9",cy:"10",r:"1",fill:"#fff",opacity:"0.8"})]});case"Cold Drink":return c.jsxs("svg",{width:e,height:e,viewBox:"0 0 24 24",fill:"none",children:[c.jsx("rect",{x:"6",y:"6",width:"12",height:"12",rx:"6",fill:"#bae6fd",stroke:"#0ea5e9",strokeWidth:"2"}),c.jsx("ellipse",{cx:"12",cy:"13",rx:"5",ry:"2",fill:"#38bdf8"})]});case"Sweets":return c.jsxs("svg",{width:e,height:e,viewBox:"0 0 24 24",fill:"none",children:[c.jsx("circle",{cx:"12",cy:"12",r:"8",fill:"#fed7aa",stroke:"#c2410c",strokeWidth:"2"}),c.jsx("circle",{cx:"12",cy:"12",r:"4.5",fill:"#fef3c7"}),c.jsx("circle",{cx:"12",cy:"12",r:"2",fill:"#fff",opacity:"0.6"})]});default:return c.jsx("svg",{width:e,height:e,viewBox:"0 0 24 24",fill:"none",children:c.jsx("circle",{cx:"12",cy:"12",r:"10",fill:"#e5e7eb",stroke:"#9ca3af",strokeWidth:"2"})})}};function Fy(){const[t,e]=ue.useState(oi),[n,r]=ue.useState(!0);return ue.useEffect(()=>{const s=B(W,"settings/costs"),o=be(s,l=>{const a=l.val()||{};e({...oi,...a}),r(!1)});return()=>o()},[]),{costs:t,loading:n,updateCost:async(s,o)=>{const l=parseFloat(o.toFixed(3));await je(B(W,"settings/costs"),{[s]:l})}}}function no(){var t,e;return((e=(t=globalThis.crypto)==null?void 0:t.randomUUID)==null?void 0:e.call(t))??Math.random().toString(36).slice(2)}function HC(){try{Pd({type:"ready",message:"Call"})}catch{}}const VC=()=>{const[t,e]=I.useState(""),[n,r]=I.useState(""),[i,s]=I.useState(""),[o,l]=I.useState(null),[a,u]=I.useState(void 0),[h,f]=I.useState(void 0),[d,v]=I.useState(void 0),[x,g]=I.useState(void 0),[E,y]=I.useState(void 0),[p,m]=I.useState(void 0),[_,k]=I.useState(1),[w,C]=I.useState([]),[N,O]=I.useState(!1),[L,V]=I.useState(0),{costs:J}=Fy();function se(S){const Q=new Date(Date.UTC(S.getFullYear(),S.getMonth(),S.getDate())),X=Q.getUTCDay()||7;Q.setUTCDate(Q.getUTCDate()+4-X);const z=new Date(Date.UTC(Q.getUTCFullYear(),0,1)),ie=Math.ceil(((Q.getTime()-z.getTime())/864e5+1)/7);return`${Q.getUTCFullYear()}-W${String(ie).padStart(2,"0")}`}I.useEffect(()=>{if(!t||t.length!==3){V(0),s("");return}const S=B(W,`loyalty/${t}/count`);Ft(S).then(X=>{const z=typeof X.val()=="number"?X.val():0;if(V(z),z>0){const ie="".repeat(Math.min(z,5));alert(`${ie}  !   ${z+1}`)}});const Q=B(W,`plateNotes/${t}`);Ft(Q).then(X=>{if(!X.exists()){s("");return}const z=X.val();let ie="",pe=0;z&&typeof z=="object"&&Object.keys(z).forEach(Z=>{const M=z[Z];M&&typeof M=="object"&&M.note&&M.updatedAt&&M.updatedAt>pe&&(ie=M.note,pe=M.updatedAt)}),ie?(s(ie),n||r(ie)):s("")}).catch(()=>{s("")})},[t]);const Ee=S=>{const Q=S.target.value.replace(/\D/g,"").slice(0,3);e(Q)},Te=()=>{u(void 0),f(void 0),v(void 0),g(void 0),y(void 0),m(void 0),k(1)},de=S=>{l(S),S==="Karak"||S==="Almohib"||S==="Red Tea"||S==="Lemon"?(u(Oh.hot.cupType),f(Oh.hot.sugar),v(S==="Red Tea"?"Standard Red Tea":void 0),g(void 0),y(void 0),m(void 0)):S==="Cold Drink"?(g(void 0),u(void 0),f(void 0),v(void 0),y(void 0),m(void 0)):S==="Sweets"&&(u(void 0),f(void 0),v(void 0),g(void 0),y("Biscuit / Other (0.100)"),m(Vc["Biscuit / Other (0.100)"])),k(1)},xe=I.useMemo(()=>o?o==="Cold Drink"?!!x&&_>0:o==="Sweets"?!!(E&&p&&p>0)&&_>0:o==="Red Tea"?!!(a&&h&&d)&&_>0:!!(a&&h)&&_>0:!1,[o,a,h,d,x,E,p,_]),D=()=>{if(!o)return;const S={drinkType:o,cupType:a,sugar:h,teaType:o==="Red Tea"?d:void 0,coldDrinkName:x,sweetsOption:E,customPrice:p,quantity:_},Q=zC(S,J),X={kind:"item",id:no(),...S,...Q};C(z=>[...z,X])},G=()=>{const S={kind:"separator",id:no()};C(Q=>[...Q,S]),e("")},b=S=>C(Q=>Q.filter(X=>X.id!==S)),U=w.reduce((S,Q)=>Q.kind==="item"?S+Q.totalPrice:S,0);async function F(){if(w.length!==0){O(!0);try{const S=no(),Q=B(W,"orders"),X=[];for(const M of w){let T;M.kind==="separator"?(T={type:"separator",createdAt:Dn(),batchId:S},t&&(T.licensePlate=t),n&&(T.notes=n)):(T={type:"item",status:"preparing",createdAt:Dn(),drinkType:M.drinkType,quantity:M.quantity,unitPrice:M.unitPrice,totalPrice:M.totalPrice,totalCost:M.totalCost,batchId:S},M.cupType&&(T.cupType=M.cupType),M.sugar&&(T.sugar=M.sugar),M.teaType&&(T.teaType=M.teaType),M.coldDrinkName&&(T.coldDrinkName=M.coldDrinkName),M.sweetsOption&&(T.sweetsOption=M.sweetsOption),typeof M.customPrice=="number"&&(T.customPrice=M.customPrice),t&&(T.licensePlate=t),n&&(T.notes=n));const j=xs(Q);X.push(Ss(j,T))}if(await Promise.all(X),t&&n.trim()){const T=se(new Date);await je(B(W),{[`plateNotes/${t}/${T}/note`]:n.trim(),[`plateNotes/${t}/${T}/updatedAt`]:Date.now()})}const z={karak:0,almohib:0,otherTeas:0};let ie=0;for(const M of w)if(M.kind==="item"){if(M.cupType){const j=(FC[M.cupType]||0)*(M.quantity||0);M.drinkType==="Karak"?z.karak+=j:M.drinkType==="Almohib"?z.almohib+=j:M.drinkType==="Red Tea"&&(z.otherTeas+=j)}(M.drinkType==="Karak"||M.drinkType==="Almohib"||M.drinkType==="Red Tea")&&(ie+=M.quantity||0)}await nn(B(W,"stats/thermos"),M=>{var j,$,oe;if(!M)return M;const T={...M};return T.karak={...M.karak,currentLevel_ml:Math.max(0,(((j=M.karak)==null?void 0:j.currentLevel_ml)??3e3)-z.karak)},T.almohib={...M.almohib,currentLevel_ml:Math.max(0,((($=M.almohib)==null?void 0:$.currentLevel_ml)??3e3)-z.almohib)},T.otherTeas={...M.otherTeas,currentLevel_ml:Math.max(0,(((oe=M.otherTeas)==null?void 0:oe.currentLevel_ml)??3e3)-z.otherTeas)},T});let pe=0;for(const M of w)M.kind==="item"&&M.drinkType==="Cold Drink"&&(M.coldDrinkName==="Passion Fruit Mojito"||M.coldDrinkName==="Blue Mojito"||M.coldDrinkName==="Hibiscus (Karkadeh)")&&(pe+=.04*(M.quantity||0));pe>0&&await nn(B(W,"stats/inventory/syrups__all_flavors_"),M=>Math.max(0,(M||0)-pe)),ie>0&&await nn(B(W,"stats/inventory/paperCups"),M=>(M||0)-ie),Pd({type:"placed",message:"New order placed"}),C([]),r(""),Te(),l(null),s("");const Z=document.getElementById("kanban");if(Z){const M=Z.getBoundingClientRect(),T=window.innerHeight*.2;window.scrollBy({top:T,behavior:"smooth"})}if(typeof window<"u"){try{new Audio("/beep.mp3").play().catch(()=>{})}catch{}navigator.vibrate&&navigator.vibrate(300)}}catch(S){console.error(S),alert("    ")}finally{O(!1)}}}const q=I.useRef(0);return I.useEffect(()=>{const S=B(W,"stats/lastAutoSeparatorAt"),Q=be(S,ie=>{const pe=ie.val();typeof pe=="number"&&(q.current=pe)}),X=B(W,"orders"),z=be(X,ie=>{const pe=ie.val()||{},Z=Object.entries(pe).map(([j,$])=>({id:j,...$}));let M=0,T=0;for(const j of Z){const $=typeof j.createdAt=="number"?j.createdAt:0;j.type==="item"&&$>M&&(M=$),j.type==="separator"&&$>T&&(T=$)}if(M>0){const j=Date.now(),$=j-M,oe=2*60*1e3;if($>oe&&T<M&&j-q.current>oe){const me={type:"separator",createdAt:Dn(),batchId:no(),auto:!0},De=xs(B(W,"orders"));Ss(De,me).then(()=>(q.current=j,je(B(W),{"stats/lastAutoSeparatorAt":j}))).catch(()=>{})}}});return()=>{z(),Q()}},[]),c.jsxs("section",{className:"card",style:{width:"100%",boxShadow:"0 2px 12px rgba(0,0,0,0.06)"},children:[c.jsxs("h2",{className:"section-title",style:{display:"flex",justifyContent:"space-between",alignItems:"baseline",marginBottom:4},children:[c.jsx("span",{children:" "}),c.jsx("span",{style:{fontSize:14,color:"#64748b",fontWeight:500},children:"New Order"})]}),c.jsxs("div",{className:"col",style:{gap:12},children:[c.jsxs("div",{className:"col",children:[c.jsx("label",{className:"group-title",children:" "}),c.jsx("input",{className:"input",placeholder:" 3  (: 123)",value:t,onChange:Ee,inputMode:"numeric",pattern:"[0-9]*",maxLength:3}),c.jsx("span",{className:"help",children:L>0?`  !   ${L+1}`:"  3   "}),i&&c.jsxs("div",{className:"help",style:{color:"#0ea5e9",fontWeight:600},children:[" ",i]})]}),c.jsxs("div",{className:"col",children:[c.jsx("label",{className:"group-title",children:" "}),c.jsx("div",{className:"chips",style:{gap:6},children:c.jsxs("div",{style:{display:"flex",gap:6,overflowX:"auto",paddingBottom:4,scrollBehavior:"smooth"},children:[ba.filter(S=>S!=="Cold Drink"&&S!=="Sweets").map(S=>c.jsxs("button",{className:`chip ${o===S?"active":""}`,onClick:()=>de(S),style:{display:"flex",alignItems:"center",gap:4,flexShrink:0},children:[c.jsx(yo,{type:S,size:24}),S]},S)),ba.filter(S=>S==="Sweets").map(S=>c.jsxs("button",{className:`chip ${o===S?"active":""}`,onClick:()=>de(S),style:{display:"flex",alignItems:"center",gap:4,background:"#fef3c7",border:"2px solid #fbbf24",flexShrink:0},children:[c.jsx(yo,{type:S,size:24}),S]},S)),ba.filter(S=>S==="Cold Drink").map(S=>c.jsxs("button",{className:`chip ${o===S?"active":""}`,onClick:()=>de(S),style:{display:"flex",alignItems:"center",gap:4,background:"#e0f2fe",border:"2px solid #0ea5e9",flexShrink:0},children:[c.jsx(yo,{type:S,size:24}),S]},S))]})})]}),o&&(o==="Karak"||o==="Almohib"||o==="Red Tea"||o==="Lemon")&&c.jsxs("div",{className:"col",children:[o==="Red Tea"&&c.jsxs("div",{className:"col",children:[c.jsx("label",{className:"group-title",children:" "}),c.jsx("div",{className:"chips",children:$C.map(S=>c.jsx("button",{className:`chip ${d===S?"active":""}`,onClick:()=>v(S),children:S},S))})]}),c.jsxs("div",{className:"col",children:[c.jsx("label",{className:"group-title",children:" "}),c.jsx("div",{className:"chips",children:BC.map(S=>c.jsx("button",{className:`chip ${a===S?"active":""}`,onClick:()=>u(S),children:S},S))})]}),c.jsxs("div",{className:"col",children:[c.jsx("label",{className:"group-title",children:""}),c.jsx("div",{className:"chips",children:WC.map(S=>c.jsx("button",{className:`chip ${h===S?"active":""}`,onClick:()=>f(S),children:S},S))})]})]}),o==="Cold Drink"&&c.jsxs("div",{className:"col",children:[c.jsx("label",{className:"group-title",children:" "}),c.jsx("div",{className:"chips",children:UC.map(S=>c.jsx("button",{className:`chip ${x===S?"active":""}`,onClick:()=>g(S),children:S},S))})]}),o==="Sweets"&&c.jsxs("div",{className:"col",children:[c.jsx("label",{className:"group-title",children:" "}),c.jsx("div",{className:"chips",children:LC.map(S=>c.jsx("button",{className:`chip ${E===S?"active":""}`,onClick:()=>{y(S),m(Vc[S])},children:S},S))}),E&&c.jsxs("div",{className:"col",style:{marginTop:8},children:[c.jsx("label",{className:"group-title",children:""}),c.jsxs("div",{className:"row",style:{alignItems:"center",justifyContent:"center",gap:12},children:[c.jsx("button",{className:"btn btn-outline",style:{fontSize:18,padding:"4px 12px"},onClick:()=>m(Math.max(.1,(p||0)-.1)),children:"0.100"}),c.jsx("span",{style:{fontSize:20,minWidth:80,textAlign:"center",fontWeight:700},children:Y(p||0)}),c.jsx("button",{className:"btn btn-outline",style:{fontSize:18,padding:"4px 12px"},onClick:()=>m((p||0)+.1),children:"+0.100"})]}),c.jsxs("div",{className:"help",style:{textAlign:"center",marginTop:4},children:[E==="Biscuit / Other (0.100)"&&" : 0.100 | : 0.100",E==="Castir (0.600)"&&" : 0.600 | : 0.100",E==="Cookies (0.600)"&&" : 0.600 | : 0.100"]})]})]}),c.jsxs("div",{className:"col",children:[c.jsx("label",{className:"group-title",children:""}),c.jsxs("div",{className:"row",style:{alignItems:"center",justifyContent:"center",gap:12,marginTop:4},children:[c.jsx("button",{className:"btn btn-outline",style:{fontSize:20,padding:"2px 12px"},onClick:()=>k(Math.max(1,_-1)),children:""}),c.jsx("span",{style:{fontSize:20,minWidth:32,textAlign:"center",fontWeight:700},children:_}),c.jsx("button",{className:"btn btn-outline",style:{fontSize:20,padding:"2px 12px"},onClick:()=>k(Math.min(99,_+1)),children:"+"})]})]}),c.jsxs("div",{className:"row",style:{justifyContent:"space-between",gap:8},children:[c.jsx("button",{className:"btn btn-outline",onClick:G,children:"---   ---"}),c.jsx("button",{className:"btn btn-primary",style:{padding:"8px 16px",fontWeight:600},onClick:()=>HC(),children:" "}),c.jsx("button",{className:"btn btn-primary",disabled:!xe,onClick:D,children:"  "})]}),c.jsxs("div",{className:"col",children:[c.jsx("label",{className:"group-title",children:""}),c.jsx("input",{className:"input",placeholder:"",value:n,onChange:S=>r(S.target.value)})]}),c.jsxs("div",{className:"col",children:[c.jsx("label",{className:"group-title",children:""}),c.jsxs("div",{className:"cart",children:[w.length===0&&c.jsx("div",{className:"help",children:" "}),w.map(S=>S.kind==="separator"?c.jsx("div",{className:"cart-sep",children:"---   ---"},S.id):c.jsxs("div",{className:"cart-item",children:[c.jsxs("div",{children:[c.jsxs("div",{style:{fontWeight:700},children:[S.drinkType,"  ",S.quantity]}),c.jsx("div",{className:"help",children:S.drinkType==="Cold Drink"?S.coldDrinkName:S.drinkType==="Sweets"?`${S.sweetsOption} @ ${Y(S.customPrice||0)}`:S.drinkType==="Red Tea"?[S.teaType,S.cupType,S.sugar].filter(Boolean).join("  "):[S.cupType,S.sugar].filter(Boolean).join("  ")})]}),c.jsxs("div",{className:"row",style:{gap:8},children:[c.jsx("div",{style:{minWidth:72,textAlign:"end",fontWeight:700},children:Y(S.totalPrice)}),c.jsx("button",{className:"btn btn-danger",onClick:()=>b(S.id),children:""})]})]},S.id)),c.jsxs("div",{className:"total",children:[c.jsx("div",{children:""}),c.jsx("div",{children:Y(U)})]})]})]}),c.jsx("button",{className:"btn btn-accent",disabled:w.length===0||N,onClick:F,children:" "})]})]})};async function GC(t){const e=new Date(t+"T00:00:00").getTime(),n=e+24*60*60*1e3-1,r=B(W,"orders"),i=$l(r,Wl("completedAt"),yC(e),My(n));return(await Ft(i)).val()||{}}async function Mh(t=200){const e=B(W,"orders"),n=$l(e,Wl("completedAt"),Ly(t));return(await Ft(n)).val()||{}}const zy=I.createContext({lang:"ar",setLang:()=>{},t:t=>t}),Hn=()=>I.useContext(zy),QC=({children:t})=>{const[e,n]=I.useState(()=>{try{const s=localStorage.getItem("app-lang");return s==="ar"||s==="en"?s:"en"}catch{return"en"}});I.useEffect(()=>{const s=be(B(W,"settings/lang"),o=>{const l=o.val(),a=l==="ar"||l==="en"?l:"en";n(a);try{localStorage.setItem("app-lang",a)}catch{}});return()=>s()},[]);const r=async s=>{try{localStorage.setItem("app-lang",s)}catch{}await je(B(W),{"settings/lang":s})},i=(s,o)=>e==="en"?o:s;return c.jsx(zy.Provider,{value:{lang:e,setLang:r,t:i},children:t})};function KC(t){return t.getHours()*60+t.getMinutes()}function Lh(t){const e=Math.floor(t/60),n=t%60,r=(e+11)%12+1,i=e>=12?"PM":"AM",s=n.toString().padStart(2,"0");return`${r}:${s} ${i}`}function YC(t){const e=Math.floor(t/60),n=t%60,r=(e+11)%12+1;return n===0?`${r}`:n===30?`${r}`:n===15?`${r}`:n===45?`${r}`:`${r}:${n}`}const vo=17*60,By=25*60,Wy=15,qn=[];for(let t=vo;t<=By;t+=Wy)qn.push(t);function qC(t,e=0){const n=new Array(qn.length).fill(0);for(const r of t){if(r.type!=="item")continue;const i=typeof r.createdAt=="number"?r.createdAt:0;if(!i)continue;const s=i-e,o=new Date(s);let l=KC(o);if(l<vo&&(l+=24*60),l<vo||l>By)continue;const a=Math.floor((l-vo)/Wy);a>=0&&a<n.length&&(n[a]+=1)}return n}const XC=()=>{const{t}=Hn(),[e,n]=I.useState(new Array(qn.length).fill(0)),[r,i]=I.useState(null),[s,o]=I.useState(0),[l,a]=I.useState(null);I.useEffect(()=>{const C=be(B(W,"stats/rush/resetAt"),J=>{const se=J.val();i(typeof se=="number"?se:null)}),N=be(B(W,".info/serverTimeOffset"),J=>{const se=J.val();o(typeof se=="number"?se:0)}),O=B(W,"orders"),L=$l(O,Wl("createdAt"),Ly(200)),V=be(L,J=>{const se=J.val()||{};let Ee=Object.values(se);r&&(Ee=Ee.filter(de=>de.type==="item"&&typeof de.createdAt=="number"&&de.createdAt>=r));const Te=qC(Ee,s);n(Te)});return()=>{C(),V(),N()}},[r,s]);const u=Math.max(1,...e),h=340,f=140,d=20,v=45,x=h-d*2,g=f-d-v,E=x/(e.length-1),y=e.map((C,N)=>{const O=d+N*E,L=d+g-C/u*g;return`${O},${L}`}),p=`M ${d},${d+g} L ${y.join(" L ")} L ${d+x},${d+g} Z`,m=[];for(let C=0;C<qn.length;C+=4){const N=qn[C],O=d+C*E,L=YC(N%(24*60));m.push({x:O,text:L})}const _=C=>{const O=C.currentTarget.getBoundingClientRect(),L=C.clientX-O.left,V=C.clientY-O.top;let J=-1,se=1/0;const Ee=C.pointerType==="touch"?50:30;for(let Te=0;Te<e.length;Te++){const de=d+Te*E,xe=d+g-e[Te]/u*g,D=Math.sqrt((L-de)**2+(V-xe)**2);D<se&&D<Ee&&(se=D,J=Te)}if(J>=0){const Te=d+J*E,de=d+g-e[J]/u*g,xe=Lh(qn[J]%(24*60)),D=e[J];a({x:Te,y:de,text:`${xe}
${D} ${t("","order")}${D!==1?t("","s"):""}`})}else a(null)},k=()=>{a(null)},w=C=>{const N=d+C*E,O=d+g-e[C]/u*g,L=Lh(qn[C]%(24*60)),V=e[C];a({x:N,y:O,text:`${L}
${V} ${t("","order")}${V!==1?t("","s"):""}`})};return c.jsxs("section",{className:"card",children:[c.jsxs("div",{className:"row",style:{justifyContent:"space-between",alignItems:"center"},children:[c.jsxs("h2",{className:"section-title",style:{margin:0},children:[" ",t(" ","Rush Hour")]}),c.jsx("button",{className:"btn btn-outline",onClick:()=>je(B(W),{"stats/rush/resetAt":Dn()}),children:t("  ","Reset Period")})]}),c.jsxs("div",{className:"col",style:{gap:8},children:[c.jsxs("svg",{width:h,height:f,role:"img","aria-label":"Hourly Sales Chart",style:{display:"block",margin:"0 auto",cursor:"pointer",touchAction:"none"},onPointerMove:_,onPointerLeave:k,children:[c.jsxs("defs",{children:[c.jsxs("linearGradient",{id:"wavefill",x1:"0",y1:"0",x2:"0",y2:"1",children:[c.jsx("stop",{offset:"0%",stopColor:"#10b981",stopOpacity:.9}),c.jsx("stop",{offset:"100%",stopColor:"#6ee7b7",stopOpacity:.2})]}),c.jsx("filter",{id:"shadow",children:c.jsx("feDropShadow",{dx:"0",dy:"2",stdDeviation:"3",floodOpacity:"0.3"})})]}),c.jsx("g",{opacity:.2,children:[0,.25,.5,.75,1].map((C,N)=>{const O=d+g*(1-C);return c.jsx("line",{x1:d,y1:O,x2:d+x,y2:O,stroke:"#cbd5e1",strokeWidth:1,strokeDasharray:"3,3"},N)})}),c.jsx("path",{d:p,fill:"url(#wavefill)",stroke:"#059669",strokeWidth:2,filter:"url(#shadow)"}),e.map((C,N)=>{const O=d+N*E,L=d+g-C/u*g,V=C>=u*.8;return c.jsxs("g",{children:[c.jsx("circle",{cx:O,cy:L,r:20,fill:"transparent",style:{cursor:"pointer"},onPointerDown:()=>w(N),onPointerEnter:()=>w(N)}),V?c.jsxs(c.Fragment,{children:[c.jsx("circle",{cx:O,cy:L,r:4,fill:"#ef4444"}),c.jsx("circle",{cx:O,cy:L,r:2,fill:"#fff"})]}):C>0?c.jsx("circle",{cx:O,cy:L,r:3.5,fill:"#10b981",opacity:.8}):c.jsx("circle",{cx:O,cy:L,r:1.5,fill:"#94a3b8",opacity:.4})]},N)}),c.jsx("line",{x1:d,y1:d+g,x2:d+x,y2:d+g,stroke:"#94a3b8",strokeWidth:2}),m.map((C,N)=>c.jsxs("g",{children:[c.jsx("line",{x1:C.x,y1:d+g,x2:C.x,y2:d+g+8,stroke:"#64748b",strokeWidth:2}),c.jsx("text",{x:C.x,y:d+g+24,fontSize:11,fontWeight:"600",textAnchor:"middle",fill:"#475569",children:C.text})]},N)),l&&c.jsx("g",{children:(()=>{const C=l.y<60,N=C?l.y+15:l.y-50,O=C?l.y+25:l.y-35;return c.jsxs(c.Fragment,{children:[c.jsx("rect",{x:l.x-50,y:N,width:100,height:40,rx:6,fill:"#1e293b",opacity:.95,stroke:"#10b981",strokeWidth:2}),l.text.split(`
`).map((L,V)=>c.jsx("text",{x:l.x,y:O+V*16,fontSize:12,fontWeight:"600",textAnchor:"middle",fill:"#fff",children:L},V)),c.jsx("circle",{cx:l.x,cy:l.y,r:5,fill:"#10b981",stroke:"#fff",strokeWidth:2})]})})()})]}),c.jsx("div",{className:"help",style:{textAlign:"center",fontSize:"13px",color:"var(--text-secondary)"},children:t("   (BHD)   |     "," Total Sales (BHD) per Hour | Touch any point for details")})]})]})};function ZC(t,e){const n=new Blob([JSON.stringify(e,null,2)],{type:"application/json"}),r=URL.createObjectURL(n),i=document.createElement("a");i.href=r,i.download=t,document.body.appendChild(i),i.click(),i.remove(),URL.revokeObjectURL(r)}const JC=()=>{const{t}=Hn(),e=I.useRef(null),[n,r]=I.useState(100),[i,s]=I.useState(0),[o,l]=I.useState({}),[a,u]=I.useState(!1),[h,f]=I.useState(""),[d,v]=I.useState("");I.useEffect(()=>{const p=B(W,"stats/breakeven/target"),m=be(p,w=>r(typeof w.val()=="number"?w.val():100)),_=B(W,"orders"),k=be(_,w=>{const C=w.val()||{},O=Object.values(C).filter(J=>J.type==="item"&&J.status==="completed");let L=0;const V={};for(const J of O){L+=J.totalPrice||0;const se=J.paymentMethod||"Unknown";V[se]=(V[se]||0)+(J.totalPrice||0)}s(+L.toFixed(3)),l(V)});return()=>{m(),k()}},[]);async function x(){const[p,m,_]=await Promise.all([Ft(B(W,"orders")),Ft(B(W,"loyalty")),Ft(B(W,"stats/thermos"))]),k=p.val()||{},w=m.val()||{},C=_.val()||{},N=Object.values(k).filter(V=>V.type==="item"&&V.status==="completed"),O=Math.max(0,+(n-i).toFixed(3)),L={exportedAt:Date.now(),breakeven:{target:n,revenue:i,carryOver:O},payments:o,completedOrders:N,loyalty:w,thermos:C};ZC(`shift-export-${new Date().toISOString()}.json`,L)}async function g(p){var C;const m=await p.text(),_=JSON.parse(m),k=Number(((C=_==null?void 0:_.breakeven)==null?void 0:C.carryOver)||0),w=(_==null?void 0:_.loyalty)||{};await je(B(W),{loyalty:w}),!isNaN(k)&&k>0&&await nn(B(W,"stats/breakeven/target"),N=>+((typeof N=="number"?N:25)+k).toFixed(3)),alert("  .        .")}async function E(){const p={karak:{currentLevel_ml:3e3,maxCapacity_ml:3e3,refills:0},almohib:{currentLevel_ml:3e3,maxCapacity_ml:3e3,refills:0},otherTeas:{currentLevel_ml:3e3,maxCapacity_ml:3e3,refills:0}};await je(B(W),{"stats/thermos":p,"stats/shift/startAt":Dn(),"stats/shift/openingCash":parseFloat(d)||0}),u(!1),f(""),v(""),alert(t("   .","New shift initialized."))}function y(){h==="255"?E():(alert(t(" ","Wrong PIN")),f(""))}return c.jsxs("section",{className:"card",children:[c.jsx("h2",{className:"section-title",children:t(" ","Shift Management")}),c.jsxs("div",{style:{marginBottom:12,padding:12,background:"#f0fdf4",borderRadius:8,border:"1px solid #bbf7d0"},children:[c.jsx("div",{className:"row",style:{justifyContent:"space-between",marginBottom:6},children:c.jsx("div",{style:{fontWeight:700,color:"#166534"},children:"Weekly Target: 500 BHD"})}),c.jsx("div",{style:{width:"100%",height:10,background:"#dcfce7",borderRadius:5,overflow:"hidden"},children:c.jsx("div",{style:{width:"90%",height:"100%",background:"#22c55e"}})})]}),c.jsxs("div",{className:"row",style:{gap:8,flexWrap:"wrap",justifyContent:"center"},children:[c.jsxs("div",{className:"row",style:{flex:1,gap:8,minWidth:280,justifyContent:"center"},children:[c.jsx("button",{className:"btn btn-outline",style:{flex:1,padding:"8px 4px",fontSize:13},onClick:()=>{var p;return(p=e.current)==null?void 0:p.click()},children:t(" ","Import Shift")}),c.jsx("input",{ref:e,type:"file",accept:"application/json",style:{display:"none"},onChange:p=>{var _;const m=(_=p.target.files)==null?void 0:_[0];m&&g(m),p.currentTarget.value=""}}),c.jsx("button",{className:"btn btn-accent",style:{flex:1,padding:"8px 4px",fontSize:13},onClick:x,children:t(" ","Export Shift")})]}),c.jsx("button",{className:"btn btn-danger",style:{flex:1,minWidth:140,padding:"8px 4px",fontSize:13},onClick:()=>u(!0),children:t("   ","Reset for New Shift")})]}),a&&c.jsx("div",{style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.4)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:100},children:c.jsxs("div",{className:"card",style:{width:"min(400px, 90vw)",textAlign:"center"},children:[c.jsx("div",{className:"section-title",style:{marginBottom:12},children:t("  ","Confirm Reset")}),c.jsx("p",{style:{marginBottom:16,fontSize:14},children:t("      .   PIN .","This will reset thermos levels and shift start time. Enter PIN to continue.")}),c.jsxs("div",{style:{marginBottom:12},children:[c.jsx("label",{style:{display:"block",fontSize:13,marginBottom:4,textAlign:"right"},children:t("   ( )","Opening Cash (BHD)")}),c.jsx("input",{type:"number",inputMode:"decimal",step:"0.001",placeholder:"0.000",value:d,onChange:p=>v(p.target.value),className:"input",style:{width:"100%",textAlign:"center",fontSize:16}})]}),c.jsxs("div",{style:{marginBottom:16},children:[c.jsx("label",{style:{display:"block",fontSize:13,marginBottom:4,textAlign:"right"},children:t("  ","Admin PIN")}),c.jsx("input",{type:"password",inputMode:"numeric",pattern:"[0-9]*",placeholder:"PIN",value:h,onChange:p=>f(p.target.value.replace(/\D/g,"").slice(0,3)),className:"input",style:{width:"100%",textAlign:"center",fontSize:16},autoFocus:!0})]}),c.jsxs("div",{className:"row",style:{gap:8,justifyContent:"center"},children:[c.jsx("button",{className:"btn btn-outline",onClick:()=>{u(!1),f("")},children:t("","Cancel")}),c.jsx("button",{className:"btn btn-danger",onClick:y,children:t("","Confirm")})]})]})})]})};function Gc(){return Gc=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)({}).hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},Gc.apply(null,arguments)}function Fh(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Qc(t,e){return Qc=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,r){return n.__proto__=r,n},Qc(t,e)}function ek(t,e){t.prototype=Object.create(e.prototype),t.prototype.constructor=t,Qc(t,e)}var zh=Number.isNaN||function(e){return typeof e=="number"&&e!==e};function tk(t,e){return!!(t===e||zh(t)&&zh(e))}function nk(t,e){if(t.length!==e.length)return!1;for(var n=0;n<t.length;n++)if(!tk(t[n],e[n]))return!1;return!0}function Pa(t,e){e===void 0&&(e=nk);var n,r=[],i,s=!1;function o(){for(var l=[],a=0;a<arguments.length;a++)l[a]=arguments[a];return s&&n===this&&e(l,r)||(i=t.apply(this,l),s=!0,n=this,r=l),i}return o}var rk=typeof performance=="object"&&typeof performance.now=="function",Bh=rk?function(){return performance.now()}:function(){return Date.now()};function Wh(t){cancelAnimationFrame(t.id)}function ik(t,e){var n=Bh();function r(){Bh()-n>=e?t.call(null):i.id=requestAnimationFrame(r)}var i={id:requestAnimationFrame(r)};return i}var Ra=-1;function $h(t){if(t===void 0&&(t=!1),Ra===-1||t){var e=document.createElement("div"),n=e.style;n.width="50px",n.height="50px",n.overflow="scroll",document.body.appendChild(e),Ra=e.offsetWidth-e.clientWidth,document.body.removeChild(e)}return Ra}var Er=null;function Uh(t){if(t===void 0&&(t=!1),Er===null||t){var e=document.createElement("div"),n=e.style;n.width="50px",n.height="50px",n.overflow="scroll",n.direction="rtl";var r=document.createElement("div"),i=r.style;return i.width="100px",i.height="100px",e.appendChild(r),document.body.appendChild(e),e.scrollLeft>0?Er="positive-descending":(e.scrollLeft=1,e.scrollLeft===0?Er="negative":Er="positive-ascending"),document.body.removeChild(e),Er}return Er}var sk=150,ok=function(e,n){return e};function lk(t){var e,n=t.getItemOffset,r=t.getEstimatedTotalSize,i=t.getItemSize,s=t.getOffsetForIndexAndAlignment,o=t.getStartIndexForOffset,l=t.getStopIndexForStartIndex,a=t.initInstanceProps,u=t.shouldResetStyleCacheOnItemSizeChange,h=t.validateProps;return e=function(f){ek(d,f);function d(x){var g;return g=f.call(this,x)||this,g._instanceProps=a(g.props,Fh(g)),g._outerRef=void 0,g._resetIsScrollingTimeoutId=null,g.state={instance:Fh(g),isScrolling:!1,scrollDirection:"forward",scrollOffset:typeof g.props.initialScrollOffset=="number"?g.props.initialScrollOffset:0,scrollUpdateWasRequested:!1},g._callOnItemsRendered=void 0,g._callOnItemsRendered=Pa(function(E,y,p,m){return g.props.onItemsRendered({overscanStartIndex:E,overscanStopIndex:y,visibleStartIndex:p,visibleStopIndex:m})}),g._callOnScroll=void 0,g._callOnScroll=Pa(function(E,y,p){return g.props.onScroll({scrollDirection:E,scrollOffset:y,scrollUpdateWasRequested:p})}),g._getItemStyle=void 0,g._getItemStyle=function(E){var y=g.props,p=y.direction,m=y.itemSize,_=y.layout,k=g._getItemStyleCache(u&&m,u&&_,u&&p),w;if(k.hasOwnProperty(E))w=k[E];else{var C=n(g.props,E,g._instanceProps),N=i(g.props,E,g._instanceProps),O=p==="horizontal"||_==="horizontal",L=p==="rtl",V=O?C:0;k[E]=w={position:"absolute",left:L?void 0:V,right:L?V:void 0,top:O?0:C,height:O?"100%":N,width:O?N:"100%"}}return w},g._getItemStyleCache=void 0,g._getItemStyleCache=Pa(function(E,y,p){return{}}),g._onScrollHorizontal=function(E){var y=E.currentTarget,p=y.clientWidth,m=y.scrollLeft,_=y.scrollWidth;g.setState(function(k){if(k.scrollOffset===m)return null;var w=g.props.direction,C=m;if(w==="rtl")switch(Uh()){case"negative":C=-m;break;case"positive-descending":C=_-p-m;break}return C=Math.max(0,Math.min(C,_-p)),{isScrolling:!0,scrollDirection:k.scrollOffset<C?"forward":"backward",scrollOffset:C,scrollUpdateWasRequested:!1}},g._resetIsScrollingDebounced)},g._onScrollVertical=function(E){var y=E.currentTarget,p=y.clientHeight,m=y.scrollHeight,_=y.scrollTop;g.setState(function(k){if(k.scrollOffset===_)return null;var w=Math.max(0,Math.min(_,m-p));return{isScrolling:!0,scrollDirection:k.scrollOffset<w?"forward":"backward",scrollOffset:w,scrollUpdateWasRequested:!1}},g._resetIsScrollingDebounced)},g._outerRefSetter=function(E){var y=g.props.outerRef;g._outerRef=E,typeof y=="function"?y(E):y!=null&&typeof y=="object"&&y.hasOwnProperty("current")&&(y.current=E)},g._resetIsScrollingDebounced=function(){g._resetIsScrollingTimeoutId!==null&&Wh(g._resetIsScrollingTimeoutId),g._resetIsScrollingTimeoutId=ik(g._resetIsScrolling,sk)},g._resetIsScrolling=function(){g._resetIsScrollingTimeoutId=null,g.setState({isScrolling:!1},function(){g._getItemStyleCache(-1,null)})},g}d.getDerivedStateFromProps=function(g,E){return ak(g,E),h(g),null};var v=d.prototype;return v.scrollTo=function(g){g=Math.max(0,g),this.setState(function(E){return E.scrollOffset===g?null:{scrollDirection:E.scrollOffset<g?"forward":"backward",scrollOffset:g,scrollUpdateWasRequested:!0}},this._resetIsScrollingDebounced)},v.scrollToItem=function(g,E){E===void 0&&(E="auto");var y=this.props,p=y.itemCount,m=y.layout,_=this.state.scrollOffset;g=Math.max(0,Math.min(g,p-1));var k=0;if(this._outerRef){var w=this._outerRef;m==="vertical"?k=w.scrollWidth>w.clientWidth?$h():0:k=w.scrollHeight>w.clientHeight?$h():0}this.scrollTo(s(this.props,g,E,_,this._instanceProps,k))},v.componentDidMount=function(){var g=this.props,E=g.direction,y=g.initialScrollOffset,p=g.layout;if(typeof y=="number"&&this._outerRef!=null){var m=this._outerRef;E==="horizontal"||p==="horizontal"?m.scrollLeft=y:m.scrollTop=y}this._callPropsCallbacks()},v.componentDidUpdate=function(){var g=this.props,E=g.direction,y=g.layout,p=this.state,m=p.scrollOffset,_=p.scrollUpdateWasRequested;if(_&&this._outerRef!=null){var k=this._outerRef;if(E==="horizontal"||y==="horizontal")if(E==="rtl")switch(Uh()){case"negative":k.scrollLeft=-m;break;case"positive-ascending":k.scrollLeft=m;break;default:var w=k.clientWidth,C=k.scrollWidth;k.scrollLeft=C-w-m;break}else k.scrollLeft=m;else k.scrollTop=m}this._callPropsCallbacks()},v.componentWillUnmount=function(){this._resetIsScrollingTimeoutId!==null&&Wh(this._resetIsScrollingTimeoutId)},v.render=function(){var g=this.props,E=g.children,y=g.className,p=g.direction,m=g.height,_=g.innerRef,k=g.innerElementType,w=g.innerTagName,C=g.itemCount,N=g.itemData,O=g.itemKey,L=O===void 0?ok:O,V=g.layout,J=g.outerElementType,se=g.outerTagName,Ee=g.style,Te=g.useIsScrolling,de=g.width,xe=this.state.isScrolling,D=p==="horizontal"||V==="horizontal",G=D?this._onScrollHorizontal:this._onScrollVertical,b=this._getRangeToRender(),U=b[0],F=b[1],q=[];if(C>0)for(var S=U;S<=F;S++)q.push(ue.createElement(E,{data:N,key:L(S,N),index:S,isScrolling:Te?xe:void 0,style:this._getItemStyle(S)}));var Q=r(this.props,this._instanceProps);return ue.createElement(J||se||"div",{className:y,onScroll:G,ref:this._outerRefSetter,style:Gc({position:"relative",height:m,width:de,overflow:"auto",WebkitOverflowScrolling:"touch",willChange:"transform",direction:p},Ee)},ue.createElement(k||w||"div",{children:q,ref:_,style:{height:D?"100%":Q,pointerEvents:xe?"none":void 0,width:D?Q:"100%"}}))},v._callPropsCallbacks=function(){if(typeof this.props.onItemsRendered=="function"){var g=this.props.itemCount;if(g>0){var E=this._getRangeToRender(),y=E[0],p=E[1],m=E[2],_=E[3];this._callOnItemsRendered(y,p,m,_)}}if(typeof this.props.onScroll=="function"){var k=this.state,w=k.scrollDirection,C=k.scrollOffset,N=k.scrollUpdateWasRequested;this._callOnScroll(w,C,N)}},v._getRangeToRender=function(){var g=this.props,E=g.itemCount,y=g.overscanCount,p=this.state,m=p.isScrolling,_=p.scrollDirection,k=p.scrollOffset;if(E===0)return[0,0,0,0];var w=o(this.props,k,this._instanceProps),C=l(this.props,w,k,this._instanceProps),N=!m||_==="backward"?Math.max(1,y):1,O=!m||_==="forward"?Math.max(1,y):1;return[Math.max(0,w-N),Math.max(0,Math.min(E-1,C+O)),w,C]},d}(ue.PureComponent),e.defaultProps={direction:"ltr",itemData:void 0,layout:"vertical",overscanCount:2,useIsScrolling:!1},e}var ak=function(e,n){e.children,e.direction,e.height,e.layout,e.innerTagName,e.outerTagName,e.width,n.instance},ck=50,zr=function(e,n,r){var i=e,s=i.itemSize,o=r.itemMetadataMap,l=r.lastMeasuredIndex;if(n>l){var a=0;if(l>=0){var u=o[l];a=u.offset+u.size}for(var h=l+1;h<=n;h++){var f=s(h);o[h]={offset:a,size:f},a+=f}r.lastMeasuredIndex=n}return o[n]},uk=function(e,n,r){var i=n.itemMetadataMap,s=n.lastMeasuredIndex,o=s>0?i[s].offset:0;return o>=r?$y(e,n,s,0,r):dk(e,n,Math.max(0,s),r)},$y=function(e,n,r,i,s){for(;i<=r;){var o=i+Math.floor((r-i)/2),l=zr(e,o,n).offset;if(l===s)return o;l<s?i=o+1:l>s&&(r=o-1)}return i>0?i-1:0},dk=function(e,n,r,i){for(var s=e.itemCount,o=1;r<s&&zr(e,r,n).offset<i;)r+=o,o*=2;return $y(e,n,Math.min(r,s-1),Math.floor(r/2),i)},Hh=function(e,n){var r=e.itemCount,i=n.itemMetadataMap,s=n.estimatedItemSize,o=n.lastMeasuredIndex,l=0;if(o>=r&&(o=r-1),o>=0){var a=i[o];l=a.offset+a.size}var u=r-o-1,h=u*s;return l+h},fk=lk({getItemOffset:function(e,n,r){return zr(e,n,r).offset},getItemSize:function(e,n,r){return r.itemMetadataMap[n].size},getEstimatedTotalSize:Hh,getOffsetForIndexAndAlignment:function(e,n,r,i,s,o){var l=e.direction,a=e.height,u=e.layout,h=e.width,f=l==="horizontal"||u==="horizontal",d=f?h:a,v=zr(e,n,s),x=Hh(e,s),g=Math.max(0,Math.min(x-d,v.offset)),E=Math.max(0,v.offset-d+v.size+o);switch(r==="smart"&&(i>=E-d&&i<=g+d?r="auto":r="center"),r){case"start":return g;case"end":return E;case"center":return Math.round(E+(g-E)/2);case"auto":default:return i>=E&&i<=g?i:i<E?E:g}},getStartIndexForOffset:function(e,n,r){return uk(e,r,n)},getStopIndexForStartIndex:function(e,n,r,i){for(var s=e.direction,o=e.height,l=e.itemCount,a=e.layout,u=e.width,h=s==="horizontal"||a==="horizontal",f=h?u:o,d=zr(e,n,i),v=r+f,x=d.offset+d.size,g=n;g<l-1&&x<v;)g++,x+=zr(e,g,i).size;return g},initInstanceProps:function(e,n){var r=e,i=r.estimatedItemSize,s={itemMetadataMap:{},estimatedItemSize:i||ck,lastMeasuredIndex:-1};return n.resetAfterIndex=function(o,l){l===void 0&&(l=!0),s.lastMeasuredIndex=Math.min(s.lastMeasuredIndex,o-1),n._getItemStyleCache(-1),l&&n.forceUpdate()},s},shouldResetStyleCacheOnItemSizeChange:!1,validateProps:function(e){e.itemSize}});const hk=({logs:t,loyaltyMap:e,onCopyDayOrders:n})=>{const{t:r}=Hn(),i=I.useRef(null),[s,o]=I.useState(600);I.useEffect(()=>{const m=i.current;if(!m)return;const _=new window.ResizeObserver(()=>o(m.clientWidth));return _.observe(m),o(m.clientWidth),()=>_.disconnect()},[]);const[l,a]=I.useState(null),[u,h]=I.useState(""),[f,d]=I.useState(""),v=m=>{if(!m)return"";const _=new Date(m),k=new Date(_.getFullYear(),_.getMonth(),_.getDate());return _.getHours()<5&&k.setDate(k.getDate()-1),`${k.getFullYear()}-${String(k.getMonth()+1).padStart(2,"0")}-${String(k.getDate()).padStart(2,"0")}`},x=[];for(let m=0;m<t.length;m++){const _=t[m],k=(typeof _.completedAt=="number"?_.completedAt:_.createdAt)||0,w=m>0&&(typeof t[m-1].completedAt=="number"?t[m-1].completedAt:t[m-1].createdAt)||0,C=v(k),N=v(w);if((m===0||C!==N)&&C){const[L,V,J]=C.split("-").map(Number),Ee=new Date(L,V-1,J).toLocaleDateString("en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric"});x.push({type:"separator",key:`sep-${C}`,title:Ee})}x.push({type:"order",order:_})}const g=m=>x[m].type==="separator"?40:105,E=m=>{a(m.id),h(m.licensePlate||""),d(m.notes||"")},y=async()=>{l&&(await je(B(W,`orders/${l}`),{licensePlate:u||null,notes:f||null}),a(null))},p=({index:m,style:_})=>{const k=x[m];if(k.type==="separator")return c.jsx("div",{style:{..._,display:"flex",alignItems:"center",justifyContent:"center",background:"#f1f5f9",color:"#64748b",fontWeight:"bold",fontSize:13},children:k.title});const w=k.order,C=l===w.id,N=(typeof w.completedAt=="number"?w.completedAt:w.createdAt)||0,O=new Date(N).toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit",hour12:!0}),L=w.licensePlate&&e[w.licensePlate]?"".repeat(Math.min(e[w.licensePlate],5)):null;return c.jsx("div",{style:{..._,padding:"4px 8px"},children:c.jsxs("div",{className:"card",style:{padding:"8px 12px",height:"calc(100% - 4px)",display:"flex",flexDirection:"column",justifyContent:"space-between",borderLeft:L?"4px solid #fbbf24":"none"},children:[c.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start"},children:[c.jsxs("div",{style:{display:"flex",gap:10,alignItems:"center"},children:[c.jsx(yo,{type:w.drinkType,size:30}),c.jsxs("div",{children:[c.jsxs("div",{style:{fontSize:"18px",fontWeight:800,color:"#0f172a",lineHeight:"1.2"},children:[w.drinkType," ",c.jsxs("span",{style:{fontSize:"15px",color:"#475569",fontWeight:600},children:[" ",w.quantity]})]}),c.jsx("div",{style:{fontSize:"13px",color:"#000000",fontWeight:700,marginTop:"4px"},children:w.drinkType==="Cold Drink"?w.coldDrinkName:w.drinkType==="Sweets"?`${w.sweetsOption||""}`:w.drinkType==="Red Tea"?[w.teaType,w.cupType,w.sugar].filter(Boolean).join("  "):[w.cupType,w.sugar].filter(Boolean).join("  ")})]})]}),c.jsxs("div",{style:{textAlign:"end"},children:[c.jsx("div",{style:{fontSize:"16px",fontWeight:900,color:"#dc2626",marginBottom:"2px"},children:O}),c.jsx("div",{style:{fontSize:"18px",fontWeight:700,color:"#2563eb"},children:Y(w.totalPrice)})]})]}),c.jsx("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginTop:4},children:C?c.jsxs("div",{style:{display:"flex",gap:4,flex:1},children:[c.jsx("input",{className:"input",style:{width:60,padding:4},value:u,onChange:V=>h(V.target.value),placeholder:"Plate"}),c.jsx("input",{className:"input",style:{flex:1,padding:4},value:f,onChange:V=>d(V.target.value),placeholder:"Notes"}),c.jsx("button",{className:"btn btn-primary",style:{padding:"2px 8px"},onClick:y,children:""}),c.jsx("button",{className:"btn btn-outline",style:{padding:"2px 8px"},onClick:()=>a(null),children:""})]}):c.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8,fontSize:12,color:"#475569",flex:1},onClick:()=>E(w),children:[c.jsx("span",{style:{fontWeight:700,background:"#f1f5f9",padding:"2px 6px",borderRadius:4},children:w.licensePlate||"___"}),L&&c.jsx("span",{children:L}),w.notes&&c.jsxs("span",{style:{fontStyle:"italic",opacity:.8},children:[" ",w.notes]}),c.jsx("span",{style:{marginLeft:"auto",fontSize:10,opacity:.5},children:w.paymentMethod})]})})]})})};return c.jsxs("section",{className:"card",style:{flex:1,display:"flex",flexDirection:"column",minHeight:400},children:[c.jsxs("div",{className:"row",style:{justifyContent:"space-between",alignItems:"center",marginBottom:12},children:[c.jsxs("div",{className:"section-title",style:{margin:0},children:[r(" ","Orders Log")," (",t.length,")"]}),c.jsxs("button",{className:"btn btn-outline",onClick:n,children:[" ",r(" ()","Copy Day")]})]}),c.jsxs("div",{style:{flex:1},ref:i,children:[x.length>0&&c.jsx(fk,{height:600,itemCount:x.length,itemSize:g,width:s,children:p}),x.length===0&&c.jsx("div",{className:"help",style:{textAlign:"center",marginTop:24},children:r("  ","No orders found")})]})]})};function pk(){const t=B(W,"stats/thermos");nn(t,e=>{if(!e)return{karak:{currentLevel_ml:3e3,maxCapacity_ml:3e3,refills:0},almohib:{currentLevel_ml:3e3,maxCapacity_ml:3e3,refills:0},otherTeas:{currentLevel_ml:3e3,maxCapacity_ml:3e3,refills:0}};let n=!1;const r={};for(const i of["karak","almohib","otherTeas"]){const s=e[i];s&&typeof s.remaining=="number"&&s.currentLevel_ml===void 0?(n=!0,r[i]={currentLevel_ml:3e3,maxCapacity_ml:3e3,refills:s.refills||0}):s&&s.currentLevel_ml!==void 0?r[i]=s:r[i]={currentLevel_ml:3e3,maxCapacity_ml:3e3,refills:0}}return n?r:e})}function mk(){const[t,e]=I.useState(null);return I.useEffect(()=>{pk();const n=B(W,"stats/thermos"),r=be(n,i=>e(i.val()));return()=>r()},[]),t}async function ja(t,e){const n=`stats/thermos/${t}`;return nn(B(W,n),r=>{if(!r)return r;const i=Math.max(0,Math.min(r.maxCapacity_ml,r.currentLevel_ml+e));return{...r,currentLevel_ml:i}})}async function gk(t){const e=`stats/thermos/${t}`;return nn(B(W,e),n=>n&&{...n,refills:(n.refills??0)+1,lastReheatedAt:Date.now()})}async function yk(t){const e=`stats/thermos/${t}/lastReheatedAt`;return je(B(W),{[e]:Date.now()})}async function vk(){await je(B(W),{"stats/thermos/karak/refills":0,"stats/thermos/almohib/refills":0,"stats/thermos/otherTeas/refills":0})}function _k({pct:t,warn:e}){return c.jsx("div",{style:{width:"100%",background:"#eef2ff",borderRadius:8,overflow:"hidden",border:"1px solid #e5e7eb"},children:c.jsx("div",{style:{width:`${Math.max(0,Math.min(100,t))}%`,background:e?"#fde68a":"#93c5fd",height:8}})})}function xk(){const[t,e]=I.useState(null);return I.useEffect(()=>{const n=be(B(W,"stats/shift/startAt"),r=>{const i=r.val();e(typeof i=="number"?i:null)});return()=>n()},[]),t}function Uy(){const t=xk(),[e,n]=I.useState({total:0,totalCost:0,byPay:{},logs:[]});return I.useEffect(()=>{const r=B(W,"orders"),i=be(r,s=>{try{const o=s.val()||{};let a=Object.entries(o).map(([v,x])=>({id:v,...x})).filter(v=>v.type==="item"&&v.status==="completed");t&&(a=a.filter(v=>(typeof v.completedAt=="number"?v.completedAt:0)>=t));const u={};let h=0,f=0;for(const v of a){h+=v.totalPrice||0,f+=v.totalCost||0;const x=v.paymentMethod||"Unknown";u[x]=(u[x]||0)+(v.totalPrice||0)}a.sort((v,x)=>(v.completedAt||0)<(x.completedAt||0)?1:-1),n({total:+h.toFixed(3),totalCost:+f.toFixed(3),byPay:u,logs:a.slice(0,200)})}catch(o){console.error("useCompletedSummary error:",o)}});return()=>i()},[t]),e}function Sk(t=20){const[e,n]=I.useState([]),[r,i]=I.useState(!1),[s,o]=I.useState(!0),l=I.useRef(null);async function a(h){i(!0);try{let f={};h?f=await GC(h):f=await Mh(t);const v=Object.entries(f||{}).map(([x,g])=>({id:x,...g})).filter(x=>x.type==="item"&&x.status==="completed");v.sort((x,g)=>(x.completedAt||0)<(g.completedAt||0)?1:-1),n(v),v.length>0&&(l.current=v[v.length-1].completedAt||null),o(h?!1:(v.length||0)>=t)}catch(f){console.error("loadInitial error:",f),n([]),o(!1)}finally{i(!1)}}async function u(h=20){if(!l.current)return;i(!0);const f=await Mh(h+(e.length||0)),v=Object.entries(f||{}).map(([g,E])=>({id:g,...E})).filter(g=>g.type==="item"&&g.status==="completed");v.sort((g,E)=>(g.completedAt||0)<(E.completedAt||0)?1:-1);const x=v.filter(g=>(g.completedAt||0)<(l.current||0));x.length===0?o(!1):(n(g=>[...g,...x]),l.current=x[x.length-1].completedAt||l.current),i(!1)}return{logs:e,loadMore:u,hasMore:s,loading:r,loadInitial:a}}const wk=()=>{const{t}=Hn(),e=mk(),{total:n,totalCost:r,byPay:i}=Uy(),{logs:s,loading:o,loadInitial:l}=Sk(20),[a,u]=I.useState(!1),[h,f]=I.useState(""),[d,v]=I.useState(0),[x,g]=I.useState(!1),[E,y]=I.useState(()=>{const b=new Date,U=b.getFullYear(),F=String(b.getMonth()+1).padStart(2,"0"),q=String(b.getDate()).padStart(2,"0");return`${U}-${F}-${q}`}),[p,m]=I.useState(null),[_,k]=I.useState(""),[w,C]=I.useState(null),[N,O]=I.useState(null),[L,V]=I.useState(Date.now());I.useEffect(()=>{const b=setInterval(()=>V(Date.now()),6e4);return()=>clearInterval(b)},[]),I.useEffect(()=>{const b=be(B(W,"stats/shift/openingCash"),U=>v(Number(U.val())||0));return()=>b()},[]);function J(b){const U=new Date(b);U.getHours()<5&&U.setDate(U.getDate()-1);const F=U.getFullYear(),q=String(U.getMonth()+1).padStart(2,"0"),S=String(U.getDate()).padStart(2,"0");return`${F}-${q}-${S}`}const se=()=>{if(!a){if(prompt(t(" :","Enter PIN:"))!=="522"){alert(t(" ","Wrong PIN"));return}u(!0)}const b={};s.forEach(q=>{const S=(typeof q.completedAt=="number"?q.completedAt:q.createdAt)||0,Q=J(S);b[Q]||(b[Q]=[]),b[Q].push(q)});const U=Object.keys(b).sort();let F=`=== COMPLETED ORDERS (ALL DAYS) ===

`;U.forEach(q=>{const S=b[q],Q=new Date(q+"T00:00:00"),X=Q.toLocaleDateString("en-US",{weekday:"long"}),z=Q.toLocaleDateString("en-US",{month:"long",day:"numeric",year:"numeric"});F+=` ${X}, ${z} 

`,S.forEach((Z,M)=>{F+=`#${M+1}
`,F+=`${Z.drinkType}  ${Z.quantity}
`;const T=Z.drinkType==="Cold Drink"?Z.coldDrinkName||"":Z.drinkType==="Sweets"?`${Z.sweetsOption||""}${typeof Z.customPrice=="number"?` @ ${Y(Z.customPrice)}`:""}`:Z.drinkType==="Red Tea"?[Z.teaType,Z.cupType,Z.sugar].filter(Boolean).join("  "):[Z.cupType,Z.sugar].filter(Boolean).join("  ");if(T&&(F+=`${T}
`),F+=`Plate: ${Z.licensePlate||""} | Notes: ${Z.notes||""}
`,Z.licensePlate&&xe[Z.licensePlate]){const j="".repeat(Math.min(xe[Z.licensePlate],5));F+=`Stars: ${j}
`}F+=`Price: ${Y(Z.totalPrice||0)}
`,F+=`Payment: ${Z.paymentMethod||""}

`});const ie=S.reduce((Z,M)=>Z+(M.totalPrice||0),0),pe={};S.forEach(Z=>{const M=Z.paymentMethod||"Unknown";pe[M]=(pe[M]||0)+(Z.totalPrice||0)}),F+=`Day Total: ${Y(ie)}
`,F+=`Benefit: ${Y(pe.Benefit||0)} | `,F+=`Cash: ${Y(pe.Cash||0)} | `,F+=`Machine: ${Y(pe.Machine||0)}

`}),F+=`
`,F+=`GRAND TOTAL: ${Y(n)}
`,F+=`Benefit: ${Y(i.Benefit||0)} | `,F+=`Cash: ${Y(i.Cash||0)} | `,F+=`Machine: ${Y(i.Machine||0)}
`,F+=`
`,F+=`Opening Cash: ${Y(d)}
`,F+=` In Drawer: ${Y(d+(i.Cash||0))}
`,navigator.clipboard.writeText(F).then(()=>{alert(t("  !","Orders copied to clipboard!"))}).catch(()=>{alert(t(" ","Copy failed"))})},Ee=()=>{if(!a){if(prompt(t(" :","Enter PIN:"))!=="522"){alert(t(" ","Wrong PIN"));return}u(!0)}const b=s.filter(z=>{const ie=(typeof z.completedAt=="number"?z.completedAt:z.createdAt)||0;return J(ie)===E}),U=new Date(E+"T00:00:00"),F=U.toLocaleDateString("en-US",{weekday:"long"}),q=U.toLocaleDateString("en-US",{month:"long",day:"numeric",year:"numeric"});let S=`=== ${F}, ${q} ===

`;b.forEach((z,ie)=>{S+=`#${ie+1}
`,S+=`${z.drinkType}  ${z.quantity}
`;const pe=z.drinkType==="Cold Drink"?z.coldDrinkName||"":z.drinkType==="Sweets"?`${z.sweetsOption||""}${typeof z.customPrice=="number"?` @ ${Y(z.customPrice)}`:""}`:z.drinkType==="Red Tea"?[z.teaType,z.cupType,z.sugar].filter(Boolean).join("  "):[z.cupType,z.sugar].filter(Boolean).join("  ");if(pe&&(S+=`${pe}
`),S+=`Plate: ${z.licensePlate||""} | Notes: ${z.notes||""}
`,z.licensePlate&&xe[z.licensePlate]){const Z="".repeat(Math.min(xe[z.licensePlate],5));S+=`Stars: ${Z}
`}S+=`Price: ${Y(z.totalPrice||0)}
`,S+=`Payment: ${z.paymentMethod||""}

`});const Q=b.reduce((z,ie)=>z+(ie.totalPrice||0),0),X={};b.forEach(z=>{const ie=z.paymentMethod||"Unknown";X[ie]=(X[ie]||0)+(z.totalPrice||0)}),S+=`TOTAL: ${Y(Q)}
`,S+=`Benefit: ${Y(X.Benefit||0)} | `,S+=`Cash: ${Y(X.Cash||0)} | `,S+=`Machine: ${Y(X.Machine||0)}`,S+=` | Mixed: ${Y(X.Mixed||0)}`,S+=`
`,S+=`
`,S+=`Opening Cash: ${Y(d)}
`,S+=` In Drawer: ${Y(d+(X.Cash||0))}
`,navigator.clipboard.writeText(S).then(()=>alert(t("   ","Copied day orders!")))};async function Te(b=30){if(prompt(t("  ( ):","Enter PIN (to archive):"))!=="522"){alert(t(" ","Wrong PIN"));return}if(!confirm(t("        .","Are you sure? This will move older completed orders to archive.")))return;const F=Date.now()-b*24*60*60*1e3;try{const q=B(W,"orders"),S=$l(q,Wl("completedAt"),My(F)),X=(await Ft(S)).val()||{},ie=Object.entries(X).map(([T,j])=>({id:T,...j})).filter(T=>T.type==="item"&&T.status==="completed"&&typeof T.completedAt=="number"&&T.completedAt<=F);if(ie.length===0){alert(t("    ","No old completed orders to archive"));return}const pe={},M=ie.slice(0,500);for(const T of M)pe[`orders-archive/${T.id}`]={...T},pe[`orders/${T.id}`]=null;await je(B(W),pe),alert(t("   .","Archived old completed orders."))}catch(q){console.error("Archive error:",q),alert(t(" .   .","Archive failed. Check console."))}}const de=I.useRef(new Set),[xe,D]=I.useState({});I.useEffect(()=>{const U=Array.from(new Set(s.map(F=>F.licensePlate).filter(F=>F&&F.length===3))).filter(F=>!de.current.has(F));U.length!==0&&Promise.all(U.map(F=>Ft(B(W,`loyalty/${F}/count`)).then(q=>({p:F,v:q.val()})))).then(F=>{F.forEach(({p:q})=>de.current.add(q)),D(q=>{const S={...q};for(const{p:Q,v:X}of F)typeof X=="number"&&(S[Q]=X);return S})}).catch(()=>{})},[s.length]);const G=I.useMemo(()=>s.filter(b=>p&&b.paymentMethod!==p||_&&!(b.licensePlate||"").slice(-3).includes(_)?!1:(typeof b.completedAt=="number"?b.completedAt:b.createdAt,!0)),[s,p,_]);return c.jsxs(c.Fragment,{children:[c.jsxs("section",{className:"card",children:[c.jsxs("div",{className:"col",children:[c.jsxs("div",{className:"row",style:{justifyContent:"space-between",alignItems:"center"},children:[c.jsx("div",{className:"section-title",style:{margin:0},children:t("  ()","Thermos Levels (Liters)")}),c.jsxs("div",{style:{display:"flex",gap:8,alignItems:"center"},children:[c.jsx("button",{className:"btn btn-outline",onClick:vk,children:t("  ","Reset Refill Counters")}),c.jsx("button",{className:"btn btn-outline",style:{borderColor:"#f87171",color:"#ef4444"},onClick:()=>je(B(W),{"stats/rush/resetAt":Dn()}),title:t("  ","Reset Rush Hour"),children:t(" ","Reset Rush")})]})]}),!e&&c.jsx("div",{className:"help",children:t(" ...","Loading...")}),e&&c.jsx("div",{className:"col",style:{gap:10},children:["karak","almohib","otherTeas"].map(b=>{const U=e[b],F=U.currentLevel_ml/U.maxCapacity_ml*100,q=F<=30,S=U.currentLevel_ml/1e3,Q=S%1===0?S.toFixed(0):S.toFixed(1),X=b==="karak"?t("","Karak"):b==="almohib"?t(" ","Almohib"):t(" ","Red Tea"),z=U.lastReheatedAt?new Date(U.lastReheatedAt).toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit",hour12:!0}):null,ie=U.lastReheatedAt?L-U.lastReheatedAt>40*60*1e3:!1;return c.jsxs("div",{className:"col",style:{gap:6},children:[c.jsxs("div",{className:"row",style:{alignItems:"center",gap:12},children:[c.jsx("div",{style:{minWidth:90},children:X}),c.jsx("div",{style:{flex:1},children:c.jsx(_k,{pct:F,warn:q})}),c.jsxs("div",{style:{minWidth:80,textAlign:"end",fontWeight:700,fontSize:16},children:[Q," L"]})]}),c.jsxs("div",{className:"row",style:{gap:6,alignItems:"center",flexWrap:"wrap"},children:[c.jsx("button",{className:"btn btn-outline",style:{fontSize:18,padding:"4px 12px"},onClick:()=>ja(b,-500),children:""}),c.jsx("button",{className:"btn btn-outline",style:{fontSize:18,padding:"4px 12px"},onClick:()=>ja(b,b==="karak"?600:500),children:"+"}),c.jsx("button",{className:"btn btn-primary",onClick:()=>C(b),children:t("","Actions")}),c.jsxs("div",{className:"help",children:[t(":","Refills:")," ",U.refills||0]}),z&&c.jsxs("div",{className:"row",style:{alignItems:"center",gap:6},children:[c.jsxs("div",{className:"help",children:[t(" :","Last Reheat:")," ",z]}),ie&&c.jsxs("div",{style:{background:"#fecaca",color:"#b91c1c",padding:"2px 8px",borderRadius:4,fontSize:12,fontWeight:"bold",border:"1px solid #ef4444"},children:[" ",t("  !","Check Heat!")]})]})]}),q&&c.jsx("div",{className:"help",style:{color:"#b45309",fontWeight:700},children:t("  ","Please refill")})]},b)})}),c.jsxs("div",{style:{marginTop:8},children:[c.jsx("button",{className:"btn btn-outline",onClick:()=>Te(30),style:{marginRight:8},children:t("    30 ","Archive orders older than 30 days")}),c.jsx("button",{className:"btn btn-outline",onClick:()=>Te(90),children:t("    90 ","Archive orders older than 90 days")})]})]}),c.jsxs("div",{className:"col",children:[c.jsx("div",{className:"section-title",style:{margin:0},children:t(" ","Completed Summary")}),a?c.jsxs("div",{className:"row",style:{flexWrap:"wrap",gap:8},children:[Object.keys(i).length===0&&c.jsx("div",{className:"help",children:t("   ","No payments yet")}),Object.entries(i).map(([b,U])=>{const q=b==="Mixed"?{background:"#ede9fe",border:"2px solid #8b5cf6",fontWeight:700}:void 0;return c.jsxs("div",{className:"chip",style:q,children:[b,": ",Y(U)]},b)}),c.jsxs("div",{className:"chip",style:{background:"#dcfce7",border:"2px solid #16a34a",fontWeight:800,color:"#14532d"},children:[" ",t(" :","In Drawer:")," ",Y(d+(i.Cash||0))]})]}):c.jsxs("div",{className:"help",style:{fontStyle:"italic"},children:[" ",t(" -   ","Locked - Enter PIN above")]})]}),c.jsxs("div",{className:"col",children:[c.jsx("div",{className:"row",style:{justifyContent:"space-between",alignItems:"center",gap:8,flexWrap:"wrap"},children:c.jsxs("div",{className:"row",style:{gap:8,alignItems:"center",width:"100%",justifyContent:"flex-end"},children:[c.jsxs("button",{className:"btn btn-outline",onClick:()=>l(E),disabled:o,children:[" ",o?t("...","Loading..."):t("","Refresh")]}),c.jsx("input",{className:"input",type:"date",value:E,onChange:b=>y(b.target.value),style:{padding:"6px 8px"}}),c.jsxs("button",{className:"btn btn-accent",onClick:se,disabled:s.length===0,children:[" ",t(" ","Copy All")]})]})}),c.jsxs("div",{className:"row",style:{gap:6,flexWrap:"wrap",alignItems:"center",marginTop:8},children:[c.jsx("div",{className:"help",style:{fontSize:12},children:t(":","Filter:")}),["Benefit","Cash","Machine","Mixed"].map(b=>c.jsx("button",{className:p===b?"chip":"chip-outline",style:{padding:"4px 10px",fontSize:12,cursor:"pointer",border:p===b?"2px solid #3b82f6":"1px solid #d1d5db",background:p===b?"#dbeafe":"#fff",fontWeight:p===b?700:400},onClick:()=>m(p===b?null:b),children:b},b)),c.jsx("input",{type:"text",inputMode:"numeric",pattern:"[0-9]*",placeholder:t(" (3 )","Plate (3 digits)"),value:_,onChange:b=>k(b.target.value.replace(/\D/g,"").slice(0,3)),className:"input",style:{width:110,padding:"4px 8px",fontSize:12}}),(p||_)&&c.jsx("button",{className:"btn btn-outline",style:{fontSize:11,padding:"4px 8px"},onClick:()=>{m(null),k("")},children:t("","Clear")})]}),c.jsx("div",{style:{marginTop:8},children:c.jsx(hk,{logs:G,loyaltyMap:xe,onCopyDayOrders:Ee})})]})]}),N&&c.jsx("div",{style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.35)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:60},children:c.jsxs("div",{className:"card",style:{width:"min(480px, 92vw)"},children:[c.jsx("div",{className:"section-title",style:{marginBottom:8},children:N.title}),c.jsxs("div",{className:"col",style:{gap:8},children:[c.jsxs("div",{className:"row",style:{justifyContent:"space-between"},children:[c.jsxs("div",{children:[t(" :","Total Orders:")," ",N.count]}),c.jsxs("div",{children:[t(":","Total:")," ",Y(N.total)]})]}),c.jsxs("div",{className:"col",style:{gap:6},children:[c.jsx("div",{className:"help",style:{fontWeight:700},children:t("  ","Payments by Method")}),Object.entries(N.byPay).length===0&&c.jsx("div",{className:"help",children:t(" ","None")}),Object.entries(N.byPay).map(([b,U])=>c.jsxs("div",{className:"row",style:{justifyContent:"space-between"},children:[c.jsx("div",{children:b}),c.jsxs("div",{children:[U.count,"  ",Y(+U.amount.toFixed(3))]})]},b))]}),c.jsx("div",{className:"row",style:{justifyContent:"flex-end",gap:8,marginTop:8},children:c.jsx("button",{className:"btn btn-primary",onClick:()=>O(null),children:t("","Close")})})]})]})}),w&&c.jsx("div",{style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.4)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:60},children:c.jsxs("div",{className:"card",style:{width:"min(400px, 90vw)",textAlign:"center"},children:[c.jsx("div",{className:"section-title",style:{marginBottom:12},children:t(" ","Thermos Actions")}),c.jsxs("div",{className:"col",style:{gap:8},children:[c.jsx("button",{className:"btn btn-primary",onClick:async()=>{await ja(w,100),C(null)},children:t(" 100 ","Add 100 ml")}),c.jsx("button",{className:"btn btn-accent",onClick:async()=>{await gk(w),C(null)},children:t("  ","Log Refill")}),c.jsx("button",{className:"btn btn-outline",onClick:async()=>{await yk(w),C(null)},children:t("  ","Log Reheat")})]}),c.jsx("button",{className:"btn btn-outline",style:{marginTop:16},onClick:()=>C(null),children:t("","Cancel")})]})}),c.jsx(XC,{}),c.jsx(JC,{})]})},Ck=({open:t,onClose:e,onConfirm:n,processing:r=!1})=>{const[i,s]=I.useState("Benefit");return I.useEffect(()=>{t||s("Benefit")},[t]),t?c.jsx("div",{style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.35)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:9999},children:c.jsxs("div",{className:"card",style:{width:"min(480px, 92vw)"},children:[c.jsx("div",{className:"section-title",children:" "}),c.jsx("div",{className:"chips",children:["Benefit","Cash","Machine","Mixed"].map(o=>c.jsx("button",{className:`chip ${i===o?"active":""}`,onClick:()=>!r&&s(o),children:o},o))}),c.jsxs("div",{className:"row",style:{justifyContent:"flex-end",gap:8,marginTop:12},children:[c.jsx("button",{className:"btn btn-outline",onClick:e,disabled:r,children:""}),c.jsx("button",{className:"btn btn-primary",onClick:()=>n(i),disabled:r,children:r?"  ":""})]})]})}):null};function kk(t,e){const n=t.createdAt??0,r=e.createdAt??0;return n!==r?n-r:t.id.localeCompare(e.id)}function Vh(t){const e=[];let n={id:Math.random().toString(36).slice(2),items:[],separators:[]};for(const r of t){if(r.type==="separator"){n.separators.push(r.id),e.push(n),n={id:Math.random().toString(36).slice(2),items:[],separators:[]};continue}n.items.push(r)}return e.push(n),e}const Ek=()=>{const{t}=Hn(),[e,n]=I.useState([]),[r,i]=I.useState(null),[s,o]=I.useState(""),[l,a]=I.useState(""),[u,h]=I.useState(!1),[f,d]=I.useState(null),[v,x]=I.useState(!1),[g,E]=I.useState(null),[y,p]=I.useState({karak:{name:"Karak",endTime:null,duration:0},redTea:{name:"Red Tea",endTime:null,duration:0},almohibTea:{name:"Almohib",endTime:null,duration:0}}),[m,_]=I.useState(!1),[k,w]=I.useState(null),[C,N]=I.useState(20),[O,L]=I.useState(Date.now()),[V,J]=I.useState(!1),[se,Ee]=I.useState({karak:!1,redTea:!1,almohibTea:!1});async function Te(){try{const T=new Audio("/beep.mp3");T.volume=.5,await T.play().catch(()=>{})}catch{}}I.useEffect(()=>{const T=setInterval(()=>L(Date.now()),1e3);return()=>clearInterval(T)},[]);const de=I.useRef(se);I.useEffect(()=>{const T=[];let j=!1;const $={...de.current};for(const[oe,me]of Object.entries(y)){const De=oe,Xe=!!de.current[De];me.endTime&&me.endTime<=O&&me.endTime>O-2e3?Xe||($[De]=!0,de.current[De]=!0,T.push(De),j=!0):(!me.endTime||me.endTime>O+2e3)&&Xe&&($[De]=!1,de.current[De]=!1,j=!0)}if(j&&Ee($),T.length>0)for(const oe of T){const me=oe==="karak"?"Karak":oe==="redTea"?"Red Tea":"Almohib";Te();try{alert(` ${me} timer finished!`)}catch{}}},[O,y]),I.useEffect(()=>{const T=be(B(W,"stats/ingredientTimers"),j=>{const $=j.val();$&&p(oe=>({karak:$.karak||oe.karak,redTea:$.redTea||oe.redTea,almohibTea:$.almohibTea||oe.almohibTea}))});return()=>T()},[]),I.useEffect(()=>{const T=B(W,"orders"),j=be(T,$=>{const oe=$.val()||{},me=Object.entries(oe).map(([De,Xe])=>({id:De,...Xe}));me.sort(kk),n(me)});return()=>j()},[]);const xe=e.filter(T=>T.type==="item"&&T.status==="preparing"),D=e.filter(T=>T.type==="item"&&T.status==="ready"),G=Vh(e.filter(T=>T.status!=="completed"));function b(T){return T.reduce((j,$)=>j+($.totalPrice||0),0)}async function U(T){E(T.id);try{await je(B(W,`orders/${T.id}`),{status:"ready"}),Pd({type:"ready",message:"Order marked ready"})}catch(j){console.error("markReady error:",j),alert(t(":   ","Error: Failed to update status"))}finally{E(null)}}function F(T){d(T),h(!0)}async function q(T){if(!(!f||f.length===0)){x(!0);try{let j=function(nt){const fn=new Date(nt);return fn.getHours()<5&&fn.setDate(fn.getDate()-1),fn.toISOString().split("T")[0]};const $={};for(const nt of f)$[`orders/${nt.id}/status`]="completed",$[`orders/${nt.id}/paymentMethod`]=T,$[`orders/${nt.id}/completedAt`]=Dn();await je(B(W),$);const oe=Array.from(new Set(f.map(nt=>nt.licensePlate).filter(Boolean))),me=Date.now(),De=j(me);for(const nt of oe){const fn=B(W,`loyalty/${nt}`);await nn(fn,P=>P?(P.lastVisitShift||"")===De?P:{count:(P.count||0)+1,lastVisitShift:De}:{count:1,lastVisitShift:De});const Sr=(await Ft(B(W,`loyalty/${nt}/count`))).val();Sr===2?alert(`  !
: ${nt}`):Sr===3?alert(`  !
: ${nt}`):Sr>=5&&alert(` officially a loyal customer!
Plate: ${nt}`)}h(!1),d(null);const Xe=document.getElementById("new-order");Xe&&Xe.scrollIntoView({behavior:"smooth",block:"start"})}catch(j){console.error("completeGroup error:",j),alert("   .   .")}finally{x(!1)}}}async function S(T){if(T.status!=="preparing")return alert("     ");await Id(B(W,`orders/${T.id}`))}function Q(T){i(T),o(T.licensePlate||""),a(T.notes||"")}async function X(){if(!r)return;const T=r.batchId;if(T){const $=(await Ft(B(W,"orders"))).val()||{},oe=Object.entries($),me={};for(const[De,Xe]of oe)Xe.batchId===T&&Xe.type==="item"&&(me[`orders/${De}/licensePlate`]=s||null,me[`orders/${De}/notes`]=l||null);await je(B(W),me)}else await je(B(W,`orders/${r.id}`),{licensePlate:s||null,notes:l||null});i(null)}function z(T){w(T);const j=T==="karak"?50:60;N(y[T].duration||j),_(!0)}async function ie(){if(!k)return;const T=Math.min(100,Math.max(1,C)),j=Date.now()+T*60*1e3,$={name:y[k].name,endTime:j,duration:T};await je(B(W,`stats/ingredientTimers/${k}`),$),_(!1)}async function pe(T){await je(B(W,`stats/ingredientTimers/${T}`),{name:y[T].name,endTime:null,duration:0})}function Z(T){if(!T)return"--:--";const j=Math.max(0,T-O),$=Math.floor(j/1e3),oe=Math.floor($/60),me=$%60;return`${oe}:${me.toString().padStart(2,"0")}`}function M(T){if(!T)return"#94a3b8";const j=T-O;return j<=0?"#ef4444":j<=2*60*1e3?"#f59e0b":"#10b981"}return c.jsxs("section",{className:"card",children:[c.jsx("h2",{className:"section-title",children:"Dashboard"}),xe.length>0&&c.jsxs("div",{className:"col",style:{gap:8},children:[c.jsxs("div",{className:"row",style:{justifyContent:"space-between"},children:[c.jsxs("div",{className:"section-title",style:{margin:0},children:[t(" ","Preparing")," (",xe.length,")"]}),c.jsx("div",{className:"help",children:t('    " "','Auto-grouped by "New Car" separators')})]}),c.jsxs("div",{className:"card",style:{background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",color:"#fff",cursor:"pointer"},onClick:()=>J(!V),children:[c.jsxs("div",{className:"row",style:{justifyContent:"space-between",alignItems:"center"},children:[c.jsxs("div",{className:"section-title",style:{margin:0,color:"#fff"},children:[" ",t("","Timers")]}),c.jsx("div",{style:{fontSize:"20px",transform:V?"rotate(180deg)":"rotate(0deg)",transition:"transform 0.3s"},children:""})]}),V&&c.jsx("div",{className:"row",style:{gap:8,flexWrap:"wrap",marginTop:12},children:["karak","redTea","almohibTea"].map(T=>{const j=y[T],$=j.endTime!==null&&j.endTime>O,oe=j.endTime!==null&&j.endTime<=O,me=M(j.endTime);return c.jsxs("div",{className:"card",style:{flex:"1 1 calc(33.333% - 8px)",minWidth:"140px",padding:"12px",background:"rgba(255,255,255,0.15)",backdropFilter:"blur(10px)"},onClick:De=>De.stopPropagation(),children:[c.jsx("div",{style:{fontSize:"13px",fontWeight:600,marginBottom:6,color:"#fff"},children:T==="karak"?t("","Karak"):T==="redTea"?t(" ","Red Tea"):t(" ","Almohib")}),c.jsx("div",{style:{fontSize:"24px",fontWeight:700,marginBottom:8,color:me,textShadow:"0 2px 4px rgba(0,0,0,0.2)"},children:Z(j.endTime)}),c.jsxs("div",{className:"row",style:{gap:6},children:[!$&&!oe&&c.jsx("button",{className:"btn",style:{flex:1,fontSize:"12px",padding:"6px 12px",background:"#10b981",color:"#fff"},onClick:()=>z(T),children:t("","Start")}),($||oe)&&c.jsx("button",{className:"btn",style:{flex:1,fontSize:"12px",padding:"6px 12px",background:"#ef4444",color:"#fff"},onClick:()=>pe(T),children:t("","Stop")}),oe&&c.jsxs("div",{style:{flex:1,fontSize:"12px",fontWeight:700,textAlign:"center",padding:"6px",background:"#ef4444",borderRadius:"6px"},children:[" ",t("!","Ready!")]})]})]},T)})})]}),c.jsx("div",{className:"col",style:{gap:6},children:G.slice().reverse().map(j=>{const $=j.items.filter(me=>me.status==="preparing"&&(me.totalPrice||0)>0),oe=b($);return{...j,preparing:$,totalPrep:oe}}).filter(j=>j.preparing.length>0&&j.totalPrep>0).map(j=>c.jsxs("div",{className:"card",style:{borderStyle:"dashed",padding:8},children:[c.jsx("div",{className:"row",style:{justifyContent:"space-between",marginBottom:4},children:c.jsxs("div",{className:"help",style:{fontSize:11},children:[" : ",Y(j.totalPrep)]})}),j.preparing.slice().reverse().map($=>c.jsxs("div",{className:"row",style:{justifyContent:"space-between",borderBottom:"1px dashed #e5e7eb",padding:"4px 0"},children:[c.jsxs("div",{children:[c.jsxs("div",{style:{fontWeight:700,fontSize:13},children:[$.drinkType,"  ",$.quantity]}),c.jsx("div",{className:"help",style:{fontSize:11},children:$.drinkType==="Cold Drink"?$.coldDrinkName:$.drinkType==="Sweets"?`${$.sweetsOption||""} @ ${Y($.customPrice||0)}`:$.drinkType==="Red Tea"?[$.teaType,$.cupType,$.sugar].filter(Boolean).join("  "):[$.cupType,$.sugar].filter(Boolean).join("  ")}),c.jsxs("div",{className:"help",style:{fontSize:11},children:[t(":","Plate:")," ",$.licensePlate||"","  ",t(":","Notes:")," ",$.notes||""]})]}),c.jsxs("div",{className:"row",style:{gap:4},children:[c.jsx("button",{className:"btn btn-outline",style:{padding:"4px 8px",fontSize:12},onClick:()=>Q($),children:t("","Edit")}),c.jsx("button",{className:"btn btn-primary",style:{padding:"4px 10px",fontSize:12},onClick:()=>U($),disabled:g===$.id,children:g===$.id?"":t("","Ready")}),c.jsx("button",{className:"btn btn-danger",style:{padding:"4px 10px",fontSize:12},onClick:()=>S($),children:t("","Delete")})]})]},$.id))]},j.id))})]}),D.length>0&&c.jsxs("div",{className:"col",style:{gap:8,marginTop:xe.length>0?12:0},children:[c.jsx("div",{className:"row",style:{justifyContent:"space-between"},children:c.jsxs("div",{className:"section-title",style:{margin:0},children:[t("","Ready")," (",D.length,")"]})}),c.jsx("div",{className:"col",style:{gap:6},children:Vh(e).map(T=>{const j=T.items.filter(oe=>oe.status==="ready"&&(oe.totalPrice||0)>0),$=b(j);return{...T,ready:j,totalReady:$}}).filter(T=>T.ready.length>0&&T.totalReady>0).map(T=>c.jsxs("div",{className:"card",style:{borderStyle:"dashed",padding:8},children:[c.jsxs("div",{className:"row",style:{justifyContent:"space-between",marginBottom:4},children:[c.jsxs("div",{className:"help",style:{fontSize:11},children:[t(" :","Group Total:")," ",Y(T.totalReady)]}),c.jsx("div",{children:T.ready.length>0&&c.jsx("button",{className:"btn btn-accent",style:{padding:"4px 10px",fontSize:12},onClick:()=>F(T.ready),children:t(" ","Complete Payment")})})]}),T.ready.map(j=>c.jsxs("div",{className:"row",style:{justifyContent:"space-between",borderBottom:"1px dashed #e5e7eb",padding:"4px 0"},children:[c.jsxs("div",{children:[c.jsxs("div",{style:{fontWeight:700,fontSize:13},children:[j.drinkType,"  ",j.quantity]}),c.jsx("div",{className:"help",style:{fontSize:11},children:j.drinkType==="Cold Drink"?j.coldDrinkName:j.drinkType==="Sweets"?`${j.sweetsOption||""} @ ${Y(j.customPrice||0)}`:j.drinkType==="Red Tea"?[j.teaType,j.cupType,j.sugar].filter(Boolean).join("  "):[j.cupType,j.sugar].filter(Boolean).join("  ")}),c.jsxs("div",{className:"help",style:{fontSize:11},children:[t(":","Plate:")," ",j.licensePlate||"","  ",t(":","Notes:")," ",j.notes||""]})]}),c.jsx("div",{className:"row",style:{gap:6},children:c.jsx("button",{className:"btn btn-outline",style:{padding:"4px 8px",fontSize:12},onClick:()=>Q(j),children:t("","Edit")})})]},j.id))]},T.id))})]}),r&&c.jsx("div",{style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.35)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:50},children:c.jsxs("div",{className:"card",style:{width:"min(480px, 92vw)"},children:[c.jsx("div",{className:"section-title",children:t(" /","Edit Plate/Notes")}),c.jsxs("div",{className:"col",children:[c.jsx("input",{className:"input",placeholder:t(" ","License Plate"),inputMode:"numeric",pattern:"[0-9]*",value:s,onChange:T=>o(T.target.value)}),c.jsx("input",{className:"input",placeholder:t("","Notes"),value:l,onChange:T=>a(T.target.value)})]}),c.jsxs("div",{className:"row",style:{justifyContent:"flex-end",gap:8,marginTop:12},children:[c.jsx("button",{className:"btn btn-outline",onClick:()=>i(null),children:t("","Cancel")}),c.jsx("button",{className:"btn btn-primary",onClick:X,children:t("","Save")})]})]})}),m&&k&&c.jsx("div",{style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:50},children:c.jsxs("div",{className:"card",style:{width:"min(400px, 92vw)"},children:[c.jsxs("div",{className:"section-title",children:[" ",t(" ","Set Timer")," - ",k==="karak"?t("","Karak"):k==="redTea"?t(" ","Red Tea"):t(" ","Almohib")]}),c.jsx("div",{className:"col",style:{gap:12},children:c.jsxs("div",{children:[c.jsx("label",{style:{display:"block",marginBottom:6,fontWeight:600},children:t(" (1-100)","Minutes (1-100)")}),c.jsx("input",{type:"number",className:"input",min:"1",max:"100",value:C,onChange:T=>N(Math.min(100,Math.max(1,parseInt(T.target.value)||1))),style:{fontSize:"24px",textAlign:"center",padding:"16px"},autoFocus:!0})]})}),c.jsxs("div",{className:"row",style:{justifyContent:"flex-end",gap:8,marginTop:12},children:[c.jsx("button",{className:"btn btn-outline",onClick:()=>_(!1),children:t("","Cancel")}),c.jsx("button",{className:"btn btn-primary",onClick:ie,children:t(" ","Start Timer")})]})]})}),c.jsx(Ck,{open:u,onClose:()=>h(!1),onConfirm:q,processing:v})]})},Tk=()=>{const{lang:t,setLang:e,t:n}=Hn(),[r,i]=I.useState(100),[s,o]=I.useState(!0),[l,a]=I.useState(!0),[u,h]=I.useState(!1),f=!1,[d,v]=I.useState(!1),[x,g]=I.useState(null);I.useEffect(()=>{const _=be(B(W,"stats/breakeven/target"),C=>{const N=C.val();i(typeof N=="number"?N:100)}),k=be(B(W,"settings/alerts"),C=>{const N=C.val()||{};o(N.sound!==!1),a(N.vibrate!==!1)}),w=be(B(W,"settings/darkMode"),C=>{const O=C.val()===!0;h(O),document.documentElement.classList.toggle("dark",O)});return()=>{_(),k(),w()}},[]);const E=async()=>{await je(B(W),{"stats/breakeven/target":+r})},y=async _=>{await je(B(W),{"settings/alerts":{sound:_.sound??s,vibrate:_.vibrate??l}})},p=async _=>{await je(B(W),{"settings/darkMode":_})},m=async _=>{try{await e(_)}catch(k){console.error("Language switch error:",k),alert(n("   ","Error switching language"))}};return c.jsxs("section",{className:"card",children:[c.jsx("h2",{className:"section-title",children:n("","Settings")}),c.jsxs("div",{className:"col",style:{gap:12},children:[c.jsxs("div",{className:"row",style:{gap:8,alignItems:"center",flexWrap:"wrap"},children:[c.jsx("label",{className:"group-title",style:{minWidth:120},children:n("","Language")}),c.jsxs("div",{className:"chips",children:[c.jsx("button",{className:`chip ${t==="ar"?"active":""}`,onClick:()=>m("ar"),children:""}),c.jsx("button",{className:`chip ${t==="en"?"active":""}`,onClick:()=>m("en"),children:"English"})]})]}),c.jsxs("div",{className:"row",style:{gap:8,alignItems:"center",flexWrap:"wrap"},children:[c.jsx("label",{className:"group-title",style:{minWidth:120},children:n("","Theme")}),c.jsxs("label",{className:"row",style:{gap:6},children:[c.jsx("input",{type:"checkbox",checked:u,onChange:_=>{h(_.target.checked),p(_.target.checked)}}),n(" ","Dark Mode")]})]}),c.jsxs("div",{className:"row",style:{gap:8,alignItems:"center",flexWrap:"wrap"},children:[c.jsx("label",{className:"group-title",style:{minWidth:120},children:n("  (BHD)","Weekly Target (BHD)")}),c.jsx("input",{className:"input",style:{maxWidth:160},type:"number",step:"0.100",value:r,onChange:_=>i(parseFloat(_.target.value||"0")),onBlur:E}),c.jsx("div",{className:"help",children:n(": 100 BHD","Example: 100 BHD")}),c.jsx("button",{className:"btn btn-outline",onClick:E,children:n("","Save")})]}),c.jsxs("div",{className:"row",style:{gap:12,alignItems:"center",flexWrap:"wrap"},children:[c.jsx("label",{className:"group-title",style:{minWidth:120},children:n("","Alerts")}),c.jsxs("label",{className:"row",style:{gap:6},children:[c.jsx("input",{type:"checkbox",checked:s,onChange:_=>{o(_.target.checked),y({sound:_.target.checked})}}),n("","Sound")]}),c.jsxs("label",{className:"row",style:{gap:6},children:[c.jsx("input",{type:"checkbox",checked:l,onChange:_=>{a(_.target.checked),y({vibrate:_.target.checked})}}),n("","Vibration")]})]}),f]})]})},Nk=({activeTab:t,onTabChange:e})=>{const n=r=>{r!==t&&(r==="expenses"?prompt("Enter PIN for Admin Access:")==="522"?e(r):alert("Wrong PIN"):e(r))};return c.jsxs("nav",{style:{position:"fixed",bottom:0,left:0,right:0,height:"50px",backgroundColor:"#fff",borderTop:"1px solid #ddd",display:"flex",justifyContent:"space-around",alignItems:"center",zIndex:1e3,boxShadow:"0 -2px 10px rgba(0,0,0,0.1)"},children:[c.jsxs("button",{onClick:()=>n("sales"),style:{flex:1,height:"100%",border:"none",background:t==="sales"?"#eef2ff":"transparent",color:t==="sales"?"#4f46e5":"#6b7280",fontSize:"13px",fontWeight:t==="sales"?"bold":"normal",cursor:"pointer",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",gap:"2px"},children:[c.jsx("span",{style:{fontSize:"18px"},children:""}),c.jsx("span",{children:"Sales (POS)"})]}),c.jsx("div",{style:{width:"1px",height:"24px",backgroundColor:"#ddd"}}),c.jsxs("button",{onClick:()=>n("expenses"),style:{flex:1,height:"100%",border:"none",background:t==="expenses"?"#fef2f2":"transparent",color:t==="expenses"?"#ef4444":"#6b7280",fontSize:"13px",fontWeight:t==="expenses"?"bold":"normal",cursor:"pointer",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",gap:"2px"},children:[c.jsx("span",{style:{fontSize:"18px"},children:""}),c.jsx("span",{children:"Expenses & Profit"})]})]})};function Ik(){const[t,e]=I.useState(100);return I.useEffect(()=>{const r=B(W,"stats/breakeven/target"),i=be(r,s=>{const o=s.val();e(typeof o=="number"?o:100)});return()=>i()},[]),{target:t,setTargetDB:r=>je(B(W),{"stats/breakeven/target":r})}}const bk=({orders:t})=>{const{t:e}=Hn(),n=I.useMemo(()=>{let i=0,s=0,o=0,l=0,a=0,u=0;for(const h of t){if(h.type!=="item")continue;const f=h.quantity||0;h.cupType==="Glass Cup (Small)"?i+=f:h.cupType==="Glass Cup (Large)"?s+=f:h.cupType==="Paper Cup (Regular)"&&(l+=f),(h.drinkType==="Karak"||h.drinkType==="Almohib")&&(o+=f),h.drinkType==="Karak"&&(u+=f*.35),h.drinkType==="Cold Drink"&&h.coldDrinkName==="Karkadeh"&&(o+=f),h.drinkType==="Cold Drink"&&h.coldDrinkName&&h.coldDrinkName.includes("Mojito")&&(a+=f)}return{smallGlasses:i,bigGlasses:s,sugarSachets:o,cupLids:l,sevenUpCans:a,milkCans:Math.ceil(u)}},[t]),r=[{icon:"",labelAr:"  ()",labelEn:"Est. Milk Cans",count:n.milkCans,color:"#fee2e2",textColor:"#991b1b"},{icon:"",labelAr:" ",labelEn:"Small Glasses",count:n.smallGlasses,color:"#dbeafe",textColor:"#1e40af"},{icon:"",labelAr:" ",labelEn:"Big Glasses",count:n.bigGlasses,color:"#bfdbfe",textColor:"#1e3a8a"},{icon:"",labelAr:" ()",labelEn:"Sugar Sachets",count:n.sugarSachets,color:"#f3f4f6",textColor:"#374151"},{icon:"",labelAr:" ",labelEn:"Cup Lids",count:n.cupLids,color:"#e5e7eb",textColor:"#1f2937"},{icon:"",labelAr:"7 ",labelEn:"7-Up Cans",count:n.sevenUpCans,color:"#d9f99d",textColor:"#365314"}];return c.jsxs("section",{className:"card",children:[c.jsx("h2",{className:"section-title",style:{margin:"0 0 16px 0"},children:"    (Daily Consumables Report)"}),c.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(3, 1fr)",gap:"12px"},children:r.map((i,s)=>c.jsxs("div",{style:{background:i.color,padding:"16px",borderRadius:"12px",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",minHeight:"100px"},children:[c.jsx("div",{style:{fontSize:"32px",marginBottom:"8px"},children:i.icon}),c.jsx("div",{style:{fontSize:"24px",fontWeight:"bold",color:i.textColor},children:i.count}),c.jsx("div",{style:{fontSize:"12px",fontWeight:"bold",color:i.textColor,textAlign:"center",marginTop:"4px"},children:i.labelAr}),c.jsx("div",{style:{fontSize:"10px",color:i.textColor,opacity:.8},children:i.labelEn})]},s))}),c.jsx("div",{className:"help",style:{textAlign:"center",marginTop:"12px",fontSize:"12px"},children:e("       "," Automatically calculated from today's completed orders")})]})},Hy=[{id:"fuel",icon:"",en:"Generator Fuel",ar:" ",color:"#fecaca",text:"#991b1b"},{id:"mint",icon:"",en:"Fresh Mint",ar:"",color:"#d1fae5",text:"#065f46"},{id:"habak",icon:"",en:"Habak",ar:"",color:"#d1fae5",text:"#065f46"},{id:"milk",icon:"",en:"Milk",ar:"",color:"#e0e7ff",text:"#3730a3"},{id:"water_tank",icon:"",en:"Water (Tank)",ar:" ",color:"#bfdbfe",text:"#1e3a8a"},{id:"water_small",icon:"",en:"Water (Small)",ar:" ",color:"#bfdbfe",text:"#1e3a8a"},{id:"karakdia",icon:"",en:"Karakdia leaves",ar:" ",color:"#fecdd3",text:"#831843"},{id:"7up",icon:"",en:"7up",ar:"7 ",color:"#d9f99d",text:"#365314"}],Kc=[{title:"Tea Essentials & Flavors (  )",items:[{en:"Red Tea (Loose/Bags)",ar:" ",icon:""},{en:"Almohib Tea (Silver/Red)",ar:" ",icon:""},{en:"Karak Tea Powder",ar:" ",icon:""},{en:"Saffron (Za'afran)",ar:""},{en:"Cardamom",ar:""},{en:"Ginger/Cloves/Cinnamon",ar:"//"},{en:"Rose Water",ar:" "},{en:"Syrups (All Flavors)",ar:"/"},{en:"Lemon (Fresh)",ar:"",icon:""},{en:"Karkadeh (Hibiscus)",ar:"",icon:""}]},{title:"Serving & Packaging ()",items:[{en:"Paper Cups (All sizes)",ar:" ",icon:""},{en:"Small Glasses",ar:"  ",icon:""},{en:"Big Glasses",ar:"  ",icon:""},{en:"Lids (Black/White)",ar:"",icon:""},{en:"Cup Stickers",ar:" ",icon:""},{en:"Biscuits/Cookies",ar:"",icon:""},{en:"Wooden Stirrers",ar:" ",icon:""},{en:"Tissues",ar:"",icon:""},{en:"Garbage Bags (Small)",ar:" ",icon:""}]},{title:"Operational ()",items:[{en:"Hygiene (Gloves/Caps)",ar:" ",icon:""},{en:"Cleaning Cloths",ar:" ",icon:""}]}],Gh=[...Hy.map(t=>({id:t.en,label:`${t.ar} (${t.en})`})),...Object.keys(oi).map(t=>({id:t,label:t})),...Kc.flatMap(t=>t.items).map(t=>({id:t.en,label:`${t.ar} (${t.en})`}))].sort((t,e)=>t.label.localeCompare(e.label)),Pk=()=>{var Sr;const{total:t,totalCost:e,logs:n}=Uy(),[r,i]=ue.useState([]),[s,o]=ue.useState(0),[l,a]=ue.useState(!1),[u,h]=ue.useState({}),{target:f,setTargetDB:d}=Ik(),[v,x]=ue.useState(!1),[g,E]=ue.useState(""),y=P=>P.replace(/[^a-zA-Z0-9]/g,"_").toLowerCase(),[p,m]=ue.useState(!1),[_,k]=ue.useState(null),[w,C]=ue.useState(""),[N,O]=ue.useState(""),[L,V]=ue.useState(!1);ue.useEffect(()=>{const P=B(W,"expenses"),ce=be(P,hn=>{const wr=hn.val()||{},Ms=Object.entries(wr).map(([Ul,Hl])=>({id:Ul,...Hl}));i(Ms);const Vy=Ms.reduce((Ul,Hl)=>Ul+Hl.cost,0);o(Vy)}),Ve=B(W,"stats/inventory"),Kt=be(Ve,hn=>{h(hn.val()||{})});return()=>{ce(),Kt()}},[]);const J=r.filter(P=>{const ce=new Date(P.timestamp),Ve=new Date;return ce.toDateString()===Ve.toDateString()}),se=J.filter(P=>P.type!=="inventory").reduce((P,ce)=>P+ce.cost,0),Ee=t-(e||0)-se,Te=(P,ce,Ve,Kt,hn="operational")=>{let wr=0;if(Kt)wr=parseFloat(Kt);else return;if(isNaN(wr)||wr<=0){alert("   (Invalid Amount)");return}const Ms={category:P,nameEn:ce,nameAr:Ve,cost:wr,timestamp:Date.now(),type:hn};xs(B(W,"expenses"),Ms)},[de,xe]=ue.useState(""),[D,G]=ue.useState(""),b=()=>{!de||!D||(Te("Unexpected",de,de,D,"operational"),xe(""),G(""))},U=(P,ce,Ve)=>{k({id:ce,en:ce,ar:Ve,category:P}),C(""),O(""),V(!1),m(!0)},{costs:F,updateCost:q}=Fy(),S=()=>{if(!_||!w)return;const P=parseFloat(w);if(isNaN(P)||P<=0){alert("Invalid Amount");return}Te(_.category,_.en,_.ar,w,"operational");const ce=parseFloat(N);if(L&&ce>0){const Ve=P/ce;q(_.id,Ve)}if(ce>0&&_.category!=="Daily"){const Ve=y(_.en);nn(B(W,`stats/inventory/${Ve}`),Kt=>(Kt||0)+ce)}m(!1)},[Q,X]=ue.useState(""),[z,ie]=ue.useState(((Sr=Gh[0])==null?void 0:Sr.id)||""),pe=()=>{if(!Q||!z)return;const P=parseFloat(Q);if(isNaN(P))return;const Ve=(F[z]||0)*P;xs(B(W,"waste_logs"),{item:z,qty:P,cost:Ve,timestamp:Date.now(),note:"Manual Waste Log"}),alert(`  : ${z} (${P})`),X("")},[Z,M]=ue.useState(""),[T,j]=ue.useState(""),[$,oe]=ue.useState(Object.keys(oi)[0]),[me,De]=ue.useState(!1),Xe=parseFloat(Z)&&parseFloat(T)?parseFloat(Z)/parseFloat(T):0,nt=()=>{!Xe||!$||confirm(`Update cost for ${$} to ${Xe.toFixed(3)} BHD?`)&&(q($,Xe),alert("Cost updated successfully"),M(""),j(""))},fn=()=>{const P=prompt(`  (/): 
Item Name:`);P&&U("Stock",P,P)},Os=parseFloat(w)&&parseFloat(N)?parseFloat(w)/parseFloat(N):0;return c.jsxs("div",{style:{padding:"16px",paddingBottom:"90px",background:"#f8fafc",minHeight:"100vh",direction:"rtl"},children:[c.jsxs("div",{className:"card",style:{background:"linear-gradient(135deg, #0f172a 0%, #334155 100%)",color:"white",marginBottom:20,textAlign:"center",display:"flex",flexDirection:"column",alignItems:"center",gap:"12px",padding:"24px",position:"relative"},children:[c.jsx("button",{onClick:()=>De(!me),style:{position:"absolute",top:12,left:12,background:"rgba(255,255,255,0.2)",color:"white",border:"none",borderRadius:"50%",width:32,height:32,display:"flex",alignItems:"center",justifyContent:"center",cursor:"pointer",fontSize:"16px"},title:" ",children:""}),c.jsx("div",{style:{fontSize:"14px",opacity:.9},children:"   (Profit vs Standard Cost)"}),c.jsx("div",{style:{fontSize:"42px",fontWeight:"bold",color:Ee>=0?"#4ade80":"#f87171",direction:"ltr"},children:Y(Ee)}),me&&c.jsxs("div",{style:{background:"rgba(255,255,255,0.1)",padding:"16px",borderRadius:"8px",marginTop:"8px",textAlign:"right",fontSize:"13px",lineHeight:"1.6"},children:[c.jsx("h4",{style:{margin:"0 0 12px 0",fontSize:"14px",fontWeight:"bold"},children:"      :"}),c.jsxs("div",{style:{marginBottom:"8px"},children:[c.jsx("strong",{children:"1.   (Dakhil):"})," ",Y(t),c.jsx("div",{style:{fontSize:"11px",opacity:.9,marginRight:"16px"},children:"      "})]}),c.jsxs("div",{style:{marginBottom:"8px"},children:[c.jsx("strong",{children:"2.    (COGS):"})," -",Y(e||0),c.jsx("div",{style:{fontSize:"11px",opacity:.9,marginRight:"16px"},children:"   (   )   "})]}),c.jsxs("div",{style:{marginBottom:"8px"},children:[c.jsx("strong",{children:"3.   (Ops):"})," -",Y(se),c.jsx("div",{style:{fontSize:"11px",opacity:.9,marginRight:"16px"},children:" :     "})]}),c.jsxs("div",{style:{borderTop:"1px solid rgba(255,255,255,0.3)",marginTop:"12px",paddingTop:"12px",fontWeight:"bold",fontSize:"14px"},children:["  = ",Y(t)," - ",Y(e||0)," - ",Y(se)," = ",Y(Ee)]})]}),c.jsxs("div",{style:{display:"flex",gap:8,flexWrap:"wrap",justifyContent:"center"},children:[c.jsxs("span",{style:{fontSize:"12px",fontWeight:"normal",background:"rgba(255,255,255,0.1)",padding:"4px 8px",borderRadius:"4px"},children:["Dakhil: ",Y(t)]}),c.jsxs("span",{style:{fontSize:"12px",fontWeight:"normal",background:"rgba(255,255,255,0.1)",padding:"4px 8px",borderRadius:"4px"},children:["COGS: -",Y(e||0)]}),c.jsxs("span",{style:{fontSize:"12px",fontWeight:"normal",background:"rgba(255,255,255,0.1)",padding:"4px 8px",borderRadius:"4px"},children:["Ops: -",Y(se)]})]})]}),c.jsxs("div",{className:"card",style:{background:"white",marginBottom:24,padding:16,borderLeft:"4px solid #ef4444"},children:[c.jsx("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:c.jsx("div",{children:c.jsx("h3",{style:{margin:0,fontSize:16},children:"   (Waste Log)"})})}),c.jsxs("div",{style:{display:"flex",alignItems:"flex-end",gap:12,marginTop:12},children:[c.jsxs("div",{style:{flex:2},children:[c.jsx("label",{style:{display:"block",fontSize:"12px",marginBottom:"4px"},children:" (Item)"}),c.jsx("select",{className:"input",style:{width:"100%"},value:z,onChange:P=>ie(P.target.value),children:Gh.map(P=>c.jsx("option",{value:P.id,children:P.label},P.id))})]}),c.jsxs("div",{style:{flex:1},children:[c.jsx("label",{style:{display:"block",fontSize:"12px",marginBottom:"4px"},children:" (Qty)"}),c.jsx("input",{className:"input",type:"number",dir:"ltr",style:{width:"100%"},value:Q,onChange:P=>X(P.target.value),placeholder:"0"})]}),c.jsx("button",{className:"btn btn-outline",style:{borderColor:"#ef4444",color:"#ef4444"},onClick:pe,children:" "})]})]}),c.jsxs("div",{style:{marginBottom:"24px"},children:[c.jsx("h3",{style:{margin:"0 0 12px 0",color:"#1e293b"},children:"  (Daily Essentials)"}),c.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(3, 1fr)",gap:"12px"},children:[Hy.map(P=>c.jsxs("button",{onClick:()=>U("Daily",P.en,P.ar),style:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",height:"100px",background:P.color,border:"none",borderRadius:"12px",boxShadow:"0 2px 4px rgba(0,0,0,0.05)",cursor:"pointer",transition:"transform 0.1s"},children:[c.jsx("span",{style:{fontSize:"32px",marginBottom:"8px"},children:P.icon}),c.jsx("span",{style:{fontSize:"14px",fontWeight:"bold",color:P.text,textAlign:"center"},children:P.ar}),c.jsx("span",{style:{fontSize:"10px",color:P.text,opacity:.8},children:P.en})]},P.id)),c.jsxs("button",{onClick:fn,style:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",height:"100px",background:"#e0e7ff",border:"2px dashed #6366f1",borderRadius:"12px",cursor:"pointer"},children:[c.jsx("span",{style:{fontSize:"32px",color:"#6366f1"},children:""}),c.jsx("span",{style:{fontSize:"13px",fontWeight:"bold",color:"#4338ca"},children:" "})]})]})]}),c.jsx("button",{onClick:()=>a(!l),style:{width:"100%",padding:"12px",background:"white",border:"1px solid #cbd5e1",borderRadius:"8px",fontWeight:"bold",color:"#64748b",marginBottom:"24px",display:"flex",alignItems:"center",justifyContent:"center",gap:"8px"},children:l?"  ":"     /  "}),l&&c.jsx("div",{style:{animation:"fadeIn 0.3s ease-in-out"},children:Kc.map(P=>c.jsxs("div",{style:{marginBottom:"20px"},children:[c.jsx("h4",{style:{margin:"0 0 10px 0",color:"#475569",fontSize:"14px"},children:P.title}),c.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(130px, 1fr))",gap:"10px"},children:P.items.map(ce=>c.jsxs("button",{onClick:()=>U("Stock",ce.en,ce.ar),className:"btn",style:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",height:"90px",background:"white",border:"1px solid #e2e8f0",borderRadius:"8px",padding:"8px",textAlign:"center"},children:[ce.icon&&c.jsx("span",{style:{fontSize:"24px",marginBottom:"4px"},children:ce.icon}),c.jsx("span",{style:{fontWeight:"bold",fontSize:"13px",marginBottom:"4px"},children:ce.ar}),c.jsx("span",{style:{fontSize:"11px",color:"#94a3b8"},children:ce.en})]},ce.en))})]},P.title))}),c.jsxs("div",{style:{display:"grid",gridTemplateColumns:"minmax(0, 1fr) minmax(0, 1fr)",gap:"16px",marginBottom:"24px"},children:[c.jsxs("div",{className:"card",style:{background:"#fff1f2",padding:"16px",border:"1px solid #fda4af",maxHeight:"400px",overflowY:"auto"},children:[c.jsx("h4",{style:{margin:"0 0 12px 0",fontSize:"15px",color:"#991b1b",textAlign:"center"},children:"    (Restock Reminders)"}),c.jsx("div",{style:{display:"flex",flexDirection:"column",gap:8},children:Kc.flatMap(P=>P.items).map(P=>{const ce=y(P.en),Ve=u[ce]||0,Kt=Ve<20,hn=Ve<=0;return c.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",borderBottom:"1px solid #fecdd3",paddingBottom:4},children:[c.jsxs("div",{style:{fontSize:"12px",color:"#881337"},children:[P.ar," ",c.jsxs("span",{style:{fontSize:"10px",opacity:.7},children:["(",P.en,")"]})]}),c.jsxs("div",{style:{display:"flex",alignItems:"center",gap:6,fontWeight:"bold",color:Kt?"#ef4444":"#047857"},children:[hn&&c.jsx("span",{title:"Out of Stock",style:{fontSize:"14px"},children:""}),!hn&&Kt&&c.jsx("span",{title:"Low Stock",style:{fontSize:"14px"},children:""}),Ve]})]},ce)})})]}),c.jsxs("div",{className:"card",style:{background:"white",padding:"16px",border:"2px solid #6366f1"},children:[c.jsx("h4",{style:{margin:"0 0 12px 0",fontSize:"15px",color:"#4338ca"},children:"   (Unit Cost)"}),c.jsxs("div",{style:{marginBottom:12},children:[c.jsx("label",{style:{display:"block",fontSize:"12px",marginBottom:"4px"},children:"Item to Update"}),c.jsx("select",{className:"input",style:{width:"100%"},value:$,onChange:P=>oe(P.target.value),children:Object.keys(oi).map(P=>{var ce;return c.jsxs("option",{value:P,children:[P," (Current: ",((ce=F[P])==null?void 0:ce.toFixed(3))||"?",")"]},P)})})]}),c.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:8,marginBottom:12},children:[c.jsxs("div",{children:[c.jsx("label",{style:{display:"block",fontSize:"11px",marginBottom:"4px"},children:"Price (BHD)"}),c.jsx("input",{className:"input",type:"number",dir:"ltr",style:{width:"100%"},value:Z,onChange:P=>M(P.target.value),placeholder:"10.000"})]}),c.jsxs("div",{children:[c.jsx("label",{style:{display:"block",fontSize:"11px",marginBottom:"4px"},children:"Qty"}),c.jsx("input",{className:"input",type:"number",dir:"ltr",style:{width:"100%"},value:T,onChange:P=>j(P.target.value),placeholder:"1000"})]})]}),c.jsx("div",{style:{background:"#e0e7ff",padding:"8px",borderRadius:"8px",marginBottom:12,textAlign:"center"},children:c.jsxs("div",{style:{fontSize:"12px",color:"#4338ca"},children:["Unit Cost: ",c.jsx("strong",{children:Xe.toFixed(3)})]})}),c.jsx("button",{className:"btn btn-primary",onClick:nt,disabled:Xe<=0,style:{background:"#4338ca",width:"100%"},children:"Save New Cost"})]})]}),c.jsxs("div",{className:"card",style:{background:"white",marginBottom:"24px"},children:[c.jsx("h4",{style:{margin:"0 0 12px 0",fontSize:"15px"},children:"   (Unexpected)"}),c.jsxs("div",{style:{display:"flex",gap:"12px",alignItems:"flex-end"},children:[c.jsxs("div",{style:{flex:2},children:[c.jsx("label",{style:{display:"block",fontSize:"12px",marginBottom:"4px"},children:" (Description)"}),c.jsx("input",{className:"input",style:{width:"100%"},value:de,onChange:P=>xe(P.target.value),placeholder:": "})]}),c.jsxs("div",{style:{flex:1},children:[c.jsx("label",{style:{display:"block",fontSize:"12px",marginBottom:"4px"},children:" (BHD)"}),c.jsx("input",{className:"input",type:"number",dir:"ltr",style:{width:"100%"},value:D,onChange:P=>G(P.target.value),placeholder:"0.000"})]}),c.jsx("button",{className:"btn btn-primary",onClick:b,children:""})]})]}),c.jsx("h3",{style:{margin:"0 0 16px 0",color:"#475569"},children:"   (Today's Log)"}),c.jsx("div",{className:"card",style:{padding:0,overflow:"hidden",background:"white"},children:J.length===0?c.jsx("div",{style:{padding:"16px",color:"#9ca3af",textAlign:"center"},children:"   "}):J.slice().reverse().map(P=>c.jsxs("div",{style:{display:"flex",justifyContent:"space-between",padding:"12px 16px",borderBottom:"1px solid #f3f4f6"},children:[c.jsxs("div",{children:[c.jsxs("div",{style:{fontWeight:"bold"},children:[P.nameAr," ",c.jsxs("span",{style:{fontWeight:"normal",color:"#94a3b8",fontSize:"12px"},children:["(",P.nameEn,")"]})]}),c.jsxs("div",{style:{fontSize:"12px",color:"#9ca3af",direction:"ltr",textAlign:"right"},children:[new Date(P.timestamp).toLocaleTimeString(),"  ",P.category]})]}),c.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"12px"},children:[c.jsxs("span",{style:{fontWeight:"bold",color:"#ef4444",direction:"ltr"},children:["- ",Y(P.cost)]}),c.jsx("button",{style:{color:"#ef4444",background:"none",border:"none",cursor:"pointer",fontSize:"18px"},onClick:()=>{confirm("    ")&&Id(B(W,`expenses/${P.id}`))},children:""})]})]},P.id))}),c.jsx(bk,{orders:n}),c.jsxs("div",{className:"card",style:{background:"#f8fafc",padding:16,marginTop:24,border:"1px solid #e2e8f0",borderRadius:12},children:[c.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:16},children:[c.jsx("h3",{style:{margin:0,color:"#334155"},children:"    (Real Weekly Target)"}),c.jsx("button",{className:"btn btn-outline",style:{fontSize:12,padding:"4px 8px"},onClick:()=>{if(v)x(!1);else{const P=prompt("Enter Admin PIN to edit target:");P==="522"?(x(!0),E(f.toString())):P&&alert("Wrong PIN")}},children:v?"Lock ":"Edit "})]}),c.jsxs("div",{style:{marginBottom:16},children:[c.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:8,fontSize:14},children:[c.jsxs("span",{children:["Progress: ",(t/(f||1)*100).toFixed(1),"%"]}),c.jsxs("span",{children:[Y(t)," / ",Y(f)]})]}),c.jsx("div",{style:{width:"100%",height:12,background:"#e2e8f0",borderRadius:6,overflow:"hidden"},children:c.jsx("div",{style:{width:`${Math.min(100,t/(f||1)*100)}%`,height:"100%",background:t>=f?"#22c55e":"#3b82f6",transition:"width 0.5s ease"}})})]}),v&&c.jsxs("div",{style:{display:"flex",gap:8,alignItems:"center",background:"#e0e7ff",padding:12,borderRadius:8},children:[c.jsx("label",{style:{fontSize:13,fontWeight:"bold"},children:"New Target:"}),c.jsx("input",{className:"input",type:"number",value:g,onChange:P=>E(P.target.value),style:{width:100}}),c.jsx("button",{className:"btn btn-primary",onClick:()=>{const P=parseFloat(g);P>0&&(d(P),x(!1),alert("Target updated!"))},children:"Save"})]})]}),p&&_&&c.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0,0,0,0.6)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3,padding:16},children:c.jsxs("div",{className:"card",style:{width:"100%",maxWidth:"350px",background:"white",animation:"scaleIn 0.2s ease"},children:[c.jsx("h3",{style:{margin:"0 0 16px 0",textAlign:"center"},children:_.en===_.ar?_.en:`${_.ar} (${_.en})`}),c.jsxs("div",{className:"col",style:{gap:12},children:[c.jsxs("div",{children:[c.jsx("label",{className:"help",children:"  (Total Cost BHD)"}),c.jsx("input",{className:"input",type:"number",autoFocus:!0,value:w,onChange:P=>C(P.target.value),placeholder:"e.g. 5.000",style:{fontSize:"18px",padding:12}})]}),c.jsxs("div",{children:[c.jsx("label",{className:"help",children:" (Quantity)"}),c.jsx("input",{className:"input",type:"number",value:N,onChange:P=>O(P.target.value),placeholder:"e.g. 100",style:{fontSize:"18px",padding:12}})]}),Os>0&&c.jsxs("div",{style:{background:"#f0f9ff",padding:12,borderRadius:8},children:[c.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[c.jsx("span",{style:{fontSize:13,color:"#0369a1"},children:"Calculated Unit Cost:"}),c.jsx("strong",{style:{color:"#0ea5e9",fontSize:16},children:Os.toFixed(3)})]}),c.jsxs("label",{style:{display:"flex",alignItems:"center",gap:8,marginTop:8,fontSize:13,cursor:"pointer"},children:[c.jsx("input",{type:"checkbox",checked:L,onChange:P=>V(P.target.checked)}),"Update System Unit Cost?"]})]}),c.jsxs("div",{className:"row",style:{gap:12,marginTop:8},children:[c.jsx("button",{className:"btn btn-outline",style:{flex:1},onClick:()=>m(!1),children:"Cancel"}),c.jsx("button",{className:"btn btn-primary",style:{flex:2},onClick:S,children:"Save Expense"})]})]})]})})]})};function Rk(){const{lang:t}=Hn(),[e,n]=ue.useState("sales");return I.useEffect(()=>{document.documentElement.setAttribute("lang",t),document.documentElement.setAttribute("dir",t==="ar"?"rtl":"ltr")},[t]),c.jsxs("div",{className:"app",style:{paddingBottom:"60px"},children:[" ",c.jsx(DC,{}),e==="sales"?c.jsxs(c.Fragment,{children:[c.jsx(Wf,{}),c.jsxs("main",{className:"container",children:[c.jsx("section",{id:"new-order",children:c.jsx(VC,{})}),c.jsx("section",{id:"kanban",children:c.jsx(Ek,{})}),c.jsx(wk,{}),c.jsx(Tk,{})]})]}):c.jsxs(c.Fragment,{children:[c.jsx(Wf,{}),c.jsx(Pk,{})]}),c.jsx(Nk,{activeTab:e,onTabChange:n})]})}Aa.createRoot(document.getElementById("root")).render(c.jsx(I.StrictMode,{children:c.jsx(QC,{children:c.jsx(Rk,{})})}));
